{"version":3,"file":"index.js","mappings":"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","sources":["webpack://@BrandEmbassy/chat-web-sdk/webpack/universalModuleDefinition","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/be-javascript-utils/dist/query/queryParameters.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/push-updates-sdk/dist/eventTargetPolyfill/EventTargetPolyfill.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/push-updates-sdk/dist/index.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/push-updates-sdk/dist/pushUpdate/pushUpdateWebSocket.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/push-updates-sdk/dist/websocket/HeartBeatState.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/push-updates-sdk/dist/websocket/WebSocketClient.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/push-updates-sdk/dist/websocket/WebSocketClientEvent.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/reconnecting-websocket/dist/reconnecting-websocket-mjs.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/ts-types-chat/dist/awsEvents/AwsChatWindowEvent.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/ts-types-chat/dist/user/BrowserFingerprint.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/ts-types-platform/dist/message/MessageDirection.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/ts-types-platform/dist/message/MessageType.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/ts-types-platform/dist/post/case/CaseStatus.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/@brandembassy/ts-types-platform/dist/pushUpdate/PushUpdateEventType.js","webpack://@BrandEmbassy/chat-web-sdk/./src/ChatSdk.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/agent/agentTyping.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/agent/assignedAgentChanged.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/attachment/createPayloadForAttachmentUpload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/attachment/localFileReader.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/attachment/sendAttachments.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/attachment/uploadAttachment.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/authorization/accessTokenStorage.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/authorization/authorizationPayloadData.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/authorization/createRefreshTokenPayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/authorization/handleRefreshToken.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/authorization/isAuthSuccessEvent.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/authorization/isTokenRefreshedSuccessResponse.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/browserFingerprint/getBrowserFingerprint.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/contact/index.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/contact/isContactCreatedEvent.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/contact/isContactStatusChanged.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/contact/isContactStatusChangedEvent.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/customField/convertCustomField.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/customField/mergeCustomFields.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/customer/customer.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/customer/customerIdentityPayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/customer/setCustomerCustomFieldsPayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/env/ChatSDKVariable.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/env/Environments.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/env/getEnvVariable.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/env/version.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/error/ChatSDKError.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/event/ChatEvent.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/event/ChatEventMiddleware.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/event/ChatEventTarget.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/event/middleware/ChatEventMapper.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/event/normalizeEvent.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/event/sendChatEvent.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/index.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/message/Message.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/message/MessageSuccessEventData.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/message/createTextMessageData.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/message/getAuthor.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/message/isMessage.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/message/isMessageCreatedEvent.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/message/loadMoreMessagesEventData.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/message/loadMoreMessagesPayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/message/sendMessage.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/message/sendMessagePayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/request/makeRequest.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/request/messageHandler.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/request/requestQueue.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/sockets/EventPayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/sockets/WebSocketClient.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/sockets/WebSocketClientError.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/Thread.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/archiveThread.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/index.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/isLoadMetadataSuccessPayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/isRecoverSuccessPayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/isThreadArchivedSuccessPayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/isThreadListFetchedPostbackData.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/lastMessageSeenPayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/livechatThread/LivechatThread.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/livechatThread/createEndThreadPayloadData.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/livechatThread/isSetPositionInQueuePayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/livechatThread/recoverLivechatThreadPayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/metadata.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/recoverThreadPayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/setThreadCustomFieldsPayload.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/storeContactId.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/storeContactIdMiddleware.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/storeThreadScrollData.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/storeThreadScrollDataMiddleware.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/threadEventHandler.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/typingEvents.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/thread/updateThread.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/utils/assert.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/utils/generateId.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/utils/getBrandIdAndChannelId.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/utils/is.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/utils/last.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/utils/narrowing.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/utils/splitName.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/utils/uniq.ts","webpack://@BrandEmbassy/chat-web-sdk/./src/visitor/createVisitorPayload.ts","webpack://@BrandEmbassy/chat-web-sdk/external umd \"ua-parser-js\"","webpack://@BrandEmbassy/chat-web-sdk/external umd \"uuid\"","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_Map.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_Set.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_Symbol.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_getRawTag.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_objectToString.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseGetTag.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_nativeKeys.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_overArg.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseKeys.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_freeGlobal.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_coreJsData.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_isMasked.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseIsNative.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_getNative.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_getValue.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_DataView.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_Promise.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_WeakMap.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_getTag.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_isPrototype.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_root.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_toSource.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseIsArguments.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isArguments.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isArray.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isArrayLike.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isBuffer.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/stubFalse.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isEmpty.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isFunction.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isLength.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isNil.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isNull.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isObject.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isObjectLike.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseIsTypedArray.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_nodeUtil.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isTypedArray.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseUnary.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isUndefined.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/last.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_listCacheClear.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/eq.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_assocIndexOf.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_listCacheDelete.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_ListCache.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_listCacheGet.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_listCacheHas.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_listCacheSet.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_nativeCreate.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_hashGet.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_hashHas.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_Hash.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_hashClear.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_hashDelete.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_hashSet.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_getMapData.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_isKeyable.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_MapCache.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_mapCacheClear.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_mapCacheDelete.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_mapCacheGet.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_mapCacheHas.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_mapCacheSet.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_Stack.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_stackClear.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_stackDelete.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_stackGet.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_stackHas.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_stackSet.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_SetCache.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_setCacheAdd.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_setCacheHas.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_arraySome.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_cacheHas.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_equalArrays.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_Uint8Array.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_mapToArray.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_setToArray.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_equalByTag.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_getSymbols.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_arrayFilter.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/stubArray.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_isIndex.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_arrayLikeKeys.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseTimes.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/keys.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_getAllKeys.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseGetAllKeys.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_arrayPush.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_equalObjects.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseIsEqualDeep.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseIsEqual.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_isStrictComparable.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_matchesStrictComparable.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseMatches.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_getMatchData.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseIsMatch.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/isSymbol.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_isKey.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/memoize.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_stringToPath.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_memoizeCapped.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseToString.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_arrayMap.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_castPath.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/toString.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_toKey.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseGet.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseHasIn.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_hasPath.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/hasIn.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseMatchesProperty.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/get.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/identity.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/property.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseProperty.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_basePropertyDeep.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseIsNaN.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_arrayIncludes.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseIndexOf.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_strictIndexOf.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseFindIndex.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_arrayIncludesWith.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/noop.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_createSet.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/uniqBy.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseUniq.js","webpack://@BrandEmbassy/chat-web-sdk/./node_modules/lodash-es/_baseIteratee.js","webpack://@BrandEmbassy/chat-web-sdk/webpack/bootstrap","webpack://@BrandEmbassy/chat-web-sdk/webpack/runtime/define property getters","webpack://@BrandEmbassy/chat-web-sdk/webpack/runtime/hasOwnProperty shorthand","webpack://@BrandEmbassy/chat-web-sdk/webpack/runtime/make namespace object","webpack://@BrandEmbassy/chat-web-sdk/webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"uuid\"), require(\"ua-parser-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"uuid\", \"ua-parser-js\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"uuid\"), require(\"ua-parser-js\")) : factory(root[\"uuid\"], root[\"ua-parser-js\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, (__WEBPACK_EXTERNAL_MODULE__459__, __WEBPACK_EXTERNAL_MODULE__2007__) => {\nreturn ","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createQueryParametersAsString = void 0;\nfunction createQueryParametersAsString(queryParameters) {\n    return Object.keys(queryParameters)\n        .filter(function (key) { return queryParameters[key] !== null; })\n        .map(function (key) {\n        return [key, queryParameters[key]].map(encodeURIComponent).join('=');\n    })\n        .join('&');\n}\nexports.createQueryParametersAsString = createQueryParametersAsString;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EventTargetPolyfill = void 0;\nvar EventTargetPolyfill = (function () {\n    function EventTargetPolyfill() {\n        this.listeners = {};\n    }\n    EventTargetPolyfill.prototype.addEventListener = function (type, callback) {\n        if (!(type in this.listeners)) {\n            this.listeners[type] = [];\n        }\n        this.listeners[type].push(callback);\n    };\n    EventTargetPolyfill.prototype.removeEventListener = function (type, callback) {\n        if (!(type in this.listeners)) {\n            return;\n        }\n        var stack = this.listeners[type];\n        for (var i = 0, l = stack.length; i < l; i++) {\n            if (stack[i] === callback) {\n                stack.splice(i, 1);\n                return;\n            }\n        }\n    };\n    EventTargetPolyfill.prototype.dispatchEvent = function (event) {\n        if (!(event.type in this.listeners)) {\n            return true;\n        }\n        var stack = this.listeners[event.type].slice();\n        for (var i = 0, l = stack.length; i < l; i++) {\n            stack[i].call(this, event);\n        }\n        return !event.defaultPrevented;\n    };\n    return EventTargetPolyfill;\n}());\nexports.EventTargetPolyfill = EventTargetPolyfill;\n//# sourceMappingURL=EventTargetPolyfill.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebSocketClientEvent = exports.WebSocketClient = exports.EventTargetPolyfill = exports.HeartBeatState = void 0;\nvar HeartBeatState_1 = require(\"./websocket/HeartBeatState\");\nObject.defineProperty(exports, \"HeartBeatState\", { enumerable: true, get: function () { return HeartBeatState_1.HeartBeatState; } });\nvar EventTargetPolyfill_1 = require(\"./eventTargetPolyfill/EventTargetPolyfill\");\nObject.defineProperty(exports, \"EventTargetPolyfill\", { enumerable: true, get: function () { return EventTargetPolyfill_1.EventTargetPolyfill; } });\nvar WebSocketClient_1 = require(\"./websocket/WebSocketClient\");\nObject.defineProperty(exports, \"WebSocketClient\", { enumerable: true, get: function () { return WebSocketClient_1.WebSocketClient; } });\nvar WebSocketClientEvent_1 = require(\"./websocket/WebSocketClientEvent\");\nObject.defineProperty(exports, \"WebSocketClientEvent\", { enumerable: true, get: function () { return WebSocketClientEvent_1.WebSocketClientEvent; } });\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getPushUpdateWebSocket = exports.setupSocketConnection = void 0;\nvar WebSocketClient_1 = require(\"../websocket/WebSocketClient\");\nvar WebSocketClientEvent_1 = require(\"../websocket/WebSocketClientEvent\");\nvar socket = null;\nfunction createWebSocketUrlWithProtocol(webSocketUrlWithoutProtocol, forceSecureProtocol) {\n    if (forceSecureProtocol) {\n        return \"wss://\" + webSocketUrlWithoutProtocol;\n    }\n    var protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';\n    return protocol + \"//\" + webSocketUrlWithoutProtocol;\n}\nvar defaultConnectionOptions = {\n    forceSecureProtocol: false,\n    heartbeatAfterAuthorize: false,\n    maxRetries: 20,\n    maxReconnectionDelay: 1000,\n};\nvar setupSocketConnection = function (webSocketUrlWithoutProtocol, options) {\n    if (options === void 0) { options = {}; }\n    if (typeof options !== 'object') {\n        throw new TypeError(\"Options parameter must be an object not a \" + typeof options);\n    }\n    var connectionOptions = __assign(__assign({}, defaultConnectionOptions), options);\n    var forceSecureProtocol = connectionOptions.forceSecureProtocol, heartbeatAfterAuthorize = connectionOptions.heartbeatAfterAuthorize, wscOptions = __rest(connectionOptions, [\"forceSecureProtocol\", \"heartbeatAfterAuthorize\"]);\n    var url = createWebSocketUrlWithProtocol(webSocketUrlWithoutProtocol, forceSecureProtocol);\n    socket = new WebSocketClient_1.WebSocketClient(url, undefined, wscOptions);\n    if (heartbeatAfterAuthorize) {\n        socket.addEventListener(WebSocketClientEvent_1.WebSocketClientEvent.MESSAGE, function (event) {\n            if (JSON.parse(event.detail.data) === 'authorized') {\n                socket === null || socket === void 0 ? void 0 : socket.startHeartBeat();\n            }\n        });\n    }\n    else {\n        socket.startHeartBeat();\n    }\n    return socket;\n};\nexports.setupSocketConnection = setupSocketConnection;\nvar getPushUpdateWebSocket = function () { return socket; };\nexports.getPushUpdateWebSocket = getPushUpdateWebSocket;\n//# sourceMappingURL=pushUpdateWebSocket.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HeartBeatState = void 0;\nvar HeartBeatState;\n(function (HeartBeatState) {\n    HeartBeatState[\"DIED\"] = \"died\";\n    HeartBeatState[\"DYING\"] = \"dying\";\n    HeartBeatState[\"LIVING\"] = \"living\";\n})(HeartBeatState = exports.HeartBeatState || (exports.HeartBeatState = {}));\n//# sourceMappingURL=HeartBeatState.js.map","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebSocketClient = exports.HEART_BEAT_CHECK_TIMEOUT = exports.HEART_BEAT_INTERVAL = void 0;\nvar reconnecting_websocket_1 = __importDefault(require(\"@brandembassy/reconnecting-websocket\"));\nvar EventTargetPolyfill_1 = require(\"../eventTargetPolyfill/EventTargetPolyfill\");\nvar HeartBeatState_1 = require(\"./HeartBeatState\");\nvar WebSocketClientEvent_1 = require(\"./WebSocketClientEvent\");\nexports.HEART_BEAT_INTERVAL = 3000;\nexports.HEART_BEAT_CHECK_TIMEOUT = exports.HEART_BEAT_INTERVAL * 3;\nvar HEART_BEAT_RESPONSE = 'pong';\nvar HEART_BEAT_ACTION_NAME = 'heartbeat';\nvar WebSocketClient = (function (_super) {\n    __extends(WebSocketClient, _super);\n    function WebSocketClient(url, protocols, options) {\n        var _this = _super.call(this) || this;\n        _this.heartBeatTimeout = null;\n        _this.heartBeatCheckTimeout = null;\n        _this.sendHeartBeat = function () {\n            _this.send(JSON.stringify({ action: HEART_BEAT_ACTION_NAME }));\n        };\n        _this.handleHeartBeatResponse = function () {\n            if (_this.heartBeatState === HeartBeatState_1.HeartBeatState.DYING) {\n                _this.heartBeatState = HeartBeatState_1.HeartBeatState.LIVING;\n                _this.dispatchHeartBeatState();\n            }\n            _this.setHeartBeatCheckTimeout();\n        };\n        _this.setHeartBeatCheckTimeout = function () {\n            if (_this.heartBeatCheckTimeout !== null) {\n                clearTimeout(_this.heartBeatCheckTimeout);\n            }\n            _this.heartBeatCheckTimeout = setTimeout(function () {\n                _this.heartBeatState = HeartBeatState_1.HeartBeatState.DYING;\n                _this.dispatchHeartBeatState();\n            }, exports.HEART_BEAT_CHECK_TIMEOUT);\n        };\n        _this.dispatchHeartBeatState = function () {\n            if (_this.heartBeatState !== null) {\n                _this.dispatchEvent(new CustomEvent(_this.heartBeatState));\n            }\n        };\n        _this.isHeartBeatActive = function () {\n            return _this.heartBeatState !== null;\n        };\n        _this.heartBeatState = null;\n        _this.socket = new reconnecting_websocket_1.default(url, protocols, options);\n        _this.socket.onopen = function () {\n            _this.dispatchEvent(new CustomEvent(WebSocketClientEvent_1.WebSocketClientEvent.OPEN));\n        };\n        _this.socket.onclose = function () {\n            if (_this.socket.retryCount === (options === null || options === void 0 ? void 0 : options.maxRetries)) {\n                _this.heartBeatState = HeartBeatState_1.HeartBeatState.DIED;\n            }\n            else {\n                _this.heartBeatState = HeartBeatState_1.HeartBeatState.DYING;\n            }\n            _this.dispatchHeartBeatState();\n            _this.dispatchEvent(new CustomEvent(WebSocketClientEvent_1.WebSocketClientEvent.CLOSE));\n        };\n        _this.socket.onmessage = function (event) {\n            _this.handleHeartBeatResponse();\n            if (JSON.parse(event.data) !== HEART_BEAT_RESPONSE) {\n                _this.dispatchEvent(new CustomEvent(WebSocketClientEvent_1.WebSocketClientEvent.MESSAGE, { detail: event }));\n            }\n        };\n        return _this;\n    }\n    WebSocketClient.prototype.send = function (data) {\n        this.socket.send(data);\n    };\n    WebSocketClient.prototype.startHeartBeat = function () {\n        var _this = this;\n        var heartBeatCallback = function () {\n            _this.sendHeartBeat();\n            _this.heartBeatTimeout = setTimeout(heartBeatCallback, exports.HEART_BEAT_INTERVAL);\n        };\n        this.setHeartBeatCheckTimeout();\n        heartBeatCallback();\n        this.heartBeatState = HeartBeatState_1.HeartBeatState.LIVING;\n    };\n    WebSocketClient.prototype.stopHeartBeat = function () {\n        if (this.heartBeatTimeout !== null) {\n            clearTimeout(this.heartBeatTimeout);\n        }\n        if (this.heartBeatCheckTimeout !== null) {\n            clearTimeout(this.heartBeatCheckTimeout);\n        }\n        this.heartBeatState = null;\n    };\n    return WebSocketClient;\n}(EventTargetPolyfill_1.EventTargetPolyfill));\nexports.WebSocketClient = WebSocketClient;\n//# sourceMappingURL=WebSocketClient.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebSocketClientEvent = void 0;\nvar WebSocketClientEvent;\n(function (WebSocketClientEvent) {\n    WebSocketClientEvent[\"CLOSE\"] = \"close\";\n    WebSocketClientEvent[\"MESSAGE\"] = \"message\";\n    WebSocketClientEvent[\"OPEN\"] = \"open\";\n})(WebSocketClientEvent = exports.WebSocketClientEvent || (exports.WebSocketClientEvent = {}));\n//# sourceMappingURL=WebSocketClientEvent.js.map","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nfunction __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\n\nvar Event = /** @class */ (function () {\r\n    function Event(type, target) {\r\n        this.target = target;\r\n        this.type = type;\r\n    }\r\n    return Event;\r\n}());\r\nvar ErrorEvent = /** @class */ (function (_super) {\r\n    __extends(ErrorEvent, _super);\r\n    function ErrorEvent(error, target) {\r\n        var _this = _super.call(this, 'error', target) || this;\r\n        _this.message = error.message;\r\n        _this.error = error;\r\n        return _this;\r\n    }\r\n    return ErrorEvent;\r\n}(Event));\r\nvar CloseEvent = /** @class */ (function (_super) {\r\n    __extends(CloseEvent, _super);\r\n    function CloseEvent(code, reason, target) {\r\n        if (code === void 0) { code = 1000; }\r\n        if (reason === void 0) { reason = ''; }\r\n        var _this = _super.call(this, 'close', target) || this;\r\n        _this.wasClean = true;\r\n        _this.code = code;\r\n        _this.reason = reason;\r\n        return _this;\r\n    }\r\n    return CloseEvent;\r\n}(Event));\n\n/*!\r\n * Reconnecting WebSocket\r\n * by Pedro Ladaria <pedro.ladaria@gmail.com>\r\n * https://github.com/pladaria/reconnecting-websocket\r\n * License MIT\r\n */\r\nvar getGlobalWebSocket = function () {\r\n    if (typeof WebSocket !== 'undefined') {\r\n        // @ts-ignore\r\n        return WebSocket;\r\n    }\r\n};\r\n/**\r\n * Returns true if given argument looks like a WebSocket class\r\n */\r\nvar isWebSocket = function (w) { return typeof w !== 'undefined' && !!w && w.CLOSING === 2; };\r\nvar DEFAULT = {\r\n    maxReconnectionDelay: 10000,\r\n    minReconnectionDelay: 1000 + Math.random() * 4000,\r\n    minUptime: 5000,\r\n    reconnectionDelayGrowFactor: 1.3,\r\n    connectionTimeout: 4000,\r\n    maxRetries: Infinity,\r\n    maxEnqueuedMessages: Infinity,\r\n    startClosed: false,\r\n    debug: false,\r\n};\r\nvar ReconnectingWebSocket = /** @class */ (function () {\r\n    function ReconnectingWebSocket(url, protocols, options) {\r\n        var _this = this;\r\n        if (options === void 0) { options = {}; }\r\n        this._listeners = {\r\n            error: [],\r\n            message: [],\r\n            open: [],\r\n            close: [],\r\n        };\r\n        this._retryCount = -1;\r\n        this._shouldReconnect = true;\r\n        this._connectLock = false;\r\n        this._binaryType = 'blob';\r\n        this._closeCalled = false;\r\n        this._messageQueue = [];\r\n        /**\r\n         * An event listener to be called when the WebSocket connection's readyState changes to CLOSED\r\n         */\r\n        this.onclose = null;\r\n        /**\r\n         * An event listener to be called when an error occurs\r\n         */\r\n        this.onerror = null;\r\n        /**\r\n         * An event listener to be called when a message is received from the server\r\n         */\r\n        this.onmessage = null;\r\n        /**\r\n         * An event listener to be called when the WebSocket connection's readyState changes to OPEN;\r\n         * this indicates that the connection is ready to send and receive data\r\n         */\r\n        this.onopen = null;\r\n        this._handleOpen = function (event) {\r\n            _this._debug('open event');\r\n            var _a = _this._options.minUptime, minUptime = _a === void 0 ? DEFAULT.minUptime : _a;\r\n            clearTimeout(_this._connectTimeout);\r\n            _this._uptimeTimeout = setTimeout(function () { return _this._acceptOpen(); }, minUptime);\r\n            _this._ws.binaryType = _this._binaryType;\r\n            // send enqueued messages (messages sent before websocket open event)\r\n            _this._messageQueue.forEach(function (message) { var _a; return (_a = _this._ws) === null || _a === void 0 ? void 0 : _a.send(message); });\r\n            _this._messageQueue = [];\r\n            if (_this.onopen) {\r\n                _this.onopen(event);\r\n            }\r\n            _this._listeners.open.forEach(function (listener) { return _this._callEventListener(event, listener); });\r\n        };\r\n        this._handleMessage = function (event) {\r\n            _this._debug('message event');\r\n            if (_this.onmessage) {\r\n                _this.onmessage(event);\r\n            }\r\n            _this._listeners.message.forEach(function (listener) { return _this._callEventListener(event, listener); });\r\n        };\r\n        this._handleError = function (event) {\r\n            _this._debug('error event', event.message);\r\n            _this._disconnect(undefined, event.message === 'TIMEOUT' ? 'timeout' : undefined);\r\n            if (_this.onerror) {\r\n                _this.onerror(event);\r\n            }\r\n            _this._debug('exec error listeners');\r\n            _this._listeners.error.forEach(function (listener) { return _this._callEventListener(event, listener); });\r\n            _this._connect();\r\n        };\r\n        this._handleClose = function (event) {\r\n            _this._debug('close event');\r\n            _this._clearTimeouts();\r\n            if (_this._shouldReconnect) {\r\n                _this._connect();\r\n            }\r\n            if (_this.onclose) {\r\n                _this.onclose(event);\r\n            }\r\n            _this._listeners.close.forEach(function (listener) { return _this._callEventListener(event, listener); });\r\n        };\r\n        this._url = url;\r\n        this._protocols = protocols;\r\n        this._options = options;\r\n        if (this._options.startClosed) {\r\n            this._shouldReconnect = false;\r\n        }\r\n        this._connect();\r\n    }\r\n    Object.defineProperty(ReconnectingWebSocket, \"CONNECTING\", {\r\n        get: function () {\r\n            return 0;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket, \"OPEN\", {\r\n        get: function () {\r\n            return 1;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket, \"CLOSING\", {\r\n        get: function () {\r\n            return 2;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket, \"CLOSED\", {\r\n        get: function () {\r\n            return 3;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"CONNECTING\", {\r\n        get: function () {\r\n            return ReconnectingWebSocket.CONNECTING;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"OPEN\", {\r\n        get: function () {\r\n            return ReconnectingWebSocket.OPEN;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"CLOSING\", {\r\n        get: function () {\r\n            return ReconnectingWebSocket.CLOSING;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"CLOSED\", {\r\n        get: function () {\r\n            return ReconnectingWebSocket.CLOSED;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"binaryType\", {\r\n        get: function () {\r\n            return this._ws ? this._ws.binaryType : this._binaryType;\r\n        },\r\n        set: function (value) {\r\n            this._binaryType = value;\r\n            if (this._ws) {\r\n                this._ws.binaryType = value;\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"retryCount\", {\r\n        /**\r\n         * Returns the number or connection retries\r\n         */\r\n        get: function () {\r\n            return Math.max(this._retryCount, 0);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"bufferedAmount\", {\r\n        /**\r\n         * The number of bytes of data that have been queued using calls to send() but not yet\r\n         * transmitted to the network. This value resets to zero once all queued data has been sent.\r\n         * This value does not reset to zero when the connection is closed; if you keep calling send(),\r\n         * this will continue to climb. Read only\r\n         */\r\n        get: function () {\r\n            var bytes = this._messageQueue.reduce(function (acc, message) {\r\n                if (typeof message === 'string') {\r\n                    acc += message.length; // not byte size\r\n                }\r\n                else if (message instanceof Blob) {\r\n                    acc += message.size;\r\n                }\r\n                else {\r\n                    acc += message.byteLength;\r\n                }\r\n                return acc;\r\n            }, 0);\r\n            return bytes + (this._ws ? this._ws.bufferedAmount : 0);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"extensions\", {\r\n        /**\r\n         * The extensions selected by the server. This is currently only the empty string or a list of\r\n         * extensions as negotiated by the connection\r\n         */\r\n        get: function () {\r\n            return this._ws ? this._ws.extensions : '';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"protocol\", {\r\n        /**\r\n         * A string indicating the name of the sub-protocol the server selected;\r\n         * this will be one of the strings specified in the protocols parameter when creating the\r\n         * WebSocket object\r\n         */\r\n        get: function () {\r\n            return this._ws ? this._ws.protocol : '';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"readyState\", {\r\n        /**\r\n         * The current state of the connection; this is one of the Ready state constants\r\n         */\r\n        get: function () {\r\n            if (this._ws) {\r\n                return this._ws.readyState;\r\n            }\r\n            return this._options.startClosed\r\n                ? ReconnectingWebSocket.CLOSED\r\n                : ReconnectingWebSocket.CONNECTING;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ReconnectingWebSocket.prototype, \"url\", {\r\n        /**\r\n         * The URL as resolved by the constructor\r\n         */\r\n        get: function () {\r\n            return this._ws ? this._ws.url : '';\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * Closes the WebSocket connection or connection attempt, if any. If the connection is already\r\n     * CLOSED, this method does nothing\r\n     */\r\n    ReconnectingWebSocket.prototype.close = function (code, reason) {\r\n        if (code === void 0) { code = 1000; }\r\n        this._closeCalled = true;\r\n        this._shouldReconnect = false;\r\n        this._clearTimeouts();\r\n        if (!this._ws) {\r\n            this._debug('close enqueued: no ws instance');\r\n            return;\r\n        }\r\n        if (this._ws.readyState === this.CLOSED) {\r\n            this._debug('close: already closed');\r\n            return;\r\n        }\r\n        this._ws.close(code, reason);\r\n    };\r\n    /**\r\n     * Closes the WebSocket connection or connection attempt and connects again.\r\n     * Resets retry counter;\r\n     */\r\n    ReconnectingWebSocket.prototype.reconnect = function (code, reason) {\r\n        this._shouldReconnect = true;\r\n        this._closeCalled = false;\r\n        this._retryCount = -1;\r\n        if (!this._ws || this._ws.readyState === this.CLOSED) {\r\n            this._connect();\r\n        }\r\n        else {\r\n            this._disconnect(code, reason);\r\n            this._connect();\r\n        }\r\n    };\r\n    /**\r\n     * Enqueue specified data to be transmitted to the server over the WebSocket connection\r\n     */\r\n    ReconnectingWebSocket.prototype.send = function (data) {\r\n        if (this._ws && this._ws.readyState === this.OPEN) {\r\n            this._debug('send', data);\r\n            this._ws.send(data);\r\n        }\r\n        else {\r\n            var _a = this._options.maxEnqueuedMessages, maxEnqueuedMessages = _a === void 0 ? DEFAULT.maxEnqueuedMessages : _a;\r\n            if (this._messageQueue.length < maxEnqueuedMessages) {\r\n                this._debug('enqueue', data);\r\n                this._messageQueue.push(data);\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * Register an event handler of a specific event type\r\n     */\r\n    ReconnectingWebSocket.prototype.addEventListener = function (type, listener) {\r\n        if (this._listeners[type]) {\r\n            // @ts-ignore\r\n            this._listeners[type].push(listener);\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype.dispatchEvent = function (event) {\r\n        var e_1, _a;\r\n        var listeners = this._listeners[event.type];\r\n        if (listeners) {\r\n            try {\r\n                for (var listeners_1 = __values(listeners), listeners_1_1 = listeners_1.next(); !listeners_1_1.done; listeners_1_1 = listeners_1.next()) {\r\n                    var listener = listeners_1_1.value;\r\n                    this._callEventListener(event, listener);\r\n                }\r\n            }\r\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n            finally {\r\n                try {\r\n                    if (listeners_1_1 && !listeners_1_1.done && (_a = listeners_1.return)) _a.call(listeners_1);\r\n                }\r\n                finally { if (e_1) throw e_1.error; }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    /**\r\n     * Removes an event listener\r\n     */\r\n    ReconnectingWebSocket.prototype.removeEventListener = function (type, listener) {\r\n        if (this._listeners[type]) {\r\n            // @ts-ignore\r\n            this._listeners[type] = this._listeners[type].filter(function (l) { return l !== listener; });\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype._debug = function () {\r\n        var args = [];\r\n        for (var _i = 0; _i < arguments.length; _i++) {\r\n            args[_i] = arguments[_i];\r\n        }\r\n        if (this._options.debug) {\r\n            // not using spread because compiled version uses Symbols\r\n            // tslint:disable-next-line\r\n            console.log.apply(console, __spread(['RWS>'], args));\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype._getNextDelay = function () {\r\n        var _a = this._options, _b = _a.reconnectionDelayGrowFactor, reconnectionDelayGrowFactor = _b === void 0 ? DEFAULT.reconnectionDelayGrowFactor : _b, _c = _a.minReconnectionDelay, minReconnectionDelay = _c === void 0 ? DEFAULT.minReconnectionDelay : _c, _d = _a.maxReconnectionDelay, maxReconnectionDelay = _d === void 0 ? DEFAULT.maxReconnectionDelay : _d;\r\n        var delay = 0;\r\n        if (this._retryCount > 0) {\r\n            delay =\r\n                minReconnectionDelay * Math.pow(reconnectionDelayGrowFactor, this._retryCount - 1);\r\n            if (delay > maxReconnectionDelay) {\r\n                delay = maxReconnectionDelay;\r\n            }\r\n        }\r\n        this._debug('next delay', delay);\r\n        return delay;\r\n    };\r\n    ReconnectingWebSocket.prototype._wait = function () {\r\n        var _this = this;\r\n        return new Promise(function (resolve) {\r\n            setTimeout(resolve, _this._getNextDelay());\r\n        });\r\n    };\r\n    ReconnectingWebSocket.prototype._getNextUrl = function (urlProvider) {\r\n        if (typeof urlProvider === 'string') {\r\n            return Promise.resolve(urlProvider);\r\n        }\r\n        if (typeof urlProvider === 'function') {\r\n            var url = urlProvider();\r\n            if (typeof url === 'string') {\r\n                return Promise.resolve(url);\r\n            }\r\n            // @ts-ignore redundant check\r\n            if (url.then) {\r\n                return url;\r\n            }\r\n        }\r\n        throw Error('Invalid URL');\r\n    };\r\n    ReconnectingWebSocket.prototype._connect = function () {\r\n        var _this = this;\r\n        if (this._connectLock || !this._shouldReconnect) {\r\n            return;\r\n        }\r\n        this._connectLock = true;\r\n        var _a = this._options, _b = _a.maxRetries, maxRetries = _b === void 0 ? DEFAULT.maxRetries : _b, _c = _a.connectionTimeout, connectionTimeout = _c === void 0 ? DEFAULT.connectionTimeout : _c, _d = _a.WebSocket, WebSocket = _d === void 0 ? getGlobalWebSocket() : _d;\r\n        if (this._retryCount >= maxRetries) {\r\n            this._debug('max retries reached', this._retryCount, '>=', maxRetries);\r\n            return;\r\n        }\r\n        this._retryCount++;\r\n        this._debug('connect', this._retryCount);\r\n        this._removeListeners();\r\n        if (!isWebSocket(WebSocket)) {\r\n            throw Error('No valid WebSocket class provided');\r\n        }\r\n        this._wait()\r\n            .then(function () { return _this._getNextUrl(_this._url); })\r\n            .then(function (url) {\r\n            // close could be called before creating the ws\r\n            if (_this._closeCalled) {\r\n                _this._connectLock = false;\r\n                return;\r\n            }\r\n            _this._debug('connect', { url: url, protocols: _this._protocols });\r\n            _this._ws = _this._protocols\r\n                ? new WebSocket(url, _this._protocols)\r\n                : new WebSocket(url);\r\n            _this._ws.binaryType = _this._binaryType;\r\n            _this._connectLock = false;\r\n            _this._addListeners();\r\n            _this._connectTimeout = setTimeout(function () { return _this._handleTimeout(); }, connectionTimeout);\r\n        })\r\n            .catch(function (err) {\r\n            _this._connectLock = false;\r\n            _this._handleError(new ErrorEvent(Error(err.message), _this));\r\n        });\r\n    };\r\n    ReconnectingWebSocket.prototype._handleTimeout = function () {\r\n        this._debug('timeout event');\r\n        this._handleError(new ErrorEvent(Error('TIMEOUT'), this));\r\n    };\r\n    ReconnectingWebSocket.prototype._disconnect = function (code, reason) {\r\n        if (code === void 0) { code = 1000; }\r\n        this._clearTimeouts();\r\n        if (!this._ws) {\r\n            return;\r\n        }\r\n        this._removeListeners();\r\n        try {\r\n            this._ws.close(code, reason);\r\n            this._handleClose(new CloseEvent(code, reason, this));\r\n        }\r\n        catch (error) {\r\n            // ignore\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype._acceptOpen = function () {\r\n        this._debug('accept open');\r\n        this._retryCount = 0;\r\n    };\r\n    ReconnectingWebSocket.prototype._callEventListener = function (event, listener) {\r\n        if ('handleEvent' in listener) {\r\n            // @ts-ignore\r\n            listener.handleEvent(event);\r\n        }\r\n        else {\r\n            // @ts-ignore\r\n            listener(event);\r\n        }\r\n    };\r\n    ReconnectingWebSocket.prototype._removeListeners = function () {\r\n        if (!this._ws) {\r\n            return;\r\n        }\r\n        this._debug('removeListeners');\r\n        this._ws.removeEventListener('open', this._handleOpen);\r\n        this._ws.removeEventListener('close', this._handleClose);\r\n        this._ws.removeEventListener('message', this._handleMessage);\r\n        // @ts-ignore\r\n        this._ws.removeEventListener('error', this._handleError);\r\n    };\r\n    ReconnectingWebSocket.prototype._addListeners = function () {\r\n        if (!this._ws) {\r\n            return;\r\n        }\r\n        this._debug('addListeners');\r\n        this._ws.addEventListener('open', this._handleOpen);\r\n        this._ws.addEventListener('close', this._handleClose);\r\n        this._ws.addEventListener('message', this._handleMessage);\r\n        // @ts-ignore\r\n        this._ws.addEventListener('error', this._handleError);\r\n    };\r\n    ReconnectingWebSocket.prototype._clearTimeouts = function () {\r\n        clearTimeout(this._connectTimeout);\r\n        clearTimeout(this._uptimeTimeout);\r\n    };\r\n    return ReconnectingWebSocket;\r\n}());\n\nexport default ReconnectingWebSocket;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar AwsChatWindowEventActionRoute;\n(function (AwsChatWindowEventActionRoute) {\n    AwsChatWindowEventActionRoute[\"CHAT_WINDOW_EVENT\"] = \"chatWindowEvent\";\n    AwsChatWindowEventActionRoute[\"REGISTER\"] = \"register\";\n})(AwsChatWindowEventActionRoute = exports.AwsChatWindowEventActionRoute || (exports.AwsChatWindowEventActionRoute = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar AwsInputEventType;\n(function (AwsInputEventType) {\n    AwsInputEventType[\"SENDER_TYPING_STARTED\"] = \"SenderTypingStarted\";\n    AwsInputEventType[\"SENDER_TYPING_ENDED\"] = \"SenderTypingEnded\";\n    AwsInputEventType[\"LOAD_MORE_MESSAGES\"] = \"LoadMoreMessages\";\n    AwsInputEventType[\"RECOVER_LIVECHAT\"] = \"RecoverLivechat\";\n    AwsInputEventType[\"RECOVER_THREAD\"] = \"RecoverThread\";\n    AwsInputEventType[\"SEND_MESSAGE\"] = \"SendMessage\";\n    AwsInputEventType[\"SEND_OUTBOUND\"] = \"SendOutbound\";\n    AwsInputEventType[\"SEND_OFFLINE_MESSAGE\"] = \"SendOfflineMessage\";\n    AwsInputEventType[\"SEND_PAGE_VIEWS\"] = \"SendPageViews\";\n    AwsInputEventType[\"SEND_CONSUMER_CUSTOM_FIELDS\"] = \"SetConsumerCustomFields\";\n    AwsInputEventType[\"SET_CONSUMER_CONTACT_CUSTOM_FIELD\"] = \"SetConsumerContactCustomFields\";\n    AwsInputEventType[\"MESSAGE_SEEN\"] = \"MessageSeenByConsumer\";\n    AwsInputEventType[\"SEND_TRANSCRIPT\"] = \"SendTranscript\";\n    AwsInputEventType[\"FETCH_THREAD_LIST\"] = \"FetchThreadList\";\n    AwsInputEventType[\"END_CONTACT\"] = \"EndContact\";\n    AwsInputEventType[\"EXECUTE_TRIGGER\"] = \"ExecuteTrigger\";\n    AwsInputEventType[\"AUTHORIZE_CONSUMER\"] = \"AuthorizeConsumer\";\n    AwsInputEventType[\"RECONNECT_CONSUMER\"] = \"ReconnectConsumer\";\n    AwsInputEventType[\"UPDATE_THREAD\"] = \"UpdateThread\";\n    AwsInputEventType[\"ARCHIVE_THREAD\"] = \"ArchiveThread\";\n    AwsInputEventType[\"LOAD_THREAD_METADATA\"] = \"LoadThreadMetadata\";\n    AwsInputEventType[\"REFRESH_TOKEN\"] = \"RefreshToken\";\n    AwsInputEventType[\"STORE_VISITOR\"] = \"StoreVisitor\";\n    AwsInputEventType[\"STORE_VISITOR_EVENTS\"] = \"StoreVisitorEvents\";\n    AwsInputEventType[\"CREATE_GROUP_CHAT_INVITE\"] = \"CreateInvitationToGroupChat\";\n    AwsInputEventType[\"SEND_EMAIL_INVITE_TO_GROUP_CHAT\"] = \"SendEmailInvitationToGroupChat\";\n    AwsInputEventType[\"JOIN_GROUP_CHAT\"] = \"JoinGroupChat\";\n    AwsInputEventType[\"LEAVE_GROUP_CHAT\"] = \"LeaveGroupChat\";\n    AwsInputEventType[\"GENERATE_AUTHORIZATION_TOKEN\"] = \"GenerateAuthorizationToken\";\n})(AwsInputEventType = exports.AwsInputEventType || (exports.AwsInputEventType = {}));\nvar AwsResponseEventType;\n(function (AwsResponseEventType) {\n    AwsResponseEventType[\"LIVECHAT_RECOVERED\"] = \"LivechatRecovered\";\n    AwsResponseEventType[\"MORE_MESSAGES_LOADED\"] = \"MoreMessagesLoaded\";\n    AwsResponseEventType[\"OFFLINE_MESSAGE_SENT\"] = \"OfflineMessageSent\";\n    AwsResponseEventType[\"THREAD_LIST_FETCHED\"] = \"ThreadListFetched\";\n    AwsResponseEventType[\"THREAD_RECOVERED\"] = \"ThreadRecovered\";\n    AwsResponseEventType[\"TRANSCRIPT_SENT\"] = \"TranscriptSent\";\n    AwsResponseEventType[\"CONSUMER_AUTHORIZED\"] = \"ConsumerAuthorized\";\n    AwsResponseEventType[\"THREAD_METADATA_LOADED\"] = \"ThreadMetadataLoaded\";\n    AwsResponseEventType[\"SET_POSITION_IN_QUEUE\"] = \"SetPositionInQueue\";\n    AwsResponseEventType[\"GROUP_CHAT_INVITE_CREATED\"] = \"InvitationToGroupChatCreated\";\n    AwsResponseEventType[\"GROUP_CHAT_INVITE_SENT\"] = \"EmailInvitationToGroupChatSent\";\n    AwsResponseEventType[\"GROUP_CHAT_JOINED\"] = \"GroupChatJoined\";\n    AwsResponseEventType[\"TOKEN_REFRESHED\"] = \"TokenRefreshed\";\n    AwsResponseEventType[\"AUTHORIZATION_TOKEN_GENERATED\"] = \"AuthorizationTokenGenerated\";\n    AwsResponseEventType[\"THREAD_ARCHIVED\"] = \"ThreadArchived\";\n})(AwsResponseEventType = exports.AwsResponseEventType || (exports.AwsResponseEventType = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar DeviceType;\n(function (DeviceType) {\n    DeviceType[\"DESKTOP\"] = \"desktop\";\n    DeviceType[\"MOBILE\"] = \"mobile\";\n    DeviceType[\"OTHER\"] = \"other\";\n    DeviceType[\"TABLET\"] = \"tablet\";\n})(DeviceType = exports.DeviceType || (exports.DeviceType = {}));\nvar ApplicationType;\n(function (ApplicationType) {\n    ApplicationType[\"BROWSER\"] = \"browser\";\n})(ApplicationType = exports.ApplicationType || (exports.ApplicationType = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar MessageDirection;\n(function (MessageDirection) {\n    MessageDirection[\"INBOUND\"] = \"inbound\";\n    MessageDirection[\"OUTBOUND\"] = \"outbound\";\n})(MessageDirection = exports.MessageDirection || (exports.MessageDirection = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar MessageType;\n(function (MessageType) {\n    MessageType[\"TEXT\"] = \"TEXT\";\n    MessageType[\"FILE\"] = \"FILE\";\n    MessageType[\"PLUGIN\"] = \"PLUGIN\";\n    MessageType[\"POSTBACK\"] = \"POSTBACK\";\n    MessageType[\"QUICK_REPLIES\"] = \"QUICK_REPLIES\";\n})(MessageType = exports.MessageType || (exports.MessageType = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar CaseStatus;\n(function (CaseStatus) {\n    CaseStatus[\"NEW\"] = \"new\";\n    CaseStatus[\"OPEN\"] = \"open\";\n    CaseStatus[\"PENDING\"] = \"pending\";\n    CaseStatus[\"ESCALATED\"] = \"escalated\";\n    CaseStatus[\"RESOLVED\"] = \"resolved\";\n    CaseStatus[\"CLOSED\"] = \"closed\";\n    CaseStatus[\"TRASHED\"] = \"trashed\";\n})(CaseStatus = exports.CaseStatus || (exports.CaseStatus = {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar PushUpdateEventType;\n(function (PushUpdateEventType) {\n    PushUpdateEventType[\"AUTHORIZE_CONSUMER\"] = \"AuthorizeConsumer\";\n    PushUpdateEventType[\"CASE_CREATED\"] = \"CaseCreated\";\n    PushUpdateEventType[\"CASE_INBOX_ASSIGNEE_CHANGED\"] = \"CaseInboxAssigneeChanged\";\n    PushUpdateEventType[\"CASE_STATUS_CHANGED\"] = \"CaseStatusChanged\";\n    PushUpdateEventType[\"CASE_TO_ROUTING_QUEUE_ASSIGNMENT_CHANGED\"] = \"CaseToRoutingQueueAssignmentChanged\";\n    PushUpdateEventType[\"CHANNEL_CREATED\"] = \"ChannelCreated\";\n    PushUpdateEventType[\"CHANNEL_DELETED\"] = \"ChannelDeleted\";\n    PushUpdateEventType[\"CHANNEL_UPDATED\"] = \"ChannelUpdated\";\n    PushUpdateEventType[\"MESSAGE_ADDED_INTO_CASE\"] = \"MessageAddedIntoCase\";\n    PushUpdateEventType[\"MESSAGE_CREATED\"] = \"MessageCreated\";\n    PushUpdateEventType[\"MESSAGE_DELIVERED_TO_END_USER\"] = \"MessageDeliveredToEndUser\";\n    PushUpdateEventType[\"MESSAGE_DELIVERED_TO_USER\"] = \"MessageDeliveredToUser\";\n    PushUpdateEventType[\"MESSAGE_NOTE_CREATED\"] = \"MessageNoteCreated\";\n    PushUpdateEventType[\"MESSAGE_NOTE_UPDATED\"] = \"MessageNoteUpdated\";\n    PushUpdateEventType[\"MESSAGE_NOTE_DELETED\"] = \"MessageNoteDeleted\";\n    PushUpdateEventType[\"MESSAGE_READ_CHANGED\"] = \"MessageReadChanged\";\n    PushUpdateEventType[\"MESSAGE_SEEN_BY_END_USER\"] = \"MessageSeenByEndUser\";\n    PushUpdateEventType[\"MESSAGE_SEEN_BY_USER\"] = \"MessageSeenByUser\";\n    PushUpdateEventType[\"MESSAGE_UPDATED\"] = \"MessageUpdated\";\n    PushUpdateEventType[\"PAGE_VIEW_CREATED\"] = \"PageViewCreated\";\n    PushUpdateEventType[\"ROUTING_QUEUE_CREATED\"] = \"RoutingQueueCreated\";\n    PushUpdateEventType[\"ROUTING_QUEUE_DELETED\"] = \"RoutingQueueDeleted\";\n    PushUpdateEventType[\"ROUTING_QUEUE_UPDATED\"] = \"RoutingQueueUpdated\";\n    PushUpdateEventType[\"SUBQUEUE_ASSIGNED_TO_ROUTING_QUEUE\"] = \"SubqueueAssignedToRoutingQueue\";\n    PushUpdateEventType[\"SUBQUEUE_UNASSIGNED_TO_ROUTING_QUEUE\"] = \"SubqueueUnassignedFromRoutingQueue\";\n    PushUpdateEventType[\"USER_ASSIGNED_TO_ROUTING_QUEUE\"] = \"UserAssignedToRoutingQueue\";\n    PushUpdateEventType[\"USER_STATUS_CHANGED\"] = \"UserStatusChanged\";\n    PushUpdateEventType[\"USER_UNASSIGNED_FROM_ROUTING_QUEUE\"] = \"UserUnassignedFromRoutingQueue\";\n    PushUpdateEventType[\"AGENT_CONTACT_STARTED\"] = \"AgentContactStarted\";\n    PushUpdateEventType[\"AGENT_CONTACT_ENDED\"] = \"AgentContactEnded\";\n    PushUpdateEventType[\"SENDER_TYPING_STARTED\"] = \"SenderTypingStarted\";\n    PushUpdateEventType[\"SENDER_TYPING_ENDED\"] = \"SenderTypingEnded\";\n    PushUpdateEventType[\"FIRE_PROACTIVE\"] = \"FireProactiveAction\";\n    PushUpdateEventType[\"CONTACT_INBOX_PRE_ASSIGNEE_CHANGED\"] = \"ConsumerContactInboxPreAssigneeChanged\";\n    PushUpdateEventType[\"CONTACT_RECIPIENTS_CHANGED\"] = \"ContactRecipientsChanged\";\n})(PushUpdateEventType = exports.PushUpdateEventType || (exports.PushUpdateEventType = {}));\n","import { WebSocketClientEvent } from '@brandembassy/push-updates-sdk';\nimport { ConsumerAuthorizationSuccessPayloadData } from '@brandembassy/ts-types-chat/dist/authorization/ConsumerAuthorizationSuccessPayloadData';\nimport { AwsChatWindowEventActionRoute } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsChatWindowEvent';\nimport { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { IThread } from '@brandembassy/ts-types-chat/dist/post/thread/IThread';\nimport { BrandId } from '@brandembassy/ts-types-platform/dist/brand/BrandId';\nimport { ChannelId } from '@brandembassy/ts-types-platform/dist/channel/ChannelId';\nimport { CustomerIdentityIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/endUser/EndUserIdentityId';\nimport { ThreadIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/thread/ThreadIdOnExternalPlatform';\n\nimport {\n  getAccessToken,\n  setAccessToken,\n} from './authorization/accessTokenStorage';\nimport { createAuthorizationPayloadData } from './authorization/authorizationPayloadData';\nimport { createRefreshTokenPayload } from './authorization/createRefreshTokenPayload';\nimport { handleRefreshToken } from './authorization/handleRefreshToken';\nimport { isAuthSuccessEvent } from './authorization/isAuthSuccessEvent';\nimport { isTokenRefreshedSuccessResponse } from './authorization/isTokenRefreshedSuccessResponse';\nimport { ChatSDKOptions } from './ChatSDKOptions';\nimport { Customer } from './customer/customer';\nimport { ChatSDKVariable } from './env/ChatSDKVariable';\nimport { EnvironmentName, getEnvironmentEndpoints } from './env/Environments';\nimport { SDKVariableStorage } from './env/getEnvVariable';\nimport { ChatSDKError } from './error/ChatSDKError';\nimport { ChatEventData, ChatEventType } from './event/ChatEvent';\nimport { ChatEventMiddleware } from './event/ChatEventMiddleware';\nimport { ChatEventTarget, IChatEventTarget } from './event/ChatEventTarget';\nimport { RemoveListenerFunction } from './event/ListenerFunction';\nimport { chatEventMapper } from './event/middleware/ChatEventMapper';\nimport { sendChatEvent } from './event/sendChatEvent';\nimport { makeRequest } from './request/makeRequest';\nimport {\n  onMessageHandler,\n  parseWsMessageEvent,\n} from './request/messageHandler';\nimport { createEvent, createEventPayload } from './sockets/EventPayload';\nimport {\n  WebSocketClient,\n  WebSocketClientOptions,\n} from './sockets/WebSocketClient';\nimport { Thread, LivechatThread } from './thread';\nimport { isThreadListFetchedPostbackData } from './thread/isThreadListFetchedPostbackData';\nimport { storeContactIdMiddleware } from './thread/storeContactIdMiddleware';\nimport { storeThreadScrollDataMiddleware } from './thread/storeThreadScrollDataMiddleware';\nimport { assertNonNullable } from './utils/assert';\nimport { generateId } from './utils/generateId';\nimport { getBrandIdAndChannelId } from './utils/getBrandIdAndChannelId';\nimport { isEmpty, isNil, isNull } from './utils/is';\n\nexport class ChatSdk {\n  onError?: (error: Error) => void;\n  private websocketClient: WebSocketClient | null = null;\n  private customer: Customer | null = null;\n  private _incomingChatEventMiddleware = new ChatEventMiddleware();\n  private _messageEmitter: IChatEventTarget;\n  private isAuthorizationEnabled: boolean = false;\n  public isLivechat: boolean = false;\n  public channelId: ChannelId = '';\n\n  constructor(options: ChatSDKOptions) {\n    if (options === undefined) {\n      throw new Error('No options was provided for initialization of ChatSdk');\n    }\n\n    SDKVariableStorage.set(\n      ChatSDKVariable.AUTHORIZATION_CODE,\n      options.authorizationCode,\n    );\n    SDKVariableStorage.set(ChatSDKVariable.BRAND_ID, `${options.brandId}`);\n    SDKVariableStorage.set(ChatSDKVariable.CHANNEL_ID, options.channelId);\n\n    const { brandId, channelId } = getBrandIdAndChannelId();\n\n    this.onError = options.onError;\n\n    // Register middleware for incoming chat events\n    this._incomingChatEventMiddleware.register(chatEventMapper);\n    this._incomingChatEventMiddleware.register(storeThreadScrollDataMiddleware);\n    this._incomingChatEventMiddleware.register(storeContactIdMiddleware);\n\n    this._messageEmitter = new ChatEventTarget();\n\n    try {\n      if (isNaN(brandId)) {\n        throw new Error('Missing BrandID');\n      }\n      if (channelId === undefined) {\n        throw new Error('Missing ChannelId');\n      }\n      if (options.customerId === undefined) {\n        throw new Error('Missing CustomerId');\n      }\n\n      this._initEnvironment(options);\n      this._initWS(brandId, channelId, options.customerId);\n      // Init Customer instance after the websocketClient is initialized\n      this.customer = new Customer(\n        options.customerId,\n        options.customerName,\n        this.websocketClient,\n      );\n      this.channelId = channelId;\n    } catch (error: unknown) {\n      this.onErrorHandler(error);\n    }\n  }\n\n  onErrorHandler(error: unknown): void {\n    if (typeof this.onError === 'function') {\n      this.onError(new ChatSDKError(error));\n    } else {\n      throw new ChatSDKError(error);\n    }\n  }\n\n  /**\n   * Send Authorization Event\n   * @param authorizationCode\n   * @param visitorId\n   */\n  public async authorize(\n    authorizationCode?: string,\n    visitorId?: string,\n  ): Promise<ConsumerAuthorizationSuccessPayloadData> {\n    const authorizationPayloadData = createAuthorizationPayloadData(\n      authorizationCode ??\n        SDKVariableStorage.get(ChatSDKVariable.AUTHORIZATION_CODE, null),\n      visitorId,\n    );\n\n    const event = createEvent(\n      createEventPayload(authorizationPayloadData),\n      generateId(),\n      AwsChatWindowEventActionRoute.REGISTER,\n    );\n\n    const response = await makeRequest(event, this.websocketClient);\n\n    if (isAuthSuccessEvent(response)) {\n      this.isLivechat = response.data?.channel?.settings?.isLivechat ?? false;\n      this.isAuthorizationEnabled =\n        response.data.channel?.settings.isAuthorizationEnabled ?? false;\n\n      if (response.data.accessToken?.token !== undefined) {\n        setAccessToken(response.data.accessToken);\n\n        if (\n          response.data?.consumerIdentity?.firstName !== undefined ||\n          response.data?.consumerIdentity?.lastName !== undefined\n        ) {\n          this.customer?.setName(\n            `${response.data.consumerIdentity.firstName} ${response.data.consumerIdentity.lastName}`,\n          );\n        }\n\n        handleRefreshToken(\n          response.data.accessToken,\n          this._sendRefreshTokenEvent,\n        );\n      }\n\n      return response.data;\n    }\n\n    throw response;\n  }\n\n  private _sendRefreshTokenEvent = async (): Promise<void> => {\n    const accessToken = getAccessToken();\n    if (isNull(accessToken)) {\n      return;\n    }\n\n    const refreshTokenResponse = await sendChatEvent(\n      createRefreshTokenPayload(accessToken.token),\n      this.websocketClient,\n    );\n\n    if (isTokenRefreshedSuccessResponse(refreshTokenResponse)) {\n      setAccessToken(refreshTokenResponse.data.accessToken);\n\n      handleRefreshToken(\n        refreshTokenResponse.data.accessToken,\n        this._sendRefreshTokenEvent,\n      );\n\n      return;\n    }\n\n    throw refreshTokenResponse;\n  };\n\n  /**\n   * Register handler to chat event\n   *\n   * @param type type of chat event\n   * @param handler event handler\n   * @returns function to unregister handler\n   */\n  public onChatEvent(\n    type: ChatEventType,\n    handler: (event: CustomEvent<ChatEventData>) => void,\n  ): RemoveListenerFunction {\n    this._messageEmitter.addEventListener(type, handler);\n\n    return () => {\n      this._messageEmitter.removeEventListener(type, handler);\n    };\n  }\n\n  /**\n   * Get Customer instance\n   */\n  public getCustomer(): Customer | null {\n    return this.customer;\n  }\n\n  /**\n   * Get Thread instance by id\n   * @param id\n   * @returns instance of thread based on channel settings\n   */\n  public getThread(id: ThreadIdOnExternalPlatform): Thread | LivechatThread {\n    if (isNull(this.websocketClient)) {\n      throw new ChatSDKError(\n        'Cannot get thread because websocket is disconnected',\n      );\n    }\n\n    if (this.isLivechat) {\n      return new LivechatThread(\n        id,\n        this.websocketClient,\n        this._messageEmitter,\n        this.isAuthorizationEnabled,\n      );\n    }\n\n    return new Thread(\n      id,\n      this.websocketClient,\n      this._messageEmitter,\n      this.isAuthorizationEnabled,\n    );\n  }\n\n  /**\n   * Get list of available threads\n   * @async\n   * @returns list of threads\n   */\n  public async getTheadList(): Promise<Array<IThread> | null> {\n    if (isNull(this.websocketClient)) {\n      throw new ChatSDKError(\n        'Cannot get thread list because websocket is disconnected',\n      );\n    }\n\n    const eventPayload = {\n      eventType: AwsInputEventType.FETCH_THREAD_LIST,\n      data: {},\n    };\n\n    const result = await sendChatEvent(eventPayload, this.websocketClient);\n\n    if (!isThreadListFetchedPostbackData(result.data)) {\n      throw new ChatSDKError(\n        'Invalid response from fetch thread list (getTheadList)',\n      );\n    }\n\n    return result.data.threads;\n  }\n\n  /**\n   * Setup Environment endpoints\n   */\n  private _initEnvironment(options: ChatSDKOptions): void {\n    // Set custom environment\n    if (options.environment === EnvironmentName.custom) {\n      if (isEmpty(options.customEnvironment)) {\n        throw new Error(\n          'customEnvironment must be provided when environment is set to \"custom\"',\n        );\n      }\n      SDKVariableStorage.set(\n        ChatSDKVariable.ENDPOINT_GATEWAY,\n        options.customEnvironment?.gateway,\n      );\n      SDKVariableStorage.set(\n        ChatSDKVariable.ENDPOINT_CHAT,\n        options.customEnvironment?.chat,\n      );\n\n      return;\n    }\n\n    // Set predefined environment\n    const { gateway, chat } = getEnvironmentEndpoints(options.environment);\n    SDKVariableStorage.set(ChatSDKVariable.ENDPOINT_GATEWAY, gateway);\n    SDKVariableStorage.set(ChatSDKVariable.ENDPOINT_CHAT, chat);\n  }\n\n  private _initWS(\n    brandId: BrandId,\n    channelId: ChannelId,\n    customerId: CustomerIdentityIdOnExternalPlatform,\n  ): void {\n    const endpoint = SDKVariableStorage.get(ChatSDKVariable.ENDPOINT_GATEWAY);\n    assertNonNullable(endpoint);\n\n    const url = new URL(endpoint);\n    const host = url.hostname;\n    const port = url.port;\n\n    const wsClientOptions: WebSocketClientOptions = {\n      host,\n      port,\n    };\n    this.websocketClient = new WebSocketClient(\n      brandId,\n      channelId,\n      customerId,\n      wsClientOptions,\n    );\n\n    this.websocketClient.on(\n      WebSocketClientEvent.MESSAGE,\n      (event: CustomEvent) => {\n        try {\n          const parsedEvent = this._incomingChatEventMiddleware.process(\n            parseWsMessageEvent(event),\n          );\n\n          if (!isNil(parsedEvent)) {\n            const { type } = parsedEvent;\n\n            onMessageHandler(parsedEvent);\n\n            this._messageEmitter.dispatchEvent(\n              new CustomEvent<ChatEventData>(type ?? '', {\n                detail: parsedEvent,\n              }),\n            );\n          }\n        } catch (error: unknown) {\n          this.onErrorHandler(error);\n        }\n      },\n    );\n  }\n}\n","import { ChatEvent, ChatEventData } from '../event/ChatEvent';\nimport { isNil } from '../utils/is';\n\ninterface UserData {\n  user: unknown;\n}\n\nfunction hasUserData(data: unknown): boolean {\n  return !isNil((data as UserData)?.user);\n}\n\nexport function agentTypingStarted(event: ChatEventData): ChatEventData {\n  if (hasUserData(event.data)) {\n    return {\n      ...event,\n      type: ChatEvent.AGENT_TYPING_STARTED,\n    };\n  }\n\n  return event;\n}\n\nexport function agentTypingEnded(event: ChatEventData): ChatEventData {\n  if (hasUserData(event.data)) {\n    return {\n      ...event,\n      type: ChatEvent.AGENT_TYPING_ENDED,\n    };\n  }\n\n  return event;\n}\n","import { ChatEvent, ChatEventData } from '../event/ChatEvent';\n\nexport function assignedAgentChanged(event: ChatEventData): ChatEventData {\n  return {\n    ...event,\n    type: ChatEvent.ASSIGNED_AGENT_CHANGED,\n  };\n}\n","import { ChatSDKError } from '../error/ChatSDKError';\n\nimport { createLocalFileReader } from './localFileReader';\n\nexport interface AttachmentPayload {\n  mimeType: string;\n  name: string;\n  url: string;\n}\n\nexport const createPayloadForAttachmentUpload = async (\n  file: File,\n): Promise<AttachmentPayload> => {\n  const reader = await createLocalFileReader(file);\n\n  if (reader.error !== null) {\n    throw new ChatSDKError(\n      `Cannot create payload for attachment upload because of error (${reader.error.message})`,\n    );\n  }\n\n  if (typeof reader.result !== 'string') {\n    throw new ChatSDKError(\n      `Cannot create payload for attachment upload because of missing:\n      reader result (${reader.result})`,\n    );\n  }\n\n  return {\n    url: reader.result,\n    name: file.name,\n    mimeType: file.type,\n  };\n};\n","export function createLocalFileReader(file: File): Promise<FileReader> {\n  return new Promise((resolve, reject): void => {\n    const reader = new FileReader();\n    reader.onloadend = (): void => {\n      resolve(reader);\n    };\n    reader.onerror = (errorEvent: ProgressEvent<FileReader>): void =>\n      reject(errorEvent.target?.error?.message);\n    reader.readAsDataURL(file);\n  });\n}\n","import { SendMessageEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/SendMessage';\nimport { Attachment } from '@brandembassy/ts-types-chat/dist/message/Attachment';\nimport { BrandId } from '@brandembassy/ts-types-platform/dist/brand/BrandId';\nimport { ChannelId } from '@brandembassy/ts-types-platform/dist/channel/ChannelId';\nimport { MessageType } from '@brandembassy/ts-types-platform/dist/message/MessageType';\nimport { ThreadIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/thread/ThreadIdOnExternalPlatform';\n\nimport { getBrowserFingerprint } from '../browserFingerprint/getBrowserFingerprint';\nimport { convertCustomFields } from '../customField/convertCustomField';\nimport { ChatSDKError } from '../error/ChatSDKError';\nimport { SendMessageOptions } from '../thread/SendMessageOptions';\nimport { generateId } from '../utils/generateId';\nimport { getBrandIdAndChannelId } from '../utils/getBrandIdAndChannelId';\n\nimport { createPayloadForAttachmentUpload } from './createPayloadForAttachmentUpload';\nimport {\n  isUploadFailResponse,\n  isUploadSuccessResponse,\n  uploadAttachment,\n} from './uploadAttachment';\n\nexport const createAttachmentPayload = async (\n  file: File,\n  brandId: BrandId,\n  channelId: ChannelId,\n): Promise<Attachment> => {\n  const attachment = await createPayloadForAttachmentUpload(file);\n  const uploadAttachmentResponse = await uploadAttachment(\n    brandId,\n    channelId,\n    attachment,\n  );\n\n  if (isUploadSuccessResponse(uploadAttachmentResponse)) {\n    return {\n      url: uploadAttachmentResponse.fileUrl,\n      friendlyName: attachment.name,\n    };\n  }\n\n  if (isUploadFailResponse(uploadAttachmentResponse)) {\n    throw uploadAttachmentResponse;\n  }\n\n  throw new ChatSDKError(\n    `Unknown file upload response (${uploadAttachmentResponse})`,\n  );\n};\n\nexport const createAttachmentUploadMessageData = async (\n  files: FileList,\n  threadIdOnExternalPlatform: ThreadIdOnExternalPlatform,\n  options: SendMessageOptions = {},\n): Promise<SendMessageEventData> => {\n  const { brandId, channelId } = getBrandIdAndChannelId();\n\n  try {\n    const attachments = await Promise.all<Attachment>(\n      Array.from(files).map(async (file) =>\n        createAttachmentPayload(file, brandId, channelId),\n      ),\n    );\n\n    const {\n      messageId = generateId(),\n      browserFingerprint = getBrowserFingerprint(),\n      threadCustomFields = {},\n    } = options;\n\n    return {\n      messageContent: {\n        type: MessageType.TEXT,\n        payload: {\n          text: '',\n        },\n      },\n      attachments,\n      browserFingerprint,\n      thread: {\n        idOnExternalPlatform: threadIdOnExternalPlatform,\n      },\n      idOnExternalPlatform: messageId,\n      consumer: {\n        customFields: [],\n      },\n      consumerContact: {\n        customFields: convertCustomFields(threadCustomFields),\n      },\n    };\n  } catch (error: unknown) {\n    if (isUploadFailResponse(error)) {\n      throw error;\n    }\n    if (error instanceof Error) {\n      throw new ChatSDKError(\n        `Send attachment failed because of (${error.message})`,\n      );\n    }\n\n    throw new ChatSDKError(`Unknown error during file upload`);\n  }\n};\n","import { BrandId } from '@brandembassy/ts-types-platform/dist/brand/BrandId';\n\nimport { ChatSDKVariable } from '../env/ChatSDKVariable';\nimport { SDKVariableStorage } from '../env/getEnvVariable';\nimport { ChatSDKError } from '../error/ChatSDKError';\nimport { isUndefined } from '../utils/is';\n\nimport { AttachmentPayload } from './createPayloadForAttachmentUpload';\n\nexport interface UploadSuccessResponse {\n  fileUrl: string;\n}\n\nexport interface UploadFailResponse {\n  allowedFileSize: string;\n  allowedFileTypes: Array<{\n    description: string;\n    mimeType: string;\n  }>;\n}\n\nexport function isUploadSuccessResponse(\n  data: unknown,\n): data is UploadSuccessResponse {\n  return isUndefined((data as UploadSuccessResponse)?.fileUrl) === false;\n}\n\nexport function isUploadFailResponse(\n  data: unknown,\n): data is UploadFailResponse {\n  return isUndefined((data as UploadFailResponse)?.allowedFileSize) === false;\n}\n\nexport async function uploadAttachment(\n  brandId: BrandId,\n  channelId: string,\n  attachment: AttachmentPayload,\n): Promise<UploadSuccessResponse | UploadFailResponse> {\n  const CHANNEL_INTEGRATION_URL = SDKVariableStorage.get(\n    ChatSDKVariable.ENDPOINT_CHAT,\n  );\n  const { url, name: fileName, mimeType } = attachment;\n  const content = url.split(';base64,')[1];\n  const requestBody = { content, fileName, mimeType };\n  const response = await fetch(\n    `${CHANNEL_INTEGRATION_URL}/chat/1.0/brand/${brandId}/channel/${channelId}/attachment`,\n    {\n      method: 'POST',\n      body: JSON.stringify(requestBody),\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    },\n  );\n\n  if (!response.ok) {\n    throw new ChatSDKError(\n      `Failed to upload Attachments. Status (${response.status})`,\n    );\n  }\n\n  return response.json();\n}\n","import { AccessToken } from '@brandembassy/ts-types-chat/dist/authorization/AccessToken';\n\nimport { ChatSDKVariable } from '../env/ChatSDKVariable';\nimport { SDKVariableStorage } from '../env/getEnvVariable';\nimport { isNull } from '../utils/is';\n\nexport function setAccessToken(accessToken: AccessToken): void {\n  SDKVariableStorage.set(ChatSDKVariable.ACCESS_TOKEN, accessToken.token);\n  SDKVariableStorage.set(\n    ChatSDKVariable.ACCESS_TOKEN_EXPIRES_IN,\n    String(accessToken.expiresIn),\n  );\n}\n\nexport function getAccessToken(): AccessToken | null {\n  const token = SDKVariableStorage.get(ChatSDKVariable.ACCESS_TOKEN, null);\n  const expiresIn = SDKVariableStorage.get(\n    ChatSDKVariable.ACCESS_TOKEN_EXPIRES_IN,\n    null,\n  );\n\n  if (isNull(token) || isNull(expiresIn)) {\n    return null;\n  }\n\n  return {\n    token,\n    expiresIn: Number(expiresIn),\n  };\n}\n","import { AuthorizeConsumerData } from '@brandembassy/ts-types-chat/dist/awsEvents/AuthorizeConsumer';\nimport { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { VisitorId } from '@brandembassy/ts-types-platform/dist/visitor/VisitorId';\n\nimport { EventPayloadData } from '../sockets/EventPayload';\nimport { generateId } from '../utils/generateId';\nimport { createVisitorPayload } from '../visitor/createVisitorPayload';\n\ntype AuthorizeCustomerData = AuthorizeConsumerData;\n\nexport function createAuthorizationPayloadData(\n  authorizationCode: string | null,\n  visitorId: VisitorId = generateId(),\n): EventPayloadData<AuthorizeCustomerData> {\n  return {\n    eventType: AwsInputEventType.AUTHORIZE_CONSUMER,\n    data: {\n      authorization: {\n        authorizationCode,\n      },\n    },\n    ...createVisitorPayload(visitorId as VisitorId),\n  };\n}\n","import { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { RefreshTokenData } from '@brandembassy/ts-types-chat/dist/awsEvents/RefreshToken';\n\nimport { EventPayloadData } from '../sockets/EventPayload';\n\nexport function createRefreshTokenPayload(\n  token: string,\n): EventPayloadData<RefreshTokenData> {\n  return {\n    eventType: AwsInputEventType.REFRESH_TOKEN,\n    data: {\n      accessToken: {\n        token,\n      },\n    },\n  };\n}\n","import { AccessToken } from '@brandembassy/ts-types-chat/dist/authorization/AccessToken';\n\nlet refreshTokenTimeoutId: NodeJS.Timeout | null = null;\n\nexport function getIdealTimeInSecondsForIssueRefreshToken(\n  accessTokenExpiresIn: number,\n): number {\n  const idealTimeToRefreshAccessToken = Math.round(accessTokenExpiresIn * 0.9);\n\n  if (idealTimeToRefreshAccessToken < 20) {\n    return 20;\n  }\n\n  return idealTimeToRefreshAccessToken;\n}\n\nexport function handleRefreshToken(\n  accessToken: AccessToken,\n  refreshTokenAction: () => Promise<void>,\n): void {\n  if (refreshTokenTimeoutId !== null) {\n    clearTimeout(refreshTokenTimeoutId);\n  }\n\n  refreshTokenTimeoutId = setTimeout(\n    refreshTokenAction,\n    getIdealTimeInSecondsForIssueRefreshToken(accessToken.expiresIn) * 1000,\n  );\n}\n","import { AwsResponseEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\n\nimport { ChatEventData } from '../event/ChatEvent';\n\nimport { AuthorizeConsumerEventSuccessResponse } from './AuthorizeConsumerEventResponse';\n\nexport const isAuthSuccessEvent = (\n  payload: ChatEventData,\n): payload is AuthorizeConsumerEventSuccessResponse => {\n  const { data: { status } = {}, type } =\n    payload as AuthorizeConsumerEventSuccessResponse;\n\n  return (\n    type === AwsResponseEventType.CONSUMER_AUTHORIZED && status === 'success'\n  );\n};\n","import { AwsResponseEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { TokenRefreshedPostbackData } from '@brandembassy/ts-types-chat/dist/awsEvents/TokenRefreshed';\n\nexport interface TokenRefreshedSuccessResponse {\n  data: TokenRefreshedPostbackData;\n  type: AwsResponseEventType.TOKEN_REFRESHED;\n}\n\nexport function isTokenRefreshedSuccessResponse(\n  response: unknown,\n): response is TokenRefreshedSuccessResponse {\n  return (\n    (response as TokenRefreshedSuccessResponse)?.type ===\n      AwsResponseEventType.TOKEN_REFRESHED &&\n    (response as TokenRefreshedSuccessResponse).data?.accessToken?.token !==\n      undefined\n  );\n}\n","import UAParser from 'ua-parser-js';\n\nimport {\n  ApplicationType,\n  BrowserFingerprint,\n  DeviceType,\n} from '@brandembassy/ts-types-chat/dist/user/BrowserFingerprint';\n\nexport interface BrowserFingerprintOptions {\n  country?: string | null;\n  ip?: string | null;\n  language?: string;\n  location?: string | null;\n}\n\nexport const getBrowserLanguage = (): string => navigator.language;\nexport const getBrowserLocation = (): string =>\n  Intl.DateTimeFormat().resolvedOptions().timeZone;\n\n/**\n * Get Device type\n * @param {string} [deviceType]\n */\nexport function getDeviceType(deviceType?: string): DeviceType {\n  switch (deviceType) {\n    case 'mobile':\n      return DeviceType.MOBILE;\n    case 'tablet':\n      return DeviceType.TABLET;\n    default:\n      return DeviceType.DESKTOP;\n  }\n}\n\n/**\n * Get Customer Browser fingerprint\n * @param {BrowserFingerprintOptions} [options]\n */\nexport const getBrowserFingerprint = (\n  options: BrowserFingerprintOptions = {},\n): BrowserFingerprint => {\n  const deviceInfoFromUserAgent = new UAParser(navigator.userAgent);\n\n  const {\n    country = '',\n    location = getBrowserLocation(),\n    language = getBrowserLanguage(),\n    ip = null,\n  } = options;\n\n  return {\n    browser: deviceInfoFromUserAgent.getBrowser().name ?? null,\n    browserVersion: deviceInfoFromUserAgent.getBrowser().version ?? null,\n    country,\n    ip,\n    language,\n    location,\n    os: deviceInfoFromUserAgent.getOS().name ?? null,\n    osVersion: deviceInfoFromUserAgent.getOS().version ?? null,\n    deviceType: getDeviceType(deviceInfoFromUserAgent.getDevice().type),\n    applicationType: ApplicationType.BROWSER,\n  };\n};\n","export { isContactStatusChangedEvent } from './isContactStatusChanged';\nexport { isContactCreatedEvent } from './isContactCreatedEvent';\n","import { CaseCreatedData } from '@brandembassy/ts-types-platform/dist/post/case/CaseCreatedEvent';\nimport { PushUpdateEventType } from '@brandembassy/ts-types-platform/dist/pushUpdate/PushUpdateEventType';\n\nimport { ChatEventData } from '../event/ChatEvent';\n\ninterface ContactCreatedChatEvent extends ChatEventData {\n  data: CaseCreatedData;\n  type: PushUpdateEventType.CASE_CREATED;\n}\n\nexport function isContactCreatedEvent(\n  event: ChatEventData,\n): event is ContactCreatedChatEvent {\n  return (\n    event.type === PushUpdateEventType.CASE_CREATED &&\n    (event as ContactCreatedChatEvent).data?.case?.id !== undefined\n  );\n}\n","import { CaseStatusChangedData } from '@brandembassy/ts-types-platform/dist/post/case/CaseStatusChangedEvent';\nimport { PushUpdateEventType } from '@brandembassy/ts-types-platform/dist/pushUpdate/PushUpdateEventType';\n\nimport { ChatEventData } from '../event/ChatEvent';\n\ninterface ContactStatusChangedEvent extends ChatEventData {\n  data: CaseStatusChangedData;\n  type: PushUpdateEventType.CASE_STATUS_CHANGED;\n}\n\nexport function isContactStatusChangedEvent(\n  event: ChatEventData,\n): event is ContactStatusChangedEvent {\n  return (\n    event.type === PushUpdateEventType.CASE_STATUS_CHANGED &&\n    (event as ContactStatusChangedEvent).data?.case?.status !== undefined\n  );\n}\n","import { CaseStatusChangedData } from '@brandembassy/ts-types-platform/dist/post/case/CaseStatusChangedEvent';\nimport { PushUpdateEventType } from '@brandembassy/ts-types-platform/dist/pushUpdate/PushUpdateEventType';\n\nimport { ChatEventData } from '../event/ChatEvent';\n\ninterface ContactStatusChangedChatEvent extends ChatEventData {\n  data: CaseStatusChangedData;\n  type: PushUpdateEventType.CASE_CREATED;\n}\n\nexport function isContactStatusChangedEvent(\n  event: ChatEventData,\n): event is ContactStatusChangedChatEvent {\n  return (\n    event.type === PushUpdateEventType.CASE_STATUS_CHANGED &&\n    (event as ContactStatusChangedChatEvent).data?.case?.id !== undefined\n  );\n}\n","import { CustomField } from '@brandembassy/ts-types-chat/dist/customField/CustomField';\n\nimport { CustomFields } from './CustomFields';\n\nexport const convertCustomFields = (\n  customFields: CustomFields,\n): Array<CustomField> =>\n  Object.entries(customFields).map(([ident, value]) => ({\n    ident,\n    value,\n  }));\n","import { CustomField } from '@brandembassy/ts-types-chat/dist/customField/CustomField';\n\nimport { uniqBy } from '../utils/uniq';\n\nimport { convertCustomFields } from './convertCustomField';\nimport { CustomFields } from './CustomFields';\n\nexport const mergeCustomFields = (\n  customFieldsQueue: CustomFields,\n  dataCustomFields: Array<CustomField>,\n): Array<CustomField> => {\n  const convertedQueue = convertCustomFields(customFieldsQueue);\n\n  return uniqBy([...dataCustomFields, ...convertedQueue], 'ident');\n};\n","import { CustomerIdentityIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/endUser/EndUserIdentityId';\n\nimport { CustomFields } from '../customField/CustomFields';\nimport { ChatSDKVariable } from '../env/ChatSDKVariable';\nimport { SDKVariableStorage } from '../env/getEnvVariable';\nimport { ChatSDKError } from '../error/ChatSDKError';\nimport { ChatEventData } from '../event/ChatEvent';\nimport { sendChatEvent } from '../event/sendChatEvent';\nimport { WebSocketClient } from '../sockets/WebSocketClient';\nimport { generateId } from '../utils/generateId';\nimport { isUndefined } from '../utils/is';\n\nimport { createSetCustomerCustomFieldsPayloadData } from './setCustomerCustomFieldsPayload';\n\nexport class Customer {\n  websocketClient: WebSocketClient | null;\n\n  constructor(\n    id: CustomerIdentityIdOnExternalPlatform,\n    name: string | undefined,\n    websocketClient: WebSocketClient | null,\n  ) {\n    this.websocketClient = websocketClient;\n    Customer.setId(id);\n    Customer.setName(name);\n  }\n\n  static setId(id: CustomerIdentityIdOnExternalPlatform): void {\n    SDKVariableStorage.set(ChatSDKVariable.CUSTOMER_ID, id);\n  }\n\n  static getId(): CustomerIdentityIdOnExternalPlatform | null {\n    return SDKVariableStorage.get(ChatSDKVariable.CUSTOMER_ID, null);\n  }\n\n  static getName(): string | undefined {\n    return SDKVariableStorage.get(ChatSDKVariable.CUSTOMER_NAME);\n  }\n\n  static setName(name?: string): void {\n    SDKVariableStorage.set(ChatSDKVariable.CUSTOMER_NAME, name);\n  }\n\n  static getIdOrCreateNewOne(): CustomerIdentityIdOnExternalPlatform {\n    let customerId = this.getId();\n\n    if (!customerId) {\n      customerId = generateId();\n      this.setId(customerId);\n    }\n\n    return customerId;\n  }\n\n  public getId(): CustomerIdentityIdOnExternalPlatform {\n    return Customer.getIdOrCreateNewOne();\n  }\n\n  public getName(): string | undefined {\n    return Customer.getName();\n  }\n\n  public setName(name?: string): void {\n    Customer.setName(name);\n  }\n\n  /**\n   * Set Customer Custom fields\n   * @param customFields custom fields object\n   * @example { indentName: 'value' }\n   */\n  public async setCustomFields(\n    customFields: CustomFields,\n  ): Promise<ChatEventData> {\n    if (isUndefined(customFields)) {\n      throw new ChatSDKError('Custom fields must be set');\n    }\n\n    const payloadData = createSetCustomerCustomFieldsPayloadData(customFields);\n\n    return sendChatEvent(payloadData, this.websocketClient);\n  }\n\n  /**\n   * Set Customer Custom field\n   * @param name Custom field name\n   * @param value Custom field value\n   */\n  public async setCustomField(\n    name: string,\n    value: string,\n  ): Promise<ChatEventData> {\n    if (isUndefined(name) || isUndefined(value)) {\n      throw new ChatSDKError('Custom field name and value must be set');\n    }\n\n    return this.setCustomFields({ [name]: value });\n  }\n}\n","import { ConsumerIdentityInput } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsInputEvent';\n\nimport { splitName } from '../utils/splitName';\n\nimport { Customer } from './customer';\n\nexport type ConsumerIdentityPayload = ConsumerIdentityInput;\n\nexport function createCustomerIdentityPayload(\n  name?: string,\n): ConsumerIdentityPayload {\n  const storedName = name ?? Customer.getName();\n\n  let customerIdentityNamePayload = {};\n  if (typeof storedName === 'string' && storedName.length > 0) {\n    const [firstName, lastName] = splitName(storedName);\n    customerIdentityNamePayload = { firstName, lastName };\n  }\n\n  return {\n    idOnExternalPlatform: Customer.getIdOrCreateNewOne(),\n    ...customerIdentityNamePayload,\n  };\n}\n","import { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { SendConsumerCustomFieldsEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/SendConsumerCustomFields';\n\nimport { convertCustomFields } from '../customField/convertCustomField';\nimport { CustomFields } from '../customField/CustomFields';\nimport { EventPayloadData } from '../sockets/EventPayload';\n\ntype SendCustomerCustomFieldsEventData = SendConsumerCustomFieldsEventData;\n\nexport function createSetCustomerCustomFieldsPayloadData(\n  customFields: CustomFields,\n): EventPayloadData<SendCustomerCustomFieldsEventData> {\n  return {\n    eventType: AwsInputEventType.SEND_CONSUMER_CUSTOM_FIELDS,\n    data: {\n      customFields: convertCustomFields(customFields),\n    },\n  };\n}\n","export enum ChatSDKVariable {\n  ACCESS_TOKEN = 'ACCESS_TOKEN',\n  ACCESS_TOKEN_EXPIRES_IN = 'ACCESS_TOKEN_EXPIRES_IN',\n  AUTHORIZATION_CODE = 'AUTHORIZATION_CODE',\n  BRAND_ID = 'BRAND_ID',\n  CHANNEL_ID = 'CHANNEL_ID',\n  CHAT_SDK_WEBSOCKET_PREFIX = 'CHAT_SDK_WEBSOCKET_PREFIX',\n  CUSTOMER_ID = 'CUSTOMER_ID',\n  CUSTOMER_NAME = 'CUSTOMER_NAME',\n  ENDPOINT_CHAT = 'ENDPOINT_CHAT',\n  ENDPOINT_GATEWAY = 'ENDPOINT_GATEWAY',\n  THREAD_DATA = 'THREAD_DATA',\n}\n","export enum EnvironmentName {\n  AU1 = 'AU1',\n  CA1 = 'CA1',\n  EU1 = 'EU1',\n  JP1 = 'JP1',\n  NA1 = 'NA1',\n  UK1 = 'UK1',\n  custom = 'custom',\n}\n\nexport interface EnvironmentEndpoints {\n  chat: string;\n  gateway: string;\n  name: string;\n}\n\nexport function getEnvironmentEndpoints(\n  environment: EnvironmentName,\n): EnvironmentEndpoints {\n  const placeholder = '{ENV}';\n  const chatUrlTemplate = `https://channels-de-${placeholder}.niceincontact.com/chat`;\n  const gatewayUrlTemplate = `wss://chat-gateway-de-${placeholder}.niceincontact.com`;\n\n  switch (environment) {\n    case EnvironmentName.AU1:\n      return {\n        chat: chatUrlTemplate.replace(placeholder, 'au1'),\n        name: 'Australia',\n        gateway: gatewayUrlTemplate.replace(placeholder, 'au1'),\n      };\n    case EnvironmentName.CA1:\n      return {\n        chat: chatUrlTemplate.replace(placeholder, 'ca1'),\n        name: 'Canada',\n        gateway: gatewayUrlTemplate.replace(placeholder, 'ca1'),\n      };\n    case EnvironmentName.EU1:\n      return {\n        chat: chatUrlTemplate.replace(placeholder, 'eu1'),\n        name: 'Europe',\n        gateway: gatewayUrlTemplate.replace(placeholder, 'eu1'),\n      };\n    case EnvironmentName.JP1:\n      return {\n        chat: chatUrlTemplate.replace(placeholder, 'jp1'),\n        name: 'Japan',\n        gateway: gatewayUrlTemplate.replace(placeholder, 'jp1'),\n      };\n    case EnvironmentName.NA1:\n      return {\n        chat: chatUrlTemplate.replace(placeholder, 'na1'),\n        name: 'North America',\n        gateway: gatewayUrlTemplate.replace(placeholder, 'na1'),\n      };\n    case EnvironmentName.UK1:\n      return {\n        chat: chatUrlTemplate.replace(placeholder, 'uk1'),\n        name: 'United Kingdom',\n        gateway: gatewayUrlTemplate.replace(placeholder, 'uk1'),\n      };\n    case EnvironmentName.custom:\n      return {\n        chat: '',\n        name: 'Custom',\n        gateway: '',\n      };\n    default:\n      throw new Error(`Unknown environment: ${environment}`);\n  }\n}\n","import { ChatSDKVariable } from './ChatSDKVariable';\n\nclass VariablesStorage {\n  private _vars: Partial<Record<ChatSDKVariable, string | undefined>> = {};\n\n  set(variableName: ChatSDKVariable, value: string | undefined): void {\n    this._vars[variableName] = value;\n  }\n\n  get<D = undefined>(\n    variableName: ChatSDKVariable,\n    defaultValue?: D,\n  ): string | D {\n    return this._vars[variableName] ?? (defaultValue as D);\n  }\n\n  list() {\n    return Object.keys(this._vars);\n  }\n\n  clear() {\n    this._vars = {};\n  }\n}\n\nexport const SDKVariableStorage = new VariablesStorage();\n","export const CHAT_SDK_VERSION: string = process.env.PACKAGE_VERSION ?? '0';\n","export class ChatSDKError extends Error {\n  name: string = 'ChatSDKError';\n\n  constructor(error: unknown) {\n    const message =\n      error instanceof Error ? error.message : `Unknown error (${error})`;\n\n    super(`[ChatSDKError]: ${message}`);\n  }\n}\n","import { AwsResponseEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { PushUpdateEventType } from '@brandembassy/ts-types-platform/dist/pushUpdate/PushUpdateEventType';\n\nimport { MessageFailedEventData } from '../message/MessageSuccessEventData';\n\nexport const ChatEvent = {\n  ...PushUpdateEventType,\n  ...AwsResponseEventType,\n  AGENT_TYPING_STARTED: 'AgentTypingStarted',\n  AGENT_TYPING_ENDED: 'AgentTypingEnded',\n  ASSIGNED_AGENT_CHANGED: 'AssignedAgentChanged',\n} as const;\n\nexport interface ChatEventData {\n  data: unknown;\n  error?: MessageFailedEventData['error'];\n  id: string;\n  type?: ChatEventType;\n}\n\nexport type ChatEventKey = keyof typeof ChatEvent;\nexport type ChatEventType = typeof ChatEvent[ChatEventKey];\n","import { ChatEventData } from './ChatEvent';\n\nexport type EventMiddleware = (\n  eventData: ChatEventData,\n) => ChatEventData | null;\n\nexport class ChatEventMiddleware {\n  middlewares: Array<EventMiddleware> = [];\n\n  register(middleware: EventMiddleware): void {\n    this.middlewares.push(middleware);\n  }\n\n  process(event?: ChatEventData): ChatEventData | null {\n    if (event === undefined) {\n      return null;\n    }\n\n    let processedEvent: ChatEventData | null = event;\n\n    for (const middleware of this.middlewares) {\n      if (processedEvent === null) {\n        return null;\n      }\n      processedEvent = middleware(processedEvent);\n    }\n\n    return processedEvent;\n  }\n}\n","import { ChatEventData, ChatEventType } from './ChatEvent';\n\nexport interface IChatEventTarget extends EventTarget {\n  addEventListener<K extends ChatEventType>(\n    type: K,\n    listener: (event: CustomEvent<ChatEventData>) => void,\n    options?: boolean | AddEventListenerOptions,\n  ): void;\n  addEventListener(\n    type: string,\n    callback: EventListenerOrEventListenerObject | null,\n    options?: EventListenerOptions | boolean,\n  ): void;\n\n  dispatchEvent(event: CustomEvent<ChatEventData>): boolean;\n\n  removeEventListener(\n    type: string,\n    callback: EventListenerOrEventListenerObject | null,\n    options?: boolean | EventListenerOptions | undefined,\n  ): void;\n  removeEventListener<K extends ChatEventType>(\n    type: K,\n    callback: (event: CustomEvent<ChatEventData>) => void,\n    options?: boolean | EventListenerOptions | undefined,\n  ): void;\n}\n\nexport const ChatEventTarget = EventTarget as {\n  new (): IChatEventTarget;\n  prototype: IChatEventTarget;\n};\n","import { agentTypingEnded, agentTypingStarted } from '../../agent/agentTyping';\nimport { assignedAgentChanged } from '../../agent/assignedAgentChanged';\nimport { ChatEvent, ChatEventData } from '../ChatEvent';\nimport { EventMiddleware } from '../ChatEventMiddleware';\n\nconst eventTypeMap: Record<string, EventMiddleware> = {\n  [ChatEvent.SENDER_TYPING_STARTED]: agentTypingStarted,\n  [ChatEvent.SENDER_TYPING_ENDED]: agentTypingEnded,\n  [ChatEvent.CASE_INBOX_ASSIGNEE_CHANGED]: assignedAgentChanged,\n};\n\nexport function chatEventMapper(event: ChatEventData): ChatEventData | null {\n  if (event.type && eventTypeMap[event.type] !== undefined) {\n    return eventTypeMap[event.type](event);\n  }\n\n  return event;\n}\n","import { MessageFailedEventData } from '../message/MessageSuccessEventData';\nimport { isEmpty } from '../utils/is';\n\nimport { ChatEventData, ChatEventType } from './ChatEvent';\n\ninterface EventDataWithPostback {\n  postback: {\n    data: Record<string, unknown>;\n    eventType: ChatEventType;\n  };\n}\n\ninterface EventWithEventId {\n  eventId: string;\n}\n\ninterface EventWithData {\n  data: Record<string, unknown>;\n}\ninterface EventWithType {\n  eventType: ChatEventType;\n}\n\nconst EMPTY_EVENT = {\n  id: '',\n  data: null,\n  type: undefined,\n};\n\nconst hasData = (event: unknown): event is EventWithData =>\n  'data' in (event as EventWithData);\n\nconst hasError = (event: unknown): event is MessageFailedEventData =>\n  'error' in (event as MessageFailedEventData);\n\nconst hasEventId = (event: unknown): event is EventWithEventId =>\n  'eventId' in (event as EventWithEventId);\n\nconst hasEventType = (event: unknown): event is EventWithType =>\n  'eventType' in (event as EventWithType);\n\nconst isDataWithPostback = (\n  eventDetailData: unknown,\n): eventDetailData is EventDataWithPostback => {\n  const postback = (eventDetailData as EventDataWithPostback)?.postback;\n\n  return isEmpty(postback) === false;\n};\n\nexport function normalizeEvent(event: unknown): ChatEventData {\n  if (!hasEventId(event)) {\n    return EMPTY_EVENT;\n  }\n\n  if (hasError(event)) {\n    return {\n      error: event.error,\n      id: event.eventId,\n      data: null,\n    };\n  }\n\n  const eventType = hasEventType(event) ? event.eventType : undefined;\n\n  if (hasData(event)) {\n    return {\n      id: event.eventId,\n      data: event.data,\n      type: eventType,\n    };\n  }\n\n  if (isDataWithPostback(event)) {\n    const {\n      postback: { data: postbackData, eventType: postbackEventType },\n      eventId: rawEventId,\n      ...restEventData\n    } = event;\n\n    const convertedEvent = {\n      type: postbackEventType,\n      data: {\n        ...restEventData,\n        ...postbackData,\n      },\n      id: rawEventId,\n    };\n\n    return convertedEvent;\n  }\n\n  const { eventId, ...eventRest } = event;\n\n  return {\n    data: undefined,\n    ...eventRest,\n    id: eventId,\n    type: eventType,\n  };\n}\n","import { makeRequest } from '../request/makeRequest';\nimport {\n  createEvent,\n  createEventPayload,\n  EventPayloadData,\n} from '../sockets/EventPayload';\nimport { WebSocketClient } from '../sockets/WebSocketClient';\n\nimport { ChatEventData } from './ChatEvent';\n\n/**\n * Send chat event\n * @param {EventPayloadData} payloadData\n * @param {WebSocketClient} webSocketClient\n */\nexport async function sendChatEvent<D>(\n  payloadData: EventPayloadData<D>,\n  webSocketClient: WebSocketClient | null,\n): Promise<ChatEventData> {\n  const event = createEvent(createEventPayload(payloadData));\n\n  return makeRequest(event, webSocketClient);\n}\n","import { ChatSdk } from './ChatSdk';\n\n// Export runtime classes and types\nexport type { SendMessageEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/SendMessage';\nexport type { ConsumerIdentityInput as CustomerIdentity } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsInputEvent';\nexport type { CaseInboxAssigneeChangedEvent as AssignedAgentChangedEvent } from '@brandembassy/ts-types-platform/dist/post/case/CaseInboxAssigneeChangedEvent';\nexport type { CaseInboxAssigneeChangedData as AssignedAgentChangedData } from '@brandembassy/ts-types-platform/dist/post/case/CaseInboxAssigneeChangedEvent';\nexport { MessageType } from '@brandembassy/ts-types-platform/dist/message/MessageType';\nexport { WebSocketClientEvent } from './sockets/WebSocketClient';\nexport { ChatEvent } from './event/ChatEvent';\nexport type { ChatEventType } from './event/ChatEvent';\nexport { EnvironmentName } from './env/Environments';\nexport * from './thread';\nexport * from './contact';\nexport * from './ChatSdk';\nexport * from './message/Message';\nexport * from './utils/narrowing';\nexport { generateId } from './utils/generateId';\nexport { splitName } from './utils/splitName';\nexport type { ChatSDKOptions } from './ChatSDKOptions';\n\n// Export types for API Docs availability\nexport type { BrandId } from '@brandembassy/ts-types-platform/dist/brand/BrandId';\nexport type { ChannelId } from '@brandembassy/ts-types-platform/dist/channel/ChannelId';\nexport { IThread } from '@brandembassy/ts-types-chat/dist/post/thread/IThread';\nexport type { CustomerIdentityIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/endUser/EndUserIdentityId';\nexport type { WebSocketClient } from './sockets/WebSocketClient';\nexport type {\n  EventListenerFunction,\n  RemoveListenerFunction,\n} from './event/ListenerFunction';\nexport type { IChatEventTarget } from './event/ChatEventTarget';\nexport type { ChatEventData } from './event/ChatEvent';\nexport type { MoreMessagesLoadedEvent } from './message/loadMoreMessagesEventData';\nexport type { LoadThreadMetadataChatEvent } from './thread/isLoadMetadataSuccessPayload';\nexport type { ThreadRecoveredPostbackData } from '@brandembassy/ts-types-chat/dist/awsEvents/ThreadRecovered';\nexport type { MessageSuccessEventData } from './message/MessageSuccessEventData';\nexport type { ConsumerAuthorizationSuccessPayloadData } from '@brandembassy/ts-types-chat/dist/authorization/ConsumerAuthorizationSuccessPayloadData';\nexport type { UploadFailResponse } from './attachment/uploadAttachment';\n\n// Export the ChatSDK as default\nexport default ChatSdk;\n","export type { Message } from '@brandembassy/ts-types-platform/dist/message/Message';\nexport type { MessageDirection } from '@brandembassy/ts-types-platform/dist/message/MessageDirection';\nexport { getAuthor } from './getAuthor';\nexport { isMessage } from './isMessage';\nexport { isMessageCreatedEvent } from './isMessageCreatedEvent';\n","import { ChatEventData } from '../event/ChatEvent';\nimport { isUndefined } from '../utils/is';\n\nexport interface MessageSuccessEventData extends ChatEventData {\n  id: string;\n}\nexport interface MessageFailedEventData extends MessageSuccessEventData {\n  error: {\n    errorCode: string;\n    errorMessage: string;\n    transactionId: string;\n  };\n  id: string;\n}\n\nexport function isSendMessageSuccessEventData(\n  event: ChatEventData,\n): event is MessageSuccessEventData {\n  const hasEventId =\n    isUndefined((event as MessageSuccessEventData)?.id) === false;\n\n  const hasError =\n    isUndefined((event as MessageFailedEventData).error) === false;\n\n  return hasError === false && hasEventId;\n}\n","import { SendMessageEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/SendMessage';\nimport { CustomField } from '@brandembassy/ts-types-chat/dist/customField/CustomField';\nimport { BrowserFingerprint } from '@brandembassy/ts-types-chat/dist/user/BrowserFingerprint';\nimport { MessageId } from '@brandembassy/ts-types-platform/dist/message/MessageId';\nimport { MessageType } from '@brandembassy/ts-types-platform/dist/message/MessageType';\nimport { ThreadIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/thread/ThreadIdOnExternalPlatform';\n\nimport { getBrowserFingerprint } from '../browserFingerprint/getBrowserFingerprint';\n\nexport const createTextMessageData = (\n  messageText: string,\n  messageId: MessageId,\n  threadIdOnExternalPlatform: ThreadIdOnExternalPlatform,\n  threadCustomFields: Array<CustomField> = [],\n  customerCustomFields: Array<CustomField> = [],\n  browserFingerprint: BrowserFingerprint = getBrowserFingerprint(),\n): SendMessageEventData => ({\n  messageContent: {\n    payload: {\n      text: messageText,\n    },\n    type: MessageType.TEXT,\n  },\n  browserFingerprint,\n  idOnExternalPlatform: messageId,\n  thread: {\n    idOnExternalPlatform: threadIdOnExternalPlatform,\n  },\n  consumer: {\n    customFields: customerCustomFields,\n  },\n  consumerContact: {\n    customFields: threadCustomFields,\n  },\n  attachments: [],\n});\n","import { MessageDirection } from '@brandembassy/ts-types-platform/dist/message/MessageDirection';\n\nimport { Message } from './Message';\n\n/**\n * Get message author name of given message\n * @param message\n * @returns message author name\n */\nexport const getAuthor = (message: Message): string =>\n  message.direction === MessageDirection.INBOUND\n    ? message.authorEndUserIdentity?.fullName ?? ''\n    : `${message.authorUser?.firstName ?? ''} ${\n        message.authorUser?.surname ?? ''\n      }`.trim();\n","import { Message } from '@brandembassy/ts-types-platform/dist/message/Message';\n\nimport { isUndefined } from '../utils/is';\n\nexport function isMessage(item: unknown): item is Message {\n  const hasId = isUndefined((item as Message).id) === false;\n  const hasDirection = isUndefined((item as Message).direction) === false;\n  const hasMessageContent =\n    isUndefined((item as Message).messageContent) === false;\n\n  return hasId && hasDirection && hasMessageContent;\n}\n","import { MessageCreatedData } from '@brandembassy/ts-types-platform/dist/message/MessageCreatedEvent';\nimport { PushUpdateEventType } from '@brandembassy/ts-types-platform/dist/pushUpdate/PushUpdateEventType';\n\nimport { ChatEventData } from '../event/ChatEvent';\n\nexport interface MessageCreatedEvent extends ChatEventData {\n  data: MessageCreatedData;\n  type: PushUpdateEventType.MESSAGE_CREATED;\n}\n\nexport function isMessageCreatedEvent(\n  event: unknown,\n): event is MessageCreatedEvent {\n  return (\n    (event as MessageCreatedEvent).type === PushUpdateEventType.MESSAGE_CREATED\n  );\n}\n","import { AwsResponseEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { MoreMessagesLoadedPostbackData } from '@brandembassy/ts-types-chat/dist/awsEvents/MoreMessagesLoaded';\n\nimport { ChatEventData } from '../event/ChatEvent';\n\nexport interface MoreMessagesLoadedEvent extends ChatEventData {\n  data: MoreMessagesLoadedPostbackData;\n}\n\nexport function isLoadMoreMessagesEventData(\n  event: ChatEventData,\n): event is MoreMessagesLoadedEvent {\n  return (\n    (event as MoreMessagesLoadedEvent).type ===\n      AwsResponseEventType.MORE_MESSAGES_LOADED &&\n    (event as MoreMessagesLoadedEvent)?.data?.messages !== undefined\n  );\n}\n","import { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { LoadMoreMessagesEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/LoadMoreMessages';\n\nimport { EventPayloadData } from '../sockets/EventPayload';\n\nexport const createLoadMoreMessagesPayloadData = (\n  eventData: LoadMoreMessagesEventData,\n): EventPayloadData<LoadMoreMessagesEventData> => ({\n  eventType: AwsInputEventType.LOAD_MORE_MESSAGES,\n  data: eventData,\n});\n","import { SendMessageEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/SendMessage';\n\nimport { sendChatEvent } from '../event/sendChatEvent';\nimport { WebSocketClient } from '../sockets/WebSocketClient';\n\nimport {\n  isSendMessageSuccessEventData,\n  MessageSuccessEventData,\n} from './MessageSuccessEventData';\nimport { createSendMessagePayloadData } from './sendMessagePayload';\n\nexport const sendMessage = async (\n  messageData: SendMessageEventData,\n  websocketClient: WebSocketClient | null,\n): Promise<MessageSuccessEventData> => {\n  const sendMessagePayloadData = createSendMessagePayloadData(messageData);\n\n  const response = await sendChatEvent(sendMessagePayloadData, websocketClient);\n\n  if (isSendMessageSuccessEventData(response)) {\n    return response;\n  }\n\n  throw response;\n};\n","import { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { SendMessageEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/SendMessage';\n\nimport { EventPayloadData } from '../sockets/EventPayload';\n\nexport const createSendMessagePayloadData = (\n  eventData: SendMessageEventData,\n): EventPayloadData<SendMessageEventData> => ({\n  eventType: AwsInputEventType.SEND_MESSAGE,\n  data: eventData,\n});\n","import { AwsInputEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsInputEvent';\n\nimport { ChatSDKError } from '../error/ChatSDKError';\nimport { ChatEventData } from '../event/ChatEvent';\nimport { Event } from '../sockets/EventPayload';\nimport { WebSocketClient } from '../sockets/WebSocketClient';\nimport { generateId } from '../utils/generateId';\nimport { isEmpty, isNull } from '../utils/is';\n\nimport { requestQueue } from './requestQueue';\n\nexport const makeRequest = async (\n  event: Event<AwsInputEventData>,\n  wsClient: WebSocketClient | null,\n): Promise<ChatEventData> => {\n  if (isNull(wsClient)) {\n    throw new ChatSDKError('WebSocketClient is not initialized');\n  }\n  if (isEmpty(event.eventId)) {\n    event.eventId = generateId();\n  }\n\n  return new Promise<ChatEventData>((resolve) => {\n    requestQueue.set(event.eventId, resolve);\n    wsClient?.send(event);\n  });\n};\n","import { ChatEventData } from '../event/ChatEvent';\nimport { normalizeEvent } from '../event/normalizeEvent';\n\nimport { requestQueue } from './requestQueue';\n\nexport const parseWsMessageEvent = (\n  event: CustomEvent,\n): ChatEventData | undefined => {\n  const eventDetail = event?.detail;\n\n  if (!eventDetail) {\n    return;\n  }\n\n  let eventData;\n\n  try {\n    eventData = JSON.parse(eventDetail.data);\n  } catch (error) {\n    return;\n  }\n\n  return normalizeEvent(eventData);\n};\n\nexport const onMessageHandler = (event: ChatEventData): void => {\n  const { id } = event;\n\n  if (requestQueue.has(id)) {\n    const resolve = requestQueue.get(id);\n    if (typeof resolve === 'function') {\n      resolve(event);\n    }\n    requestQueue.delete(id);\n  }\n};\n","import { ChatEventData } from '../event/ChatEvent';\n\nexport const requestQueue = new Map<string, (value: ChatEventData) => void>();\n","import { AwsChatWindowEventActionRoute } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsChatWindowEvent';\nimport { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport {\n  AwsInputEvent,\n  AwsInputEventData,\n  ConsumerIdentityInput,\n  DestinationInput,\n  VisitorInput,\n} from '@brandembassy/ts-types-chat/dist/awsEvents/AwsInputEvent';\n\nimport { createCustomerIdentityPayload } from '../customer/customerIdentityPayload';\nimport { ChatSDKError } from '../error/ChatSDKError';\nimport { generateId } from '../utils/generateId';\nimport { getBrandIdAndChannelId } from '../utils/getBrandIdAndChannelId';\nimport { isUndefined } from '../utils/is';\n\nexport type EventActionRoute = AwsChatWindowEventActionRoute;\nexport type EventPayload<D extends AwsInputEventData> = AwsInputEvent<\n  AwsInputEventType,\n  D\n>;\n\nexport interface Event<D extends AwsInputEventData> {\n  action: EventActionRoute;\n  eventId: string;\n  payload: EventPayload<D>;\n}\n\nexport interface EventPayloadData<D extends AwsInputEventData> {\n  consumerIdentity?: ConsumerIdentityInput;\n  data: D;\n  destination?: DestinationInput;\n  eventType: AwsInputEventType;\n  visitor?: VisitorInput;\n}\n\nexport function createEventPayload<D extends AwsInputEventData>(\n  eventPayloadData: EventPayloadData<D>,\n): EventPayload<D> {\n  const {\n    eventType,\n    data,\n    consumerIdentity = createCustomerIdentityPayload(),\n    destination = {},\n    visitor = {},\n  } = eventPayloadData;\n  const { brandId, channelId } = getBrandIdAndChannelId();\n\n  if (isUndefined(eventType)) {\n    throw new ChatSDKError(\n      `Cannot create an event payload because of missing eventType (${eventType})`,\n    );\n  }\n\n  return {\n    eventType,\n    brand: {\n      id: Number(brandId),\n    },\n    channel: {\n      id: channelId,\n    },\n    consumerIdentity,\n    data,\n    destination,\n    visitor,\n  };\n}\n\nexport function createEvent<D extends AwsInputEventData>(\n  payload: EventPayload<D>,\n  eventId: string = generateId(),\n  actionRoute: EventActionRoute = AwsChatWindowEventActionRoute.CHAT_WINDOW_EVENT,\n): Event<D> {\n  return {\n    action: actionRoute,\n    eventId,\n    payload,\n  };\n}\n","import { createQueryParametersAsString } from '@brandembassy/be-javascript-utils/dist/query/queryParameters';\nimport {\n  WebSocketClient as PushUpdateWSClient,\n  WebSocketClientEvent as PushUpdatesWebSocketClientEvent,\n} from '@brandembassy/push-updates-sdk';\nimport { setupSocketConnection } from '@brandembassy/push-updates-sdk/dist/pushUpdate/pushUpdateWebSocket';\nimport { CloseEvent } from '@brandembassy/reconnecting-websocket';\nimport { BrandId } from '@brandembassy/ts-types-platform/dist/brand/BrandId';\nimport { ChannelId } from '@brandembassy/ts-types-platform/dist/channel/ChannelId';\nimport { CustomerIdentityIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/endUser/EndUserIdentityId';\n\nimport { ChatSDKVariable } from '../env/ChatSDKVariable';\nimport { SDKVariableStorage } from '../env/getEnvVariable';\nimport { CHAT_SDK_VERSION } from '../env/version';\n\nimport { WebSocketClientError } from './WebSocketClientError';\nexport const WebSocketClientEvent = PushUpdatesWebSocketClientEvent;\n\nfunction createSocketUrl(\n  host: string,\n  brandId: BrandId,\n  channelId: ChannelId,\n  consumerIdOnExternalPlatform: CustomerIdentityIdOnExternalPlatform,\n): string {\n  const queryParameters = {\n    brandId,\n    channelId,\n    consumerId: consumerIdOnExternalPlatform,\n    v: CHAT_SDK_VERSION,\n  };\n\n  const queryParametersAsString =\n    createQueryParametersAsString(queryParameters);\n\n  const prefix = SDKVariableStorage.get(\n    ChatSDKVariable.CHAT_SDK_WEBSOCKET_PREFIX,\n    '',\n  );\n\n  return `${host}/${prefix}?${queryParametersAsString}`;\n}\n\nexport interface WebSocketClientOptions {\n  /**\n   * host for websocket connection\n   */\n  host?: string;\n  /**\n   * common error handler\n   */\n  onError?: (error: WebSocketClientError) => void;\n  /**\n   * port for websocket connection\n   */\n  port?: string;\n}\n\n/**\n * Websocket client\n */\nexport class WebSocketClient {\n  private _connection: PushUpdateWSClient | null = null;\n\n  constructor(\n    private brandId: BrandId,\n    private channelId: ChannelId,\n    private customerId: CustomerIdentityIdOnExternalPlatform,\n    private options?: WebSocketClientOptions,\n  ) {\n    this.connect();\n  }\n\n  /**\n   * Connect websocket\n   */\n  connect(): void {\n    const port = this.options?.port ? `:${this.options?.port}` : '';\n    const host = this.options?.host ? `${this.options?.host}${port}` : '';\n\n    const socketUrl = createSocketUrl(\n      host,\n      this.brandId,\n      this.channelId,\n      this.customerId,\n    );\n\n    this._connection = setupSocketConnection(socketUrl, {\n      startClosed: true,\n      forceSecureProtocol: true,\n    });\n\n    this._connection?.addEventListener(\n      WebSocketClientEvent.CLOSE,\n      this._errorHandler,\n    );\n    this._connection?.socket?.reconnect();\n  }\n\n  /**\n   * Disconnect websocket\n   */\n  disconnect(): void {\n    this._connection?.socket.close();\n  }\n\n  /**\n   * Reconnect websocket\n   */\n  reconnect(): void {\n    this._connection?.socket.reconnect();\n  }\n\n  /**\n   * Send data to active connection\n   * @param data\n   */\n  send(data: unknown): void {\n    const stringData = JSON.stringify(data);\n    this._connection?.send(stringData);\n  }\n\n  /**\n   * Register event handler to websocket event\n   * @param eventType websocket event\n   * @param handlerCallback event handler\n   */\n  on(\n    eventType: PushUpdatesWebSocketClientEvent,\n    handlerCallback: (event: CustomEvent) => void,\n  ): void {\n    this._connection?.addEventListener(eventType, handlerCallback);\n  }\n\n  /**\n   * Unregister event handler to websocket event\n   * @param eventType websocket event\n   * @param handlerCallback event handler\n   */\n  off(\n    eventType: PushUpdatesWebSocketClientEvent,\n    handlerCallback: (event: CustomEvent) => void,\n  ): void {\n    this._connection?.removeEventListener(eventType, handlerCallback);\n  }\n\n  _errorHandler(type: string, closeEvent: CloseEvent | undefined): void {\n    throw new WebSocketClientError(type, closeEvent?.reason);\n  }\n}\n","export class WebSocketClientError extends Error {\n  name: string = 'WebSocketClientError';\n\n  constructor(message: string, reason: string = '') {\n    const reasonMessage = reason ? ` (${reason})` : '';\n    super(`[WebSocketClientError]: ${message}${reasonMessage}`);\n  }\n}\n","import { SendMessageEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/SendMessage';\nimport { ThreadRecoveredPostbackData } from '@brandembassy/ts-types-chat/dist/awsEvents/ThreadRecovered';\nimport { ThreadIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/thread/ThreadIdOnExternalPlatform';\n\nimport { createAttachmentUploadMessageData } from '../attachment/sendAttachments';\nimport { UploadFailResponse } from '../attachment/uploadAttachment';\nimport { getAccessToken } from '../authorization/accessTokenStorage';\nimport { getBrowserFingerprint } from '../browserFingerprint/getBrowserFingerprint';\nimport { convertCustomFields } from '../customField/convertCustomField';\nimport { CustomFields } from '../customField/CustomFields';\nimport { mergeCustomFields } from '../customField/mergeCustomFields';\nimport { ChatSDKVariable } from '../env/ChatSDKVariable';\nimport { SDKVariableStorage } from '../env/getEnvVariable';\nimport { ChatSDKError } from '../error/ChatSDKError';\nimport { ChatEvent, ChatEventData, ChatEventType } from '../event/ChatEvent';\nimport { IChatEventTarget } from '../event/ChatEventTarget';\nimport {\n  EventListenerFunction,\n  RemoveListenerFunction,\n} from '../event/ListenerFunction';\nimport { sendChatEvent } from '../event/sendChatEvent';\nimport { createTextMessageData } from '../message/createTextMessageData';\nimport {\n  isLoadMoreMessagesEventData,\n  MoreMessagesLoadedEvent,\n} from '../message/loadMoreMessagesEventData';\nimport { createLoadMoreMessagesPayloadData } from '../message/loadMoreMessagesPayload';\nimport { MessageSuccessEventData } from '../message/MessageSuccessEventData';\nimport { sendMessage } from '../message/sendMessage';\nimport { WebSocketClient } from '../sockets/WebSocketClient';\nimport { generateId } from '../utils/generateId';\nimport { isEmpty, isUndefined } from '../utils/is';\n\nimport { createArchiveThreadEventPayloadData } from './archiveThread';\nimport {\n  isLoadMetadataSuccessPayload,\n  LoadThreadMetadataChatEvent,\n} from './isLoadMetadataSuccessPayload';\nimport { isRecoverSuccessPayload } from './isRecoverSuccessPayload';\nimport { isThreadArchivedSuccessPayload } from './isThreadArchivedSuccessPayload';\nimport { createLastMessageSeenPayloadData } from './lastMessageSeenPayload';\nimport { createLoadThreadMetadataEventPayloadData } from './metadata';\nimport { createRecoverThreadPayloadData } from './recoverThreadPayload';\nimport { SendMessageOptions } from './SendMessageOptions';\nimport { createSetThreadCustomFieldsPayloadData } from './setThreadCustomFieldsPayload';\nimport { filterCurrentThreadEventHandler } from './threadEventHandler';\nimport {\n  createStartTypingEventPayloadData,\n  createStopTypingEventPayloadData,\n} from './typingEvents';\nimport {\n  createUpdateThreadPayloadData,\n  isUpdateThreadSuccess,\n} from './updateThread';\n\nexport class Thread {\n  public idOnExternalPlatform: ThreadIdOnExternalPlatform;\n\n  protected _websocketClient: WebSocketClient;\n  protected _exists: boolean = false;\n  protected _messageEmitter: IChatEventTarget;\n  protected _typingTimeoutID: ReturnType<typeof setTimeout> | undefined =\n    undefined;\n  protected _threadCustomFieldsQueue: CustomFields = {};\n  protected _isAuthorizationEnabled: boolean = false;\n\n  constructor(\n    idOnExternalPlatform: ThreadIdOnExternalPlatform,\n    websocketClient: WebSocketClient,\n    messageEmitter: IChatEventTarget,\n    isAuthorizationEnabled: boolean = false,\n  ) {\n    this.idOnExternalPlatform = idOnExternalPlatform;\n    this._websocketClient = websocketClient;\n    this._messageEmitter = messageEmitter;\n    this._isAuthorizationEnabled = isAuthorizationEnabled;\n\n    this._registerEventHandlers();\n  }\n\n  /**\n   *  Recover existing chat\n   */\n  public async recover(): Promise<ThreadRecoveredPostbackData> {\n    const response = await sendChatEvent(\n      createRecoverThreadPayloadData(this.idOnExternalPlatform),\n      this._websocketClient,\n    );\n\n    if (isRecoverSuccessPayload(response)) {\n      return response.data;\n    }\n\n    throw response;\n  }\n\n  /**\n   * Send message\n   * @param messageData\n   */\n  public async sendMessage(\n    messageData: SendMessageEventData,\n  ): Promise<MessageSuccessEventData> {\n    const threadCustomFields = mergeCustomFields(\n      this._threadCustomFieldsQueue,\n      messageData.consumerContact.customFields ?? [],\n    );\n    const storedAccessToken =\n      (this._isAuthorizationEnabled && getAccessToken()) ?? false;\n    const accessToken =\n      storedAccessToken !== false\n        ? { accessToken: { token: storedAccessToken.token } }\n        : {};\n\n    const messageDataWithCustomFields: SendMessageEventData = {\n      ...messageData,\n      ...accessToken,\n      consumerContact: {\n        customFields: threadCustomFields,\n      },\n    };\n\n    const result = await sendMessage(\n      messageDataWithCustomFields,\n      this._websocketClient,\n    );\n    this._threadCustomFieldsQueue = {};\n\n    return result;\n  }\n\n  /**\n   * Send text message\n   * @param {string} messageText\n   * @param {SendMessageOptions} [options]\n   */\n  public async sendTextMessage(\n    messageText: string,\n    options: SendMessageOptions = {},\n  ): Promise<MessageSuccessEventData> {\n    const {\n      messageId = generateId(),\n      browserFingerprint = getBrowserFingerprint(),\n      threadCustomFields: optionsThreadCustomFields = {},\n    } = options;\n\n    const convertedOptionsThreadCustomFields = convertCustomFields(\n      optionsThreadCustomFields,\n    );\n    const messageData = createTextMessageData(\n      messageText,\n      messageId,\n      this.idOnExternalPlatform,\n      convertedOptionsThreadCustomFields,\n      [],\n      browserFingerprint,\n    );\n\n    return this.sendMessage(messageData);\n  }\n\n  /**\n   * Load previous messages\n   * @async\n   * @return previous messages\n   */\n  public async loadMoreMessages(): Promise<MoreMessagesLoadedEvent | null> {\n    const { scrollToken, oldestMessageDatetime } =\n      JSON.parse(SDKVariableStorage.get(ChatSDKVariable.THREAD_DATA, '{}')) ??\n      {};\n\n    if (isEmpty(scrollToken)) {\n      return null;\n    }\n\n    const loadMoreMessagesEventData = {\n      scrollToken,\n      oldestMessageDatetime,\n      thread: { idOnExternalPlatform: this.idOnExternalPlatform },\n    };\n\n    const response = await sendChatEvent(\n      createLoadMoreMessagesPayloadData(loadMoreMessagesEventData),\n      this._websocketClient,\n    );\n\n    if (isLoadMoreMessagesEventData(response)) {\n      return response;\n    }\n\n    throw response;\n  }\n\n  /**\n   * Mark all messages in the thread as seen\n   */\n  public async lastMessageSeen(): Promise<ChatEventData> {\n    const payloadData = createLastMessageSeenPayloadData(\n      this.idOnExternalPlatform,\n    );\n\n    return sendChatEvent(payloadData, this._websocketClient);\n  }\n\n  /**\n   * Send attachment\n   * @param {FileList} files - An object of this type is returned by the files' property of the HTML <input> element; this lets you access the list of files selected with the <input type=\"file\"> element.\n   * @param {SendMessageOptions} [options]\n   * @description Raw function to send attachments\n   * @return when upload failed UploadFailResponse contains allowed file size and file types\n   */\n  public async sendAttachments(\n    files: FileList,\n    options: SendMessageOptions = {},\n  ): Promise<MessageSuccessEventData | UploadFailResponse> {\n    if (isUndefined(files) || files.length === 0) {\n      throw new ChatSDKError(\n        'FileList must be provided to sendAttachment method',\n      );\n    }\n\n    const messageData = await createAttachmentUploadMessageData(\n      files,\n      this.idOnExternalPlatform,\n      options,\n    );\n\n    return this.sendMessage(messageData);\n  }\n\n  /**\n   * Send start and stop typing events. It sends stop typing event after the timeout. Repeated calls resets this timeout.\n   * @param timeout [timeout=1000] - The timeout in milliseconds.\n   */\n  public keystroke(timeout = 1000): void {\n    if (!this._typingTimeoutID) {\n      sendChatEvent(\n        createStartTypingEventPayloadData(this.idOnExternalPlatform),\n        this._websocketClient,\n      );\n    }\n\n    clearTimeout(this._typingTimeoutID);\n    this._typingTimeoutID = setTimeout(() => {\n      sendChatEvent(\n        createStopTypingEventPayloadData(this.idOnExternalPlatform),\n        this._websocketClient,\n      );\n    }, timeout);\n  }\n\n  /**\n   * Manually send the stop typing event and clear the keystroke timeout.\n   */\n  public stopTyping(): void {\n    clearTimeout(this._typingTimeoutID);\n    this._typingTimeoutID = undefined;\n    sendChatEvent(\n      createStopTypingEventPayloadData(this.idOnExternalPlatform),\n      this._websocketClient,\n    );\n  }\n\n  /**\n   * Get Thread Metadata\n   * @returns {LoadThreadMetadataChatEvent} response otherwise throw an error response\n   */\n  public async getMetadata(): Promise<LoadThreadMetadataChatEvent> {\n    const response = await sendChatEvent(\n      createLoadThreadMetadataEventPayloadData(this.idOnExternalPlatform),\n      this._websocketClient,\n    );\n\n    if (isLoadMetadataSuccessPayload(response)) {\n      return response;\n    }\n\n    throw response;\n  }\n\n  public onThreadEvent(\n    type: ChatEventType,\n    handler: EventListenerFunction,\n  ): RemoveListenerFunction {\n    const filteredEventHandler = filterCurrentThreadEventHandler(\n      this.idOnExternalPlatform,\n      handler,\n    );\n\n    this._messageEmitter.addEventListener(type, filteredEventHandler);\n\n    return () => {\n      this._messageEmitter.removeEventListener(type, filteredEventHandler);\n    };\n  }\n\n  /**\n   * Set thread custom fields\n   * @param customFields custom fields object\n   * @example { indentName: 'value' }\n   */\n  public async setCustomFields(customFields: CustomFields): Promise<void> {\n    this._threadCustomFieldsQueue = {\n      ...this._threadCustomFieldsQueue,\n      ...customFields,\n    };\n\n    if (this._exists === false) {\n      // let customFields be sent by the first message\n      return;\n    }\n\n    const customFieldsData = createSetThreadCustomFieldsPayloadData(\n      this._threadCustomFieldsQueue,\n      this.idOnExternalPlatform,\n    );\n\n    await sendChatEvent(customFieldsData, this._websocketClient);\n    this._threadCustomFieldsQueue = {};\n  }\n\n  /**\n   * Set thread custom field\n   * @param name custom field name\n   * @param value custom field value\n   */\n  public setCustomField(name: string, value: string): Promise<void> {\n    return this.setCustomFields({ [name]: value });\n  }\n\n  /**\n   * Set thread as archived\n   * @returns {true} if success otherwise throw error response\n   */\n  public async archive(): Promise<true> {\n    const response = await sendChatEvent(\n      createArchiveThreadEventPayloadData(this.idOnExternalPlatform),\n      this._websocketClient,\n    );\n\n    if (isThreadArchivedSuccessPayload(response)) {\n      return true;\n    }\n\n    throw response;\n  }\n\n  /**\n   * Set thread name\n   * @param name New name of the Thread\n   * @returns {true} if success otherwise throw an error response\n   */\n  public async setName(name: string): Promise<true> {\n    const updateThreadData = createUpdateThreadPayloadData(\n      this.idOnExternalPlatform,\n      name,\n    );\n\n    const response = await sendChatEvent(\n      updateThreadData,\n      this._websocketClient,\n    );\n\n    if (isUpdateThreadSuccess(response)) {\n      return true;\n    }\n\n    throw response;\n  }\n\n  private _registerEventHandlers() {\n    this.onThreadEvent(ChatEvent.CASE_CREATED, () => (this._exists = true));\n    this.onThreadEvent(ChatEvent.THREAD_RECOVERED, () => (this._exists = true));\n  }\n}\n","import { ArchiveThreadEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/ArchiveThread';\nimport { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { ThreadIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/thread/ThreadIdOnExternalPlatform';\n\nimport { EventPayloadData } from '../sockets/EventPayload';\n\nexport function createArchiveThreadEventPayloadData(\n  threadIdOnExternalPlatform: ThreadIdOnExternalPlatform,\n): EventPayloadData<ArchiveThreadEventData> {\n  return {\n    eventType: AwsInputEventType.ARCHIVE_THREAD,\n    data: {\n      thread: {\n        idOnExternalPlatform: threadIdOnExternalPlatform,\n      },\n    },\n  };\n}\n","export * from './Thread';\nexport * from './livechatThread/LivechatThread';\nexport type { ThreadIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/thread/ThreadIdOnExternalPlatform';\n","import { AwsResponseEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { ThreadMetadataLoadedPostbackData } from '@brandembassy/ts-types-chat/dist/awsEvents/ThreadMetadataLoaded';\n\nimport { ChatEventData } from '../event/ChatEvent';\n\nexport interface LoadThreadMetadataChatEvent extends ChatEventData {\n  data: ThreadMetadataLoadedPostbackData;\n  type: AwsResponseEventType.THREAD_METADATA_LOADED;\n}\n\nexport const isLoadMetadataSuccessPayload = (\n  response: ChatEventData,\n): response is LoadThreadMetadataChatEvent =>\n  (response as LoadThreadMetadataChatEvent).type ===\n    AwsResponseEventType.THREAD_METADATA_LOADED &&\n  (response as LoadThreadMetadataChatEvent).data.lastMessage !== undefined;\n","import { AwsResponseEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { ThreadRecoveredPostbackData } from '@brandembassy/ts-types-chat/dist/awsEvents/ThreadRecovered';\n\nimport { ChatEventData } from '../event/ChatEvent';\nimport { isUndefined } from '../utils/is';\n\ninterface ThreadRecoveredChatEvent extends ChatEventData {\n  data: ThreadRecoveredPostbackData;\n}\n\nexport const isRecoverSuccessPayload = (\n  response: ChatEventData,\n): response is ThreadRecoveredChatEvent => {\n  const testResponseData = response.data as ThreadRecoveredPostbackData;\n\n  const hasPostbackData = isUndefined(testResponseData) === false;\n  const hasMessages = isUndefined(testResponseData?.messages) === false;\n  const isCorrectEventType =\n    response.type === AwsResponseEventType.THREAD_RECOVERED ||\n    response.type === AwsResponseEventType.LIVECHAT_RECOVERED;\n  const hasNoError = isUndefined(response.error);\n\n  return hasPostbackData && hasMessages && hasNoError && isCorrectEventType;\n};\n","import { AwsResponseEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\n\nimport { ChatEventData } from '../event/ChatEvent';\n\nexport interface ThreadArchivedEvent extends ChatEventData {\n  type: AwsResponseEventType.THREAD_ARCHIVED;\n}\n\nexport function isThreadArchivedSuccessPayload(\n  response: ChatEventData,\n): response is ThreadArchivedEvent {\n  return (\n    (response as ThreadArchivedEvent).type ===\n    AwsResponseEventType.THREAD_ARCHIVED\n  );\n}\n","import { ThreadListFetchedPostbackData } from '@brandembassy/ts-types-chat/dist/awsEvents/ThreadListFetched';\n\nexport const isThreadListFetchedPostbackData = (\n  data: unknown,\n): data is ThreadListFetchedPostbackData =>\n  'threads' in (data as ThreadListFetchedPostbackData);\n","import { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { MessageSeenByConsumerEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/MessageSeenByConsumer';\n\nimport { EventPayloadData } from '../sockets/EventPayload';\n\nexport function createLastMessageSeenPayloadData(\n  threadIdOnExternalPlatform: string,\n): EventPayloadData<MessageSeenByConsumerEventData> {\n  return {\n    eventType: AwsInputEventType.MESSAGE_SEEN,\n    data: {\n      thread: { idOnExternalPlatform: threadIdOnExternalPlatform },\n    },\n  };\n}\n","import { SendMessageEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/SendMessage';\nimport { ThreadRecoveredPostbackData } from '@brandembassy/ts-types-chat/dist/awsEvents/ThreadRecovered';\nimport { CaseStatus } from '@brandembassy/ts-types-platform/dist/post/case/CaseStatus';\nimport { ThreadIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/thread/ThreadIdOnExternalPlatform';\n\nimport { isContactStatusChangedEvent } from '../../contact/isContactStatusChangedEvent';\nimport { ChatSDKVariable } from '../../env/ChatSDKVariable';\nimport { SDKVariableStorage } from '../../env/getEnvVariable';\nimport { ChatSDKError } from '../../error/ChatSDKError';\nimport { ChatEvent, ChatEventData } from '../../event/ChatEvent';\nimport { IChatEventTarget } from '../../event/ChatEventTarget';\nimport { sendChatEvent } from '../../event/sendChatEvent';\nimport { MessageSuccessEventData } from '../../message/MessageSuccessEventData';\nimport { WebSocketClient } from '../../sockets/WebSocketClient';\nimport { isUndefined } from '../../utils/is';\nimport { isRecoverSuccessPayload } from '../isRecoverSuccessPayload';\nimport { Thread } from '../Thread';\n\nimport { createEndThreadPayloadData } from './createEndThreadPayloadData';\nimport { createRecoverLivechatThreadPayloadData } from './recoverLivechatThreadPayload';\n\nexport class LivechatThread extends Thread {\n  protected _isInitialized: boolean = false;\n  protected _canSendMessage: boolean = true;\n  constructor(\n    idOnExternalPlatform: ThreadIdOnExternalPlatform,\n    websocketClient: WebSocketClient,\n    messageEmitter: IChatEventTarget,\n    isAuthorizationEnabled: boolean = false,\n  ) {\n    super(\n      idOnExternalPlatform,\n      websocketClient,\n      messageEmitter,\n      isAuthorizationEnabled,\n    );\n\n    this._registerLivechatEventHandlers();\n  }\n  /**\n   *  Recover existing live chat\n   */\n  public override async recover(): Promise<ThreadRecoveredPostbackData> {\n    const response = await sendChatEvent(\n      createRecoverLivechatThreadPayloadData(this.idOnExternalPlatform),\n      this._websocketClient,\n    );\n\n    if (isRecoverSuccessPayload(response)) {\n      return response.data;\n    }\n\n    throw response;\n  }\n\n  public override async sendMessage(\n    messageData: SendMessageEventData,\n  ): Promise<MessageSuccessEventData> {\n    if (this._canSendMessage === false) {\n      throw new ChatSDKError('Cannot send more messages to closed Contact');\n    }\n\n    return super.sendMessage(messageData);\n  }\n\n  /**\n   * Start livechat\n   * @param {string} [initialMessageText]\n   */\n  public async startChat(\n    initialMessageText = 'Begin conversation',\n  ): Promise<MessageSuccessEventData | void> {\n    if (this._isInitialized) {\n      throw new ChatSDKError('Chat is already initialized');\n    }\n\n    try {\n      const result = await this.sendTextMessage(initialMessageText);\n      this._isInitialized = true;\n\n      return result;\n    } catch (error: unknown) {\n      if (error instanceof Error) {\n        throw new ChatSDKError(\n          `Sending initial message failed because of (${error.message})`,\n        );\n      }\n\n      return;\n    }\n  }\n\n  public async endChat(): Promise<void> {\n    const threadDataRaw = SDKVariableStorage.get(\n      ChatSDKVariable.THREAD_DATA,\n      '{}',\n    );\n    const threadData = JSON.parse(threadDataRaw);\n    const contactId = threadData?.contactId;\n\n    if (isUndefined(contactId)) {\n      throw new ChatSDKError(\n        'Cannot end Chat because of missing ContactId in the storage',\n      );\n    }\n\n    await sendChatEvent(\n      createEndThreadPayloadData(this.idOnExternalPlatform, contactId),\n      this._websocketClient,\n    );\n\n    return;\n  }\n\n  private _registerLivechatEventHandlers() {\n    this.onThreadEvent(\n      ChatEvent.CASE_STATUS_CHANGED,\n      (event: CustomEvent<ChatEventData>) => {\n        if (\n          isContactStatusChangedEvent(event.detail) &&\n          event.detail.data.case.status === CaseStatus.CLOSED\n        ) {\n          this._canSendMessage = false;\n        }\n      },\n    );\n    this.onThreadEvent(\n      ChatEvent.THREAD_RECOVERED,\n      (event: CustomEvent<ChatEventData>) => {\n        if (\n          isRecoverSuccessPayload(event.detail) &&\n          event.detail.data.consumerContact.status === CaseStatus.CLOSED\n        ) {\n          this._canSendMessage = false;\n        }\n      },\n    );\n  }\n}\n","import { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { EndContactEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/EndContact';\nimport { CaseId } from '@brandembassy/ts-types-platform/dist/post/case/CaseId';\nimport { ThreadIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/thread/ThreadIdOnExternalPlatform';\n\nimport { EventPayloadData } from '../../sockets/EventPayload';\n\nexport function createEndThreadPayloadData(\n  threadIdOnExternalPlatform: ThreadIdOnExternalPlatform,\n  contactId: CaseId,\n): EventPayloadData<EndContactEventData> {\n  return {\n    eventType: AwsInputEventType.END_CONTACT,\n    data: {\n      thread: { idOnExternalPlatform: threadIdOnExternalPlatform },\n      contact: { id: contactId },\n    },\n  };\n}\n","import { AwsResponseEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { SetPositionInQueuePayload } from '@brandembassy/ts-types-chat/dist/awsEvents/SetPositionInQueuePayload';\n\nimport { isEmpty } from '../../utils/is';\n\nexport const isSetPositionInQueuePayload = (\n  detail: unknown,\n): detail is SetPositionInQueuePayload => {\n  const setPostionDetail = detail as SetPositionInQueuePayload;\n\n  return (\n    Number.isInteger(setPostionDetail?.data.positionInQueue) &&\n    isEmpty(setPostionDetail?.eventId) === false &&\n    setPostionDetail?.eventType === AwsResponseEventType.SET_POSITION_IN_QUEUE\n  );\n};\n","import { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { RecoverThreadEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/RecoverThread';\n\nimport { EventPayloadData } from '../../sockets/EventPayload';\n\nexport function createRecoverLivechatThreadPayloadData(\n  threadIdOnExternalPlatform: string,\n): EventPayloadData<RecoverThreadEventData> {\n  return {\n    eventType: AwsInputEventType.RECOVER_LIVECHAT,\n    data: {\n      thread: { idOnExternalPlatform: threadIdOnExternalPlatform },\n    },\n  };\n}\n","import { ArchiveThreadEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/ArchiveThread';\nimport { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { ThreadIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/thread/ThreadIdOnExternalPlatform';\n\nimport { EventPayloadData } from '../sockets/EventPayload';\n\nexport function createLoadThreadMetadataEventPayloadData(\n  threadIdOnExternalPlatform: ThreadIdOnExternalPlatform,\n): EventPayloadData<ArchiveThreadEventData> {\n  return {\n    eventType: AwsInputEventType.LOAD_THREAD_METADATA,\n    data: {\n      thread: {\n        idOnExternalPlatform: threadIdOnExternalPlatform,\n      },\n    },\n  };\n}\n","import { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { RecoverThreadEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/RecoverThread';\n\nimport { EventPayloadData } from '../sockets/EventPayload';\n\nexport function createRecoverThreadPayloadData(\n  threadIdOnExternalPlatform: string,\n): EventPayloadData<RecoverThreadEventData> {\n  return {\n    eventType: AwsInputEventType.RECOVER_THREAD,\n    data: {\n      thread: { idOnExternalPlatform: threadIdOnExternalPlatform },\n    },\n  };\n}\n","import { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { SetConsumerContactCustomFieldsEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/SetConsumerContactCustomFields';\nimport { ThreadIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/thread/ThreadIdOnExternalPlatform';\n\nimport { convertCustomFields } from '../customField/convertCustomField';\nimport { CustomFields } from '../customField/CustomFields';\nimport { EventPayloadData } from '../sockets/EventPayload';\n\nexport function createSetThreadCustomFieldsPayloadData(\n  customFields: CustomFields,\n  threadIdOnExternalPlatform: ThreadIdOnExternalPlatform,\n): EventPayloadData<SetConsumerContactCustomFieldsEventData> {\n  return {\n    eventType: AwsInputEventType.SET_CONSUMER_CONTACT_CUSTOM_FIELD,\n    data: {\n      customFields: convertCustomFields(customFields),\n      thread: {\n        idOnExternalPlatform: threadIdOnExternalPlatform,\n      },\n    },\n  };\n}\n","import { CaseId } from '@brandembassy/ts-types-platform/dist/post/case/CaseId';\n\nimport { ChatSDKVariable } from '../env/ChatSDKVariable';\nimport { SDKVariableStorage } from '../env/getEnvVariable';\n\nexport function storeContactId(contactId: CaseId): void {\n  const originalThreadDataRaw = SDKVariableStorage.get(\n    ChatSDKVariable.THREAD_DATA,\n    '{}',\n  );\n  const originalThreadData = JSON.parse(originalThreadDataRaw) || {};\n\n  SDKVariableStorage.set(\n    ChatSDKVariable.THREAD_DATA,\n    JSON.stringify({\n      ...originalThreadData,\n      contactId,\n    }),\n  );\n}\n","import { isContactCreatedEvent } from '../contact/isContactCreatedEvent';\nimport { ChatEventData } from '../event/ChatEvent';\n\nimport { isRecoverSuccessPayload } from './isRecoverSuccessPayload';\nimport { storeContactId } from './storeContactId';\n\nexport function storeContactIdMiddleware(\n  eventData: ChatEventData,\n): ChatEventData {\n  if (isContactCreatedEvent(eventData)) {\n    const contactId = eventData.data.case.id;\n\n    storeContactId(contactId);\n  }\n\n  if (isRecoverSuccessPayload(eventData)) {\n    const contactId = eventData.data.consumerContact.caseId;\n\n    storeContactId(contactId);\n  }\n\n  return eventData;\n}\n","import { ChatSDKVariable } from '../env/ChatSDKVariable';\nimport { SDKVariableStorage } from '../env/getEnvVariable';\nimport { Message } from '../message/Message';\nimport { isUndefined } from '../utils/is';\nimport { lastItemInArray } from '../utils/last';\n\nexport interface ScrollData {\n  messages: Array<Message>;\n  scrollToken: string;\n}\n\nexport function storeThreadScrollData(scrollData: ScrollData): void {\n  const oldestMessageDatetime = lastItemInArray(scrollData.messages)?.createdAt;\n\n  const oldThreadDataRaw = SDKVariableStorage.get(\n    ChatSDKVariable.THREAD_DATA,\n    '{}',\n  );\n  const oldThreadData = JSON.parse(oldThreadDataRaw) || {};\n\n  SDKVariableStorage.set(\n    ChatSDKVariable.THREAD_DATA,\n    JSON.stringify({\n      ...oldThreadData,\n      scrollToken: scrollData.scrollToken,\n      oldestMessageDatetime: isUndefined(oldestMessageDatetime)\n        ? ''\n        : oldestMessageDatetime,\n    }),\n  );\n}\n","import { ChatEventData } from '../event/ChatEvent';\nimport { isLoadMoreMessagesEventData } from '../message/loadMoreMessagesEventData';\n\nimport { isRecoverSuccessPayload } from './isRecoverSuccessPayload';\nimport { storeThreadScrollData } from './storeThreadScrollData';\n\nexport function storeThreadScrollDataMiddleware(\n  eventData: ChatEventData,\n): ChatEventData {\n  if (isRecoverSuccessPayload(eventData)) {\n    const { messages, messagesScrollToken } = eventData.data;\n\n    storeThreadScrollData({\n      messages,\n      scrollToken: messagesScrollToken,\n    });\n  }\n\n  if (isLoadMoreMessagesEventData(eventData)) {\n    const { scrollToken, messages } = eventData.data;\n\n    storeThreadScrollData({ scrollToken, messages });\n  }\n\n  return eventData;\n}\n","import { ThreadIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/thread/ThreadIdOnExternalPlatform';\n\nimport { ChatEventData } from '../event/ChatEvent';\nimport { EventListenerFunction } from '../event/ListenerFunction';\nimport { isEmpty } from '../utils/is';\n\ninterface DataWithThread {\n  thread: {\n    idOnExternalPlatform: ThreadIdOnExternalPlatform;\n  };\n}\n\nconst hasThreadId = (data: unknown): data is DataWithThread =>\n  isEmpty((data as DataWithThread)?.thread?.idOnExternalPlatform) === false;\n\nexport const filterCurrentThreadEventHandler =\n  (threadId: ThreadIdOnExternalPlatform, handler: EventListenerFunction) =>\n  (event: CustomEvent<ChatEventData>): void => {\n    const eventData = event.detail.data;\n\n    if (!hasThreadId(eventData)) {\n      return;\n    }\n\n    const eventThreadId = eventData.thread.idOnExternalPlatform;\n\n    if (eventThreadId === threadId) {\n      handler(event);\n    }\n  };\n","import { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { SenderTypingEndedEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/SenderTypingEnded';\nimport { SenderTypingStartedEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/SenderTypingStarted';\nimport { ThreadIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/thread/ThreadIdOnExternalPlatform';\n\nimport { EventPayloadData } from '../sockets/EventPayload';\n\nexport function createStartTypingEventPayloadData(\n  threadIdOnExternalPlatform: ThreadIdOnExternalPlatform,\n): EventPayloadData<SenderTypingStartedEventData> {\n  return {\n    eventType: AwsInputEventType.SENDER_TYPING_STARTED,\n    data: {\n      thread: {\n        idOnExternalPlatform: threadIdOnExternalPlatform,\n      },\n    },\n  };\n}\n\nexport function createStopTypingEventPayloadData(\n  threadIdOnExternalPlatform: ThreadIdOnExternalPlatform,\n): EventPayloadData<SenderTypingEndedEventData> {\n  return {\n    eventType: AwsInputEventType.SENDER_TYPING_ENDED,\n    data: {\n      thread: {\n        idOnExternalPlatform: threadIdOnExternalPlatform,\n      },\n    },\n  };\n}\n","import { AwsInputEventType } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsEventType';\nimport { UpdateThreadEventData } from '@brandembassy/ts-types-chat/dist/awsEvents/UpdateThread';\nimport { ThreadIdOnExternalPlatform } from '@brandembassy/ts-types-platform/dist/thread/ThreadIdOnExternalPlatform';\n\nimport { ChatEventData } from '../event/ChatEvent';\nimport { EventPayloadData } from '../sockets/EventPayload';\nimport { isUndefined } from '../utils/is';\n\nexport function createUpdateThreadPayloadData(\n  threadIdOnExternalPlatform: ThreadIdOnExternalPlatform,\n  threadName: string,\n): EventPayloadData<UpdateThreadEventData> {\n  return {\n    eventType: AwsInputEventType.UPDATE_THREAD,\n    data: {\n      thread: {\n        idOnExternalPlatform: threadIdOnExternalPlatform,\n        threadName,\n      },\n    },\n  };\n}\n\nexport function isUpdateThreadSuccess(response: ChatEventData): boolean {\n  return isUndefined(response.error);\n}\n","export function assertNonNullable<T>(\n  value: T,\n): asserts value is NonNullable<T> {\n  if (typeof value === 'undefined' || value === null) {\n    throw Error(`Expected non-nullish value, got ${value}`);\n  }\n}\n","// eslint-disable-next-line no-restricted-imports\nexport { v4 as generateId } from 'uuid';\n","import { BrandId } from '@brandembassy/ts-types-platform/dist/brand/BrandId';\nimport { ChannelId } from '@brandembassy/ts-types-platform/dist/channel/ChannelId';\n\nimport { ChatSDKVariable } from '../env/ChatSDKVariable';\nimport { SDKVariableStorage } from '../env/getEnvVariable';\n\nimport { isNil } from './is';\n\nexport function getBrandIdAndChannelId(): {\n  brandId: BrandId;\n  channelId: ChannelId;\n} {\n  const brandId = parseInt(SDKVariableStorage.get(ChatSDKVariable.BRAND_ID));\n  const channelId = SDKVariableStorage.get(ChatSDKVariable.CHANNEL_ID);\n\n  if (isNil(brandId) || isNaN(brandId) || isNil(channelId)) {\n    throw new Error(\n      `Cannot get BrandId and ChannelId from SDKVariableStorage \n      brandId (${brandId}) |\n      channelId (${channelId})`,\n    );\n  }\n\n  return {\n    brandId,\n    channelId,\n  };\n}\n","/* eslint-disable no-restricted-imports */\nexport { default as isEmpty } from 'lodash-es/isEmpty';\nexport { default as isNil } from 'lodash-es/isNil';\nexport { default as isNull } from 'lodash-es/isNull';\nexport { default as isUndefined } from 'lodash-es/isUndefined';\n","/* eslint-disable no-restricted-imports */\nexport { default as lastItemInArray } from 'lodash-es/last';\n","export { isAuthSuccessEvent } from '../authorization/isAuthSuccessEvent';\nexport { isLoadMoreMessagesEventData as isMoreMessagesLoadedEvent } from '../message/loadMoreMessagesEventData';\nexport { isLoadMetadataSuccessPayload } from '../thread/isLoadMetadataSuccessPayload';\nexport { isRecoverSuccessPayload as isRecoverSuccessEvent } from '../thread/isRecoverSuccessPayload';\nexport { isSetPositionInQueuePayload } from '../thread/livechatThread/isSetPositionInQueuePayload';\nexport { isThreadListFetchedPostbackData } from '../thread/isThreadListFetchedPostbackData';\nexport { isThreadArchivedSuccessPayload } from '../thread/isThreadArchivedSuccessPayload';\nexport { isTokenRefreshedSuccessResponse } from '../authorization/isTokenRefreshedSuccessResponse';\n","export function splitName(name: string): [string, string] {\n  const [firstName, ...names] = name.split(' ');\n  const lastName = names.join(' ');\n\n  return [firstName, lastName];\n}\n","/* eslint-disable no-restricted-imports */\nexport { default as uniqBy } from 'lodash-es/uniqBy';\n","import { VisitorInput } from '@brandembassy/ts-types-chat/dist/awsEvents/AwsInputEvent';\nimport { VisitorId } from '@brandembassy/ts-types-platform/dist/visitor/VisitorId';\n\nexport interface VisitorPayload {\n  visitor: VisitorInput;\n}\n\nexport function createVisitorPayload(visitorId: VisitorId): VisitorPayload {\n  return {\n    visitor: {\n      id: visitorId,\n    },\n  };\n}\n","module.exports = __WEBPACK_EXTERNAL_MODULE__2007__;","module.exports = __WEBPACK_EXTERNAL_MODULE__459__;","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nexport default Map;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nexport default Set;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","import overArg from './_overArg.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nexport default nativeKeys;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nexport default overArg;\n","import isPrototype from './_isPrototype.js';\nimport nativeKeys from './_nativeKeys.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default baseKeys;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import root from './_root.js';\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nexport default coreJsData;\n","import coreJsData from './_coreJsData.js';\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nexport default isMasked;\n","import isFunction from './isFunction.js';\nimport isMasked from './_isMasked.js';\nimport isObject from './isObject.js';\nimport toSource from './_toSource.js';\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nexport default baseIsNative;\n","import baseIsNative from './_baseIsNative.js';\nimport getValue from './_getValue.js';\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nexport default getNative;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nexport default getValue;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nexport default DataView;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nexport default Promise;\n","import getNative from './_getNative.js';\nimport root from './_root.js';\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nexport default WeakMap;\n","import DataView from './_DataView.js';\nimport Map from './_Map.js';\nimport Promise from './_Promise.js';\nimport Set from './_Set.js';\nimport WeakMap from './_WeakMap.js';\nimport baseGetTag from './_baseGetTag.js';\nimport toSource from './_toSource.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nexport default getTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nexport default isPrototype;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nexport default toSource;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nexport default baseIsArguments;\n","import baseIsArguments from './_baseIsArguments.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nexport default isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nexport default isArray;\n","import isFunction from './isFunction.js';\nimport isLength from './isLength.js';\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nexport default isArrayLike;\n","import root from './_root.js';\nimport stubFalse from './stubFalse.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nexport default isBuffer;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nexport default stubFalse;\n","import baseKeys from './_baseKeys.js';\nimport getTag from './_getTag.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isArrayLike from './isArrayLike.js';\nimport isBuffer from './isBuffer.js';\nimport isPrototype from './_isPrototype.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    setTag = '[object Set]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if `value` is an empty object, collection, map, or set.\n *\n * Objects are considered empty if they have no own enumerable string keyed\n * properties.\n *\n * Array-like values such as `arguments` objects, arrays, buffers, strings, or\n * jQuery-like collections are considered empty if they have a `length` of `0`.\n * Similarly, maps and sets are considered empty if they have a `size` of `0`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is empty, else `false`.\n * @example\n *\n * _.isEmpty(null);\n * // => true\n *\n * _.isEmpty(true);\n * // => true\n *\n * _.isEmpty(1);\n * // => true\n *\n * _.isEmpty([1, 2, 3]);\n * // => false\n *\n * _.isEmpty({ 'a': 1 });\n * // => false\n */\nfunction isEmpty(value) {\n  if (value == null) {\n    return true;\n  }\n  if (isArrayLike(value) &&\n      (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||\n        isBuffer(value) || isTypedArray(value) || isArguments(value))) {\n    return !value.length;\n  }\n  var tag = getTag(value);\n  if (tag == mapTag || tag == setTag) {\n    return !value.size;\n  }\n  if (isPrototype(value)) {\n    return !baseKeys(value).length;\n  }\n  for (var key in value) {\n    if (hasOwnProperty.call(value, key)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport default isEmpty;\n","import baseGetTag from './_baseGetTag.js';\nimport isObject from './isObject.js';\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nexport default isFunction;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nexport default isLength;\n","/**\n * Checks if `value` is `null` or `undefined`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is nullish, else `false`.\n * @example\n *\n * _.isNil(null);\n * // => true\n *\n * _.isNil(void 0);\n * // => true\n *\n * _.isNil(NaN);\n * // => false\n */\nfunction isNil(value) {\n  return value == null;\n}\n\nexport default isNil;\n","/**\n * Checks if `value` is `null`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `null`, else `false`.\n * @example\n *\n * _.isNull(null);\n * // => true\n *\n * _.isNull(void 0);\n * // => false\n */\nfunction isNull(value) {\n  return value === null;\n}\n\nexport default isNull;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nexport default isObject;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport isLength from './isLength.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nexport default baseIsTypedArray;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nexport default nodeUtil;\n","import baseIsTypedArray from './_baseIsTypedArray.js';\nimport baseUnary from './_baseUnary.js';\nimport nodeUtil from './_nodeUtil.js';\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nexport default isTypedArray;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nexport default baseUnary;\n","/**\n * Checks if `value` is `undefined`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n * @example\n *\n * _.isUndefined(void 0);\n * // => true\n *\n * _.isUndefined(null);\n * // => false\n */\nfunction isUndefined(value) {\n  return value === undefined;\n}\n\nexport default isUndefined;\n","/**\n * Gets the last element of `array`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to query.\n * @returns {*} Returns the last element of `array`.\n * @example\n *\n * _.last([1, 2, 3]);\n * // => 3\n */\nfunction last(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? array[length - 1] : undefined;\n}\n\nexport default last;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nexport default listCacheClear;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nexport default eq;\n","import eq from './eq.js';\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nexport default assocIndexOf;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nexport default listCacheDelete;\n","import listCacheClear from './_listCacheClear.js';\nimport listCacheDelete from './_listCacheDelete.js';\nimport listCacheGet from './_listCacheGet.js';\nimport listCacheHas from './_listCacheHas.js';\nimport listCacheSet from './_listCacheSet.js';\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nexport default ListCache;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nexport default listCacheGet;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nexport default listCacheHas;\n","import assocIndexOf from './_assocIndexOf.js';\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nexport default listCacheSet;\n","import getNative from './_getNative.js';\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nexport default nativeCreate;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nexport default hashGet;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nexport default hashHas;\n","import hashClear from './_hashClear.js';\nimport hashDelete from './_hashDelete.js';\nimport hashGet from './_hashGet.js';\nimport hashHas from './_hashHas.js';\nimport hashSet from './_hashSet.js';\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nexport default Hash;\n","import nativeCreate from './_nativeCreate.js';\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nexport default hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default hashDelete;\n","import nativeCreate from './_nativeCreate.js';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nexport default hashSet;\n","import isKeyable from './_isKeyable.js';\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nexport default getMapData;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nexport default isKeyable;\n","import mapCacheClear from './_mapCacheClear.js';\nimport mapCacheDelete from './_mapCacheDelete.js';\nimport mapCacheGet from './_mapCacheGet.js';\nimport mapCacheHas from './_mapCacheHas.js';\nimport mapCacheSet from './_mapCacheSet.js';\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nexport default MapCache;\n","import Hash from './_Hash.js';\nimport ListCache from './_ListCache.js';\nimport Map from './_Map.js';\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nexport default mapCacheClear;\n","import getMapData from './_getMapData.js';\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nexport default mapCacheDelete;\n","import getMapData from './_getMapData.js';\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nexport default mapCacheGet;\n","import getMapData from './_getMapData.js';\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nexport default mapCacheHas;\n","import getMapData from './_getMapData.js';\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nexport default mapCacheSet;\n","import ListCache from './_ListCache.js';\nimport stackClear from './_stackClear.js';\nimport stackDelete from './_stackDelete.js';\nimport stackGet from './_stackGet.js';\nimport stackHas from './_stackHas.js';\nimport stackSet from './_stackSet.js';\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nexport default Stack;\n","import ListCache from './_ListCache.js';\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nexport default stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nexport default stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nexport default stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nexport default stackHas;\n","import ListCache from './_ListCache.js';\nimport Map from './_Map.js';\nimport MapCache from './_MapCache.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nexport default stackSet;\n","import MapCache from './_MapCache.js';\nimport setCacheAdd from './_setCacheAdd.js';\nimport setCacheHas from './_setCacheHas.js';\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nexport default SetCache;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nexport default setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nexport default setCacheHas;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arraySome;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nexport default cacheHas;\n","import SetCache from './_SetCache.js';\nimport arraySome from './_arraySome.js';\nimport cacheHas from './_cacheHas.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalArrays;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nexport default Uint8Array;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nexport default mapToArray;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nexport default setToArray;\n","import Symbol from './_Symbol.js';\nimport Uint8Array from './_Uint8Array.js';\nimport eq from './eq.js';\nimport equalArrays from './_equalArrays.js';\nimport mapToArray from './_mapToArray.js';\nimport setToArray from './_setToArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nexport default equalByTag;\n","import arrayFilter from './_arrayFilter.js';\nimport stubArray from './stubArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nexport default getSymbols;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nexport default arrayFilter;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nexport default stubArray;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nexport default isIndex;\n","import baseTimes from './_baseTimes.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isIndex from './_isIndex.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nexport default arrayLikeKeys;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nexport default baseTimes;\n","import arrayLikeKeys from './_arrayLikeKeys.js';\nimport baseKeys from './_baseKeys.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nexport default keys;\n","import baseGetAllKeys from './_baseGetAllKeys.js';\nimport getSymbols from './_getSymbols.js';\nimport keys from './keys.js';\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nexport default getAllKeys;\n","import arrayPush from './_arrayPush.js';\nimport isArray from './isArray.js';\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nexport default baseGetAllKeys;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nexport default arrayPush;\n","import getAllKeys from './_getAllKeys.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalObjects;\n","import Stack from './_Stack.js';\nimport equalArrays from './_equalArrays.js';\nimport equalByTag from './_equalByTag.js';\nimport equalObjects from './_equalObjects.js';\nimport getTag from './_getTag.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nexport default baseIsEqualDeep;\n","import baseIsEqualDeep from './_baseIsEqualDeep.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nexport default baseIsEqual;\n","import isObject from './isObject.js';\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nexport default isStrictComparable;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nexport default matchesStrictComparable;\n","import baseIsMatch from './_baseIsMatch.js';\nimport getMatchData from './_getMatchData.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nexport default baseMatches;\n","import isStrictComparable from './_isStrictComparable.js';\nimport keys from './keys.js';\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nexport default getMatchData;\n","import Stack from './_Stack.js';\nimport baseIsEqual from './_baseIsEqual.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nexport default baseIsMatch;\n","import baseGetTag from './_baseGetTag.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nexport default isSymbol;\n","import isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nexport default isKey;\n","import MapCache from './_MapCache.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nexport default memoize;\n","import memoizeCapped from './_memoizeCapped.js';\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nexport default stringToPath;\n","import memoize from './memoize.js';\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nexport default memoizeCapped;\n","import Symbol from './_Symbol.js';\nimport arrayMap from './_arrayMap.js';\nimport isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default baseToString;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nexport default arrayMap;\n","import isArray from './isArray.js';\nimport isKey from './_isKey.js';\nimport stringToPath from './_stringToPath.js';\nimport toString from './toString.js';\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nexport default castPath;\n","import baseToString from './_baseToString.js';\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nexport default toString;\n","import isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nexport default toKey;\n","import castPath from './_castPath.js';\nimport toKey from './_toKey.js';\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nexport default baseGet;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nexport default baseHasIn;\n","import castPath from './_castPath.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isIndex from './_isIndex.js';\nimport isLength from './isLength.js';\nimport toKey from './_toKey.js';\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nexport default hasPath;\n","import baseHasIn from './_baseHasIn.js';\nimport hasPath from './_hasPath.js';\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nexport default hasIn;\n","import baseIsEqual from './_baseIsEqual.js';\nimport get from './get.js';\nimport hasIn from './hasIn.js';\nimport isKey from './_isKey.js';\nimport isStrictComparable from './_isStrictComparable.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\nimport toKey from './_toKey.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nexport default baseMatchesProperty;\n","import baseGet from './_baseGet.js';\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nexport default get;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nexport default identity;\n","import baseProperty from './_baseProperty.js';\nimport basePropertyDeep from './_basePropertyDeep.js';\nimport isKey from './_isKey.js';\nimport toKey from './_toKey.js';\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nexport default property;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nexport default baseProperty;\n","import baseGet from './_baseGet.js';\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nexport default basePropertyDeep;\n","/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nexport default baseIsNaN;\n","import baseIndexOf from './_baseIndexOf.js';\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\nexport default arrayIncludes;\n","import baseFindIndex from './_baseFindIndex.js';\nimport baseIsNaN from './_baseIsNaN.js';\nimport strictIndexOf from './_strictIndexOf.js';\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? strictIndexOf(array, value, fromIndex)\n    : baseFindIndex(array, baseIsNaN, fromIndex);\n}\n\nexport default baseIndexOf;\n","/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default strictIndexOf;\n","/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nexport default baseFindIndex;\n","/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arrayIncludesWith;\n","/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nexport default noop;\n","import Set from './_Set.js';\nimport noop from './noop.js';\nimport setToArray from './_setToArray.js';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\nexport default createSet;\n","import baseIteratee from './_baseIteratee.js';\nimport baseUniq from './_baseUniq.js';\n\n/**\n * This method is like `_.uniq` except that it accepts `iteratee` which is\n * invoked for each element in `array` to generate the criterion by which\n * uniqueness is computed. The order of result values is determined by the\n * order they occur in the array. The iteratee is invoked with one argument:\n * (value).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee=_.identity] The iteratee invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniqBy([2.1, 1.2, 2.3], Math.floor);\n * // => [2.1, 1.2]\n *\n * // The `_.property` iteratee shorthand.\n * _.uniqBy([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');\n * // => [{ 'x': 1 }, { 'x': 2 }]\n */\nfunction uniqBy(array, iteratee) {\n  return (array && array.length) ? baseUniq(array, baseIteratee(iteratee, 2)) : [];\n}\n\nexport default uniqBy;\n","import SetCache from './_SetCache.js';\nimport arrayIncludes from './_arrayIncludes.js';\nimport arrayIncludesWith from './_arrayIncludesWith.js';\nimport cacheHas from './_cacheHas.js';\nimport createSet from './_createSet.js';\nimport setToArray from './_setToArray.js';\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nexport default baseUniq;\n","import baseMatches from './_baseMatches.js';\nimport baseMatchesProperty from './_baseMatchesProperty.js';\nimport identity from './identity.js';\nimport isArray from './isArray.js';\nimport property from './property.js';\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nexport default baseIteratee;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(3607);\n"],"names":["root","factory","exports","module","require","define","amd","a","i","self","__WEBPACK_EXTERNAL_MODULE__459__","__WEBPACK_EXTERNAL_MODULE__2007__","Object","defineProperty","value","createQueryParametersAsString","queryParameters","keys","filter","key","map","encodeURIComponent","join","EventTargetPolyfill","this","listeners","prototype","addEventListener","type","callback","push","removeEventListener","stack","l","length","splice","dispatchEvent","event","slice","call","defaultPrevented","WebSocketClientEvent","WebSocketClient","HeartBeatState","HeartBeatState_1","enumerable","get","EventTargetPolyfill_1","WebSocketClient_1","WebSocketClientEvent_1","__assign","assign","t","s","n","arguments","p","hasOwnProperty","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","getPushUpdateWebSocket","setupSocketConnection","socket","defaultConnectionOptions","forceSecureProtocol","heartbeatAfterAuthorize","maxRetries","maxReconnectionDelay","webSocketUrlWithoutProtocol","options","TypeError","connectionOptions","wscOptions","url","window","location","protocol","createWebSocketUrlWithProtocol","undefined","MESSAGE","JSON","parse","detail","data","startHeartBeat","extendStatics","__extends","d","b","setPrototypeOf","__proto__","Array","__","constructor","create","__importDefault","mod","__esModule","HEART_BEAT_CHECK_TIMEOUT","HEART_BEAT_INTERVAL","reconnecting_websocket_1","_super","protocols","_this","heartBeatTimeout","heartBeatCheckTimeout","sendHeartBeat","send","stringify","action","handleHeartBeatResponse","heartBeatState","DYING","LIVING","dispatchHeartBeatState","setHeartBeatCheckTimeout","clearTimeout","setTimeout","CustomEvent","isHeartBeatActive","default","onopen","OPEN","onclose","retryCount","DIED","CLOSE","onmessage","heartBeatCallback","stopHeartBeat","__read","o","m","Symbol","iterator","r","ar","next","done","error","__spread","concat","Event","target","ErrorEvent","message","CloseEvent","code","reason","wasClean","getGlobalWebSocket","WebSocket","DEFAULT","minReconnectionDelay","Math","random","minUptime","reconnectionDelayGrowFactor","connectionTimeout","Infinity","maxEnqueuedMessages","startClosed","debug","ReconnectingWebSocket","_listeners","open","close","_retryCount","_shouldReconnect","_connectLock","_binaryType","_closeCalled","_messageQueue","onerror","_handleOpen","_debug","_a","_options","_connectTimeout","_uptimeTimeout","_acceptOpen","_ws","binaryType","forEach","listener","_callEventListener","_handleMessage","_handleError","_disconnect","_connect","_handleClose","_clearTimeouts","_url","_protocols","configurable","CONNECTING","CLOSING","CLOSED","set","max","reduce","acc","Blob","size","byteLength","bufferedAmount","extensions","readyState","reconnect","e_1","listeners_1","__values","listeners_1_1","e_1_1","return","args","_i","console","log","_getNextDelay","_b","_c","_d","delay","pow","_wait","Promise","resolve","_getNextUrl","urlProvider","then","Error","_removeListeners","w","_addListeners","_handleTimeout","catch","err","handleEvent","AwsChatWindowEventActionRoute","AwsResponseEventType","AwsInputEventType","DeviceType","ApplicationType","MessageDirection","MessageType","CaseStatus","PushUpdateEventType","websocketClient","customer","_incomingChatEventMiddleware","ChatEventMiddleware","isAuthorizationEnabled","isLivechat","channelId","_sendRefreshTokenEvent","accessToken","getAccessToken","isNull","sendChatEvent","createRefreshTokenPayload","token","refreshTokenResponse","isTokenRefreshedSuccessResponse","setAccessToken","handleRefreshToken","SDKVariableStorage","ChatSDKVariable","AUTHORIZATION_CODE","authorizationCode","BRAND_ID","brandId","CHANNEL_ID","getBrandIdAndChannelId","onError","register","chatEventMapper","storeThreadScrollDataMiddleware","storeContactIdMiddleware","_messageEmitter","ChatEventTarget","isNaN","customerId","_initEnvironment","_initWS","Customer","customerName","onErrorHandler","ChatSDKError","authorize","visitorId","authorizationPayloadData","createAuthorizationPayloadData","createEvent","createEventPayload","generateId","REGISTER","makeRequest","response","isAuthSuccessEvent","channel","settings","consumerIdentity","firstName","lastName","setName","onChatEvent","handler","getCustomer","getThread","id","LivechatThread","Thread","getTheadList","eventPayload","eventType","FETCH_THREAD_LIST","result","isThreadListFetchedPostbackData","threads","environment","EnvironmentName","custom","isEmpty","customEnvironment","ENDPOINT_GATEWAY","gateway","ENDPOINT_CHAT","chat","getEnvironmentEndpoints","endpoint","assertNonNullable","URL","wsClientOptions","host","hostname","port","on","parsedEvent","process","parseWsMessageEvent","isNil","onMessageHandler","ChatSdk","hasUserData","user","ChatEvent","AGENT_TYPING_STARTED","AGENT_TYPING_ENDED","ASSIGNED_AGENT_CHANGED","createPayloadForAttachmentUpload","file","createLocalFileReader","reader","name","mimeType","reject","FileReader","onloadend","errorEvent","readAsDataURL","createAttachmentPayload","attachment","uploadAttachment","uploadAttachmentResponse","isUploadSuccessResponse","fileUrl","friendlyName","isUploadFailResponse","createAttachmentUploadMessageData","files","threadIdOnExternalPlatform","all","from","attachments","messageId","browserFingerprint","getBrowserFingerprint","threadCustomFields","messageContent","TEXT","payload","text","thread","idOnExternalPlatform","consumer","customFields","consumerContact","convertCustomFields","isUndefined","allowedFileSize","CHANNEL_INTEGRATION_URL","fileName","content","split","requestBody","fetch","method","body","headers","ok","status","json","ACCESS_TOKEN","ACCESS_TOKEN_EXPIRES_IN","String","expiresIn","Number","AUTHORIZE_CONSUMER","authorization","createVisitorPayload","REFRESH_TOKEN","refreshTokenTimeoutId","getIdealTimeInSecondsForIssueRefreshToken","accessTokenExpiresIn","idealTimeToRefreshAccessToken","round","refreshTokenAction","CONSUMER_AUTHORIZED","TOKEN_REFRESHED","getDeviceType","deviceType","MOBILE","TABLET","DESKTOP","getBrowserLanguage","navigator","language","getBrowserLocation","Intl","DateTimeFormat","resolvedOptions","timeZone","deviceInfoFromUserAgent","userAgent","country","ip","browser","getBrowser","browserVersion","version","os","getOS","osVersion","getDevice","applicationType","BROWSER","CASE_CREATED","CASE_STATUS_CHANGED","entries","ident","mergeCustomFields","customFieldsQueue","dataCustomFields","convertedQueue","uniqBy","setId","CUSTOMER_ID","getId","getName","CUSTOMER_NAME","getIdOrCreateNewOne","setCustomFields","payloadData","createSetCustomerCustomFieldsPayloadData","setCustomField","storedName","customerIdentityNamePayload","splitName","SEND_CONSUMER_CUSTOM_FIELDS","placeholder","chatUrlTemplate","gatewayUrlTemplate","AU1","replace","CA1","EU1","JP1","NA1","UK1","_vars","variableName","defaultValue","list","clear","VariablesStorage","CHAT_SDK_VERSION","env","PACKAGE_VERSION","middlewares","middleware","processedEvent","EventTarget","eventTypeMap","SENDER_TYPING_STARTED","agentTypingStarted","SENDER_TYPING_ENDED","agentTypingEnded","CASE_INBOX_ASSIGNEE_CHANGED","assignedAgentChanged","EMPTY_EVENT","hasEventId","hasError","eventId","eventDetailData","postback","hasEventType","hasData","postbackData","postbackEventType","rawEventId","restEventData","eventRest","webSocketClient","createTextMessageData","messageText","customerCustomFields","getAuthor","direction","INBOUND","authorEndUserIdentity","fullName","authorUser","surname","trim","item","hasId","hasDirection","hasMessageContent","MESSAGE_CREATED","MORE_MESSAGES_LOADED","messages","createLoadMoreMessagesPayloadData","eventData","LOAD_MORE_MESSAGES","sendMessage","messageData","sendMessagePayloadData","createSendMessagePayloadData","isSendMessageSuccessEventData","SEND_MESSAGE","wsClient","requestQueue","eventDetail","normalizeEvent","has","Map","eventPayloadData","createCustomerIdentityPayload","destination","visitor","brand","actionRoute","CHAT_WINDOW_EVENT","_connection","connect","consumerIdOnExternalPlatform","queryParametersAsString","prefix","socketUrl","consumerId","v","CHAT_SDK_WEBSOCKET_PREFIX","_errorHandler","disconnect","stringData","handlerCallback","off","closeEvent","WebSocketClientError","reasonMessage","messageEmitter","_exists","_typingTimeoutID","_threadCustomFieldsQueue","_isAuthorizationEnabled","_websocketClient","_registerEventHandlers","recover","createRecoverThreadPayloadData","isRecoverSuccessPayload","storedAccessToken","messageDataWithCustomFields","sendTextMessage","optionsThreadCustomFields","convertedOptionsThreadCustomFields","loadMoreMessages","THREAD_DATA","scrollToken","oldestMessageDatetime","loadMoreMessagesEventData","isLoadMoreMessagesEventData","lastMessageSeen","createLastMessageSeenPayloadData","sendAttachments","keystroke","timeout","createStartTypingEventPayloadData","createStopTypingEventPayloadData","stopTyping","getMetadata","createLoadThreadMetadataEventPayloadData","isLoadMetadataSuccessPayload","onThreadEvent","filteredEventHandler","filterCurrentThreadEventHandler","customFieldsData","createSetThreadCustomFieldsPayloadData","archive","createArchiveThreadEventPayloadData","isThreadArchivedSuccessPayload","updateThreadData","createUpdateThreadPayloadData","isUpdateThreadSuccess","THREAD_RECOVERED","ARCHIVE_THREAD","THREAD_METADATA_LOADED","lastMessage","testResponseData","hasPostbackData","hasMessages","isCorrectEventType","LIVECHAT_RECOVERED","hasNoError","THREAD_ARCHIVED","MESSAGE_SEEN","_isInitialized","_canSendMessage","_registerLivechatEventHandlers","createRecoverLivechatThreadPayloadData","startChat","initialMessageText","endChat","threadDataRaw","threadData","contactId","createEndThreadPayloadData","isContactStatusChangedEvent","END_CONTACT","contact","isSetPositionInQueuePayload","setPostionDetail","isInteger","positionInQueue","SET_POSITION_IN_QUEUE","RECOVER_LIVECHAT","LOAD_THREAD_METADATA","RECOVER_THREAD","SET_CONSUMER_CONTACT_CUSTOM_FIELD","originalThreadDataRaw","originalThreadData","isContactCreatedEvent","storeContactId","caseId","scrollData","lastItemInArray","createdAt","oldThreadDataRaw","oldThreadData","messagesScrollToken","storeThreadScrollData","threadId","threadName","UPDATE_THREAD","parseInt","objectProto","nativeObjectToString","toString","symToStringTag","isOwn","tag","unmasked","func","transform","arg","object","global","uid","maskSrcKey","exec","reIsHostCtor","funcProto","Function","funcToString","reIsNative","RegExp","isObject","isFunction","test","mapTag","promiseTag","setTag","weakMapTag","dataViewTag","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","getTag","ArrayBuffer","Ctor","ctorString","freeSelf","isObjectLike","isArray","freeExports","nodeType","freeModule","Buffer","isBuffer","typedArrayTags","freeProcess","nodeUtil","types","binding","nodeIsTypedArray","isLength","array","other","ListCache","index","entry","__data__","pop","Hash","MapCache","Stack","pairs","LARGE_ARRAY_SIZE","SetCache","values","add","predicate","cache","bitmask","customizer","equalFunc","isPartial","arrLength","othLength","arrStacked","othStacked","seen","arrValue","othValue","compared","othIndex","symbolProto","symbolValueOf","valueOf","nativeGetSymbols","resIndex","symbol","reIsUint","inherited","isArr","isArg","isArguments","isBuff","isType","isTypedArray","skipIndexes","iteratee","isArrayLike","keysFunc","symbolsFunc","offset","argsTag","arrayTag","objectTag","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","byteOffset","buffer","convert","stacked","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","objProps","objLength","objStacked","skipCtor","objValue","objCtor","othCtor","baseIsEqual","srcValue","source","matchData","noCustomizer","reIsDeepProp","reIsPlainProp","memoize","resolver","memoized","Cache","rePropName","reEscapeChar","string","charCodeAt","match","number","quote","subString","symbolToString","baseToString","path","hasFunc","fromIndex","fromRight","comparator","includes","isCommon","outer","computed","seenIndex","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","definition","obj","prop","toStringTag"],"sourceRoot":""}