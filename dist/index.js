/*! For license information please see index.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("uuid"),require("ua-parser-js"));else if("function"==typeof define&&define.amd)define(["uuid","ua-parser-js"],t);else{var n="object"==typeof exports?t(require("uuid"),require("ua-parser-js")):t(e.uuid,e["ua-parser-js"]);for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,((e,t)=>(()=>{"use strict";var n={3893:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createQueryParametersAsString=void 0,t.createQueryParametersAsString=function(e){return Object.keys(e).filter((function(t){return null!==e[t]})).map((function(t){return[t,e[t]].map(encodeURIComponent).join("=")})).join("&")}},996:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventTargetPolyfill=void 0;var n=function(){function e(){this.listeners={}}return e.prototype.addEventListener=function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.removeEventListener=function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,o=n.length;r<o;r++)if(n[r]===t)return void n.splice(r,1)},e.prototype.dispatchEvent=function(e){if(!(e.type in this.listeners))return!0;for(var t=this.listeners[e.type].slice(),n=0,r=t.length;n<r;n++)t[n].call(this,e);return!e.defaultPrevented},e}();t.EventTargetPolyfill=n},6455:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketClientEvent=t.WebSocketClient=t.EventTargetPolyfill=t.HeartBeatState=void 0;var r=n(1546);Object.defineProperty(t,"HeartBeatState",{enumerable:!0,get:function(){return r.HeartBeatState}});var o=n(996);Object.defineProperty(t,"EventTargetPolyfill",{enumerable:!0,get:function(){return o.EventTargetPolyfill}});var a=n(2846);Object.defineProperty(t,"WebSocketClient",{enumerable:!0,get:function(){return a.WebSocketClient}});var i=n(5982);Object.defineProperty(t,"WebSocketClientEvent",{enumerable:!0,get:function(){return i.WebSocketClientEvent}})},5415:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0}),t.getPushUpdateWebSocket=t.setupSocketConnection=void 0;var a=n(2846),i=n(5982),s=null,u={forceSecureProtocol:!1,heartbeatAfterAuthorize:!1,maxRetries:20,maxReconnectionDelay:1e3};t.setupSocketConnection=function(e,t){if(void 0===t&&(t={}),"object"!=typeof t)throw new TypeError("Options parameter must be an object not a "+typeof t);var n=r(r({},u),t),c=n.forceSecureProtocol,l=n.heartbeatAfterAuthorize,d=o(n,["forceSecureProtocol","heartbeatAfterAuthorize"]),h=function(e,t){return t?"wss://"+e:("https:"===window.location.protocol?"wss:":"ws:")+"//"+e}(e,c);return s=new a.WebSocketClient(h,void 0,d),l?s.addEventListener(i.WebSocketClientEvent.MESSAGE,(function(e){"authorized"===JSON.parse(e.detail.data)&&(null==s||s.startHeartBeat())})):s.startHeartBeat(),s},t.getPushUpdateWebSocket=function(){return s}},1546:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.HeartBeatState=void 0,(n=t.HeartBeatState||(t.HeartBeatState={})).DIED="died",n.DYING="dying",n.LIVING="living"},2846:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketClient=t.HEART_BEAT_CHECK_TIMEOUT=t.HEART_BEAT_INTERVAL=void 0;var i=a(n(7864)),s=n(996),u=n(1546),c=n(5982);t.HEART_BEAT_INTERVAL=3e3,t.HEART_BEAT_CHECK_TIMEOUT=3*t.HEART_BEAT_INTERVAL;var l=function(e){function n(n,r,o){var a=e.call(this)||this;return a.heartBeatTimeout=null,a.heartBeatCheckTimeout=null,a.sendHeartBeat=function(){a.send(JSON.stringify({action:"heartbeat"}))},a.handleHeartBeatResponse=function(){a.heartBeatState===u.HeartBeatState.DYING&&(a.heartBeatState=u.HeartBeatState.LIVING,a.dispatchHeartBeatState()),a.setHeartBeatCheckTimeout()},a.setHeartBeatCheckTimeout=function(){null!==a.heartBeatCheckTimeout&&clearTimeout(a.heartBeatCheckTimeout),a.heartBeatCheckTimeout=setTimeout((function(){a.heartBeatState=u.HeartBeatState.DYING,a.dispatchHeartBeatState()}),t.HEART_BEAT_CHECK_TIMEOUT)},a.dispatchHeartBeatState=function(){null!==a.heartBeatState&&a.dispatchEvent(new CustomEvent(a.heartBeatState))},a.isHeartBeatActive=function(){return null!==a.heartBeatState},a.heartBeatState=null,a.socket=new i.default(n,r,o),a.socket.onopen=function(){a.dispatchEvent(new CustomEvent(c.WebSocketClientEvent.OPEN))},a.socket.onclose=function(){a.socket.retryCount===(null==o?void 0:o.maxRetries)?a.heartBeatState=u.HeartBeatState.DIED:a.heartBeatState=u.HeartBeatState.DYING,a.dispatchHeartBeatState(),a.dispatchEvent(new CustomEvent(c.WebSocketClientEvent.CLOSE))},a.socket.onmessage=function(e){a.handleHeartBeatResponse(),"pong"!==JSON.parse(e.data)&&a.dispatchEvent(new CustomEvent(c.WebSocketClientEvent.MESSAGE,{detail:e}))},a}return o(n,e),n.prototype.send=function(e){this.socket.send(e)},n.prototype.startHeartBeat=function(){var e=this,n=function(){e.sendHeartBeat(),e.heartBeatTimeout=setTimeout(n,t.HEART_BEAT_INTERVAL)};this.setHeartBeatCheckTimeout(),n(),this.heartBeatState=u.HeartBeatState.LIVING},n.prototype.stopHeartBeat=function(){null!==this.heartBeatTimeout&&clearTimeout(this.heartBeatTimeout),null!==this.heartBeatCheckTimeout&&clearTimeout(this.heartBeatCheckTimeout),this.heartBeatState=null},n}(s.EventTargetPolyfill);t.WebSocketClient=l},5982:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketClientEvent=void 0,(n=t.WebSocketClientEvent||(t.WebSocketClientEvent={})).CLOSE="close",n.MESSAGE="message",n.OPEN="open"},7864:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},r(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function a(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,a=n.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i}function i(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(a(arguments[t]));return e}var s=function(e,t){this.target=t,this.type=e},u=function(e){function t(t,n){var r=e.call(this,"error",n)||this;return r.message=t.message,r.error=t,r}return o(t,e),t}(s),c=function(e){function t(t,n,r){void 0===t&&(t=1e3),void 0===n&&(n="");var o=e.call(this,"close",r)||this;return o.wasClean=!0,o.code=t,o.reason=n,o}return o(t,e),t}(s),l=function(){if("undefined"!=typeof WebSocket)return WebSocket},d={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+4e3*Math.random(),minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0,startClosed:!1,debug:!1};const h=function(){function e(e,t,n){var r=this;void 0===n&&(n={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(e){r._debug("open event");var t=r._options.minUptime,n=void 0===t?d.minUptime:t;clearTimeout(r._connectTimeout),r._uptimeTimeout=setTimeout((function(){return r._acceptOpen()}),n),r._ws.binaryType=r._binaryType,r._messageQueue.forEach((function(e){var t;return null===(t=r._ws)||void 0===t?void 0:t.send(e)})),r._messageQueue=[],r.onopen&&r.onopen(e),r._listeners.open.forEach((function(t){return r._callEventListener(e,t)}))},this._handleMessage=function(e){r._debug("message event"),r.onmessage&&r.onmessage(e),r._listeners.message.forEach((function(t){return r._callEventListener(e,t)}))},this._handleError=function(e){r._debug("error event",e.message),r._disconnect(void 0,"TIMEOUT"===e.message?"timeout":void 0),r.onerror&&r.onerror(e),r._debug("exec error listeners"),r._listeners.error.forEach((function(t){return r._callEventListener(e,t)})),r._connect()},this._handleClose=function(e){r._debug("close event"),r._clearTimeouts(),r._shouldReconnect&&r._connect(),r.onclose&&r.onclose(e),r._listeners.close.forEach((function(t){return r._callEventListener(e,t)}))},this._url=e,this._protocols=t,this._options=n,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(e,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(e,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CONNECTING",{get:function(){return e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OPEN",{get:function(){return e.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSING",{get:function(){return e.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CLOSED",{get:function(){return e.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(e){this._binaryType=e,this._ws&&(this._ws.binaryType=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bufferedAmount",{get:function(){return this._messageQueue.reduce((function(e,t){return"string"==typeof t?e+=t.length:t instanceof Blob?e+=t.size:e+=t.byteLength,e}),0)+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?e.CLOSED:e.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),e.prototype.close=function(e,t){void 0===e&&(e=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),this._ws?this._ws.readyState!==this.CLOSED?this._ws.close(e,t):this._debug("close: already closed"):this._debug("close enqueued: no ws instance")},e.prototype.reconnect=function(e,t){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,this._ws&&this._ws.readyState!==this.CLOSED?(this._disconnect(e,t),this._connect()):this._connect()},e.prototype.send=function(e){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",e),this._ws.send(e);else{var t=this._options.maxEnqueuedMessages,n=void 0===t?d.maxEnqueuedMessages:t;this._messageQueue.length<n&&(this._debug("enqueue",e),this._messageQueue.push(e))}},e.prototype.addEventListener=function(e,t){this._listeners[e]&&this._listeners[e].push(t)},e.prototype.dispatchEvent=function(e){var t,n,r=this._listeners[e.type];if(r)try{for(var o=function(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}(r),a=o.next();!a.done;a=o.next()){var i=a.value;this._callEventListener(e,i)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return!0},e.prototype.removeEventListener=function(e,t){this._listeners[e]&&(this._listeners[e]=this._listeners[e].filter((function(e){return e!==t})))},e.prototype._debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._options.debug&&console.log.apply(console,i(["RWS>"],e))},e.prototype._getNextDelay=function(){var e=this._options,t=e.reconnectionDelayGrowFactor,n=void 0===t?d.reconnectionDelayGrowFactor:t,r=e.minReconnectionDelay,o=void 0===r?d.minReconnectionDelay:r,a=e.maxReconnectionDelay,i=void 0===a?d.maxReconnectionDelay:a,s=0;return this._retryCount>0&&(s=o*Math.pow(n,this._retryCount-1))>i&&(s=i),this._debug("next delay",s),s},e.prototype._wait=function(){var e=this;return new Promise((function(t){setTimeout(t,e._getNextDelay())}))},e.prototype._getNextUrl=function(e){if("string"==typeof e)return Promise.resolve(e);if("function"==typeof e){var t=e();if("string"==typeof t)return Promise.resolve(t);if(t.then)return t}throw Error("Invalid URL")},e.prototype._connect=function(){var e=this;if(!this._connectLock&&this._shouldReconnect){this._connectLock=!0;var t=this._options,n=t.maxRetries,r=void 0===n?d.maxRetries:n,o=t.connectionTimeout,a=void 0===o?d.connectionTimeout:o,i=t.WebSocket,s=void 0===i?l():i;if(this._retryCount>=r)this._debug("max retries reached",this._retryCount,">=",r);else{if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),void 0===(c=s)||!c||2!==c.CLOSING)throw Error("No valid WebSocket class provided");var c;this._wait().then((function(){return e._getNextUrl(e._url)})).then((function(t){e._closeCalled?e._connectLock=!1:(e._debug("connect",{url:t,protocols:e._protocols}),e._ws=e._protocols?new s(t,e._protocols):new s(t),e._ws.binaryType=e._binaryType,e._connectLock=!1,e._addListeners(),e._connectTimeout=setTimeout((function(){return e._handleTimeout()}),a))})).catch((function(t){e._connectLock=!1,e._handleError(new u(Error(t.message),e))}))}}},e.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new u(Error("TIMEOUT"),this))},e.prototype._disconnect=function(e,t){if(void 0===e&&(e=1e3),this._clearTimeouts(),this._ws){this._removeListeners();try{this._ws.close(e,t),this._handleClose(new c(e,t,this))}catch(e){}}},e.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},e.prototype._callEventListener=function(e,t){"handleEvent"in t?t.handleEvent(e):t(e)},e.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},e.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},e.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},e}()},3441:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.AwsChatWindowEventActionRoute||(t.AwsChatWindowEventActionRoute={})).CHAT_WINDOW_EVENT="chatWindowEvent",n.REGISTER="register"},8154:(e,t)=>{var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=t.AwsInputEventType||(t.AwsInputEventType={})).SENDER_TYPING_STARTED="SenderTypingStarted",r.SENDER_TYPING_ENDED="SenderTypingEnded",r.LOAD_MORE_MESSAGES="LoadMoreMessages",r.RECOVER_LIVECHAT="RecoverLivechat",r.RECOVER_THREAD="RecoverThread",r.SEND_MESSAGE="SendMessage",r.SEND_OUTBOUND="SendOutbound",r.SEND_OFFLINE_MESSAGE="SendOfflineMessage",r.SEND_PAGE_VIEWS="SendPageViews",r.SEND_CONSUMER_CUSTOM_FIELDS="SetConsumerCustomFields",r.SET_CONSUMER_CONTACT_CUSTOM_FIELD="SetConsumerContactCustomFields",r.MESSAGE_SEEN="MessageSeenByConsumer",r.SEND_TRANSCRIPT="SendTranscript",r.FETCH_THREAD_LIST="FetchThreadList",r.END_CONTACT="EndContact",r.EXECUTE_TRIGGER="ExecuteTrigger",r.AUTHORIZE_CONSUMER="AuthorizeConsumer",r.RECONNECT_CONSUMER="ReconnectConsumer",r.UPDATE_THREAD="UpdateThread",r.ARCHIVE_THREAD="ArchiveThread",r.LOAD_THREAD_METADATA="LoadThreadMetadata",r.REFRESH_TOKEN="RefreshToken",r.STORE_VISITOR="StoreVisitor",r.STORE_VISITOR_EVENTS="StoreVisitorEvents",r.CREATE_GROUP_CHAT_INVITE="CreateInvitationToGroupChat",r.SEND_EMAIL_INVITE_TO_GROUP_CHAT="SendEmailInvitationToGroupChat",r.JOIN_GROUP_CHAT="JoinGroupChat",r.LEAVE_GROUP_CHAT="LeaveGroupChat",r.GENERATE_AUTHORIZATION_TOKEN="GenerateAuthorizationToken",r.ADD_VISITOR_TAGS="AddVisitorTags",r.REMOVE_VISITOR_TAGS="RemoveVisitorTags",r.SEND_MESSAGE_PREVIEW="SendMessagePreview",(n=t.AwsResponseEventType||(t.AwsResponseEventType={})).LIVECHAT_RECOVERED="LivechatRecovered",n.MORE_MESSAGES_LOADED="MoreMessagesLoaded",n.OFFLINE_MESSAGE_SENT="OfflineMessageSent",n.THREAD_LIST_FETCHED="ThreadListFetched",n.THREAD_RECOVERED="ThreadRecovered",n.TRANSCRIPT_SENT="TranscriptSent",n.CONSUMER_AUTHORIZED="ConsumerAuthorized",n.THREAD_METADATA_LOADED="ThreadMetadataLoaded",n.SET_POSITION_IN_QUEUE="SetPositionInQueue",n.GROUP_CHAT_INVITE_CREATED="InvitationToGroupChatCreated",n.GROUP_CHAT_INVITE_SENT="EmailInvitationToGroupChatSent",n.GROUP_CHAT_JOINED="GroupChatJoined",n.TOKEN_REFRESHED="TokenRefreshed",n.AUTHORIZATION_TOKEN_GENERATED="AuthorizationTokenGenerated",n.THREAD_ARCHIVED="ThreadArchived"},3058:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.DeviceType||(t.DeviceType={})).DESKTOP="desktop",n.MOBILE="mobile",n.OTHER="other",n.TABLET="tablet",(t.ApplicationType||(t.ApplicationType={})).BROWSER="browser"},6510:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.MessageDirection||(t.MessageDirection={})).INBOUND="inbound",n.OUTBOUND="outbound"},5115:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.MessageType||(t.MessageType={})).TEXT="TEXT",n.FILE="FILE",n.PLUGIN="PLUGIN",n.POSTBACK="POSTBACK",n.QUICK_REPLIES="QUICK_REPLIES"},9256:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.CaseStatus||(t.CaseStatus={})).NEW="new",n.OPEN="open",n.PENDING="pending",n.ESCALATED="escalated",n.RESOLVED="resolved",n.CLOSED="closed",n.TRASHED="trashed"},9403:(e,t)=>{var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.PushUpdateEventType||(t.PushUpdateEventType={})).AUTHORIZE_CONSUMER="AuthorizeConsumer",n.CASE_CREATED="CaseCreated",n.CASE_INBOX_ASSIGNEE_CHANGED="CaseInboxAssigneeChanged",n.CASE_STATUS_CHANGED="CaseStatusChanged",n.CASE_TO_ROUTING_QUEUE_ASSIGNMENT_CHANGED="CaseToRoutingQueueAssignmentChanged",n.CHANNEL_CREATED="ChannelCreated",n.CHANNEL_DELETED="ChannelDeleted",n.CHANNEL_UPDATED="ChannelUpdated",n.MESSAGE_ADDED_INTO_CASE="MessageAddedIntoCase",n.MESSAGE_CREATED="MessageCreated",n.MESSAGE_DELIVERED_TO_END_USER="MessageDeliveredToEndUser",n.MESSAGE_DELIVERED_TO_USER="MessageDeliveredToUser",n.MESSAGE_NOTE_CREATED="MessageNoteCreated",n.MESSAGE_NOTE_UPDATED="MessageNoteUpdated",n.MESSAGE_NOTE_DELETED="MessageNoteDeleted",n.MESSAGE_READ_CHANGED="MessageReadChanged",n.MESSAGE_SEEN_BY_END_USER="MessageSeenByEndUser",n.MESSAGE_SEEN_BY_USER="MessageSeenByUser",n.MESSAGE_UPDATED="MessageUpdated",n.PAGE_VIEW_CREATED="PageViewCreated",n.ROUTING_QUEUE_CREATED="RoutingQueueCreated",n.ROUTING_QUEUE_DELETED="RoutingQueueDeleted",n.ROUTING_QUEUE_UPDATED="RoutingQueueUpdated",n.SUBQUEUE_ASSIGNED_TO_ROUTING_QUEUE="SubqueueAssignedToRoutingQueue",n.SUBQUEUE_UNASSIGNED_TO_ROUTING_QUEUE="SubqueueUnassignedFromRoutingQueue",n.USER_ASSIGNED_TO_ROUTING_QUEUE="UserAssignedToRoutingQueue",n.USER_STATUS_CHANGED="UserStatusChanged",n.USER_UNASSIGNED_FROM_ROUTING_QUEUE="UserUnassignedFromRoutingQueue",n.AGENT_CONTACT_STARTED="AgentContactStarted",n.AGENT_CONTACT_ENDED="AgentContactEnded",n.SENDER_TYPING_STARTED="SenderTypingStarted",n.SENDER_TYPING_ENDED="SenderTypingEnded",n.FIRE_PROACTIVE="FireProactiveAction",n.CONTACT_INBOX_PRE_ASSIGNEE_CHANGED="ConsumerContactInboxPreAssigneeChanged",n.CONTACT_RECIPIENTS_CHANGED="ContactRecipientsChanged"},4084:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.ChatSdk=void 0;var a=n(6455),i=n(3441),s=n(8154),u=n(3542),c=n(1553),l=n(9716),d=n(2080),h=n(7084),f=n(8493),v=n(1053),p=n(7214),_=n(1422),E=n(80),y=n(7594),g=n(1485),b=n(3858),S=n(374),T=n(1187),m=n(2968),C=n(2046),w=n(7722),A=n(4853),O=n(9544),D=n(3550),I=n(8837),P=n(696),N=n(3467),M=n(505),R=n(597),k=n(8470),j=function(){function e(e){var t=this;if(this.websocketClient=null,this.customer=null,this._incomingChatEventMiddleware=new g.ChatEventMiddleware,this.isAuthorizationEnabled=!1,this.isLivechat=!1,this.channelId="",this._sendRefreshTokenEvent=function(){return r(t,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:return e=(0,u.getAccessToken)(),(0,k.isNull)(e)?[2]:[4,(0,T.sendChatEvent)((0,l.createRefreshTokenPayload)(e.token),this.websocketClient)];case 1:if(t=n.sent(),(0,f.isTokenRefreshedSuccessResponse)(t))return(0,u.setAccessToken)(t.data.accessToken),(0,d.handleRefreshToken)(t.data.accessToken,this._sendRefreshTokenEvent),[2];throw t}}))}))},void 0===e)throw new Error("No options was provided for initialization of ChatSdk");E.SDKVariableStorage.set(p.ChatSDKVariable.AUTHORIZATION_CODE,e.authorizationCode),E.SDKVariableStorage.set(p.ChatSDKVariable.BRAND_ID,"".concat(e.brandId)),E.SDKVariableStorage.set(p.ChatSDKVariable.CHANNEL_ID,e.channelId);var n=(0,R.getBrandIdAndChannelId)(),a=n.brandId,i=n.channelId;this.onError=e.onError,this._incomingChatEventMiddleware.register(S.chatEventMapper),this._incomingChatEventMiddleware.register(P.storeThreadScrollDataMiddleware),this._incomingChatEventMiddleware.register(I.storeContactIdMiddleware),this._messageEmitter=new b.ChatEventTarget;try{if(isNaN(a))throw new Error("Missing BrandID");if(void 0===i)throw new Error("Missing ChannelId");if(void 0===e.customerId)throw new Error("Missing CustomerId");this._initEnvironment(e),this._initWS(a,i,e.customerId),this.customer=new v.Customer(e.customerId,e.customerName,this.websocketClient),this.channelId=i}catch(e){this.onErrorHandler(e)}}return e.prototype.onErrorHandler=function(e){if("function"!=typeof this.onError)throw new y.ChatSDKError(e);this.onError(new y.ChatSDKError(e))},e.prototype.authorize=function(e,t){var n,a,s,l,f,v,_,y,g,b,S,T;return r(this,void 0,void 0,(function(){var r,C,A;return o(this,(function(o){switch(o.label){case 0:return r=(0,c.createAuthorizationPayloadData)(null!=e?e:E.SDKVariableStorage.get(p.ChatSDKVariable.AUTHORIZATION_CODE,null),t),C=(0,w.createEvent)((0,w.createEventPayload)(r),(0,M.generateId)(),i.AwsChatWindowEventActionRoute.REGISTER),[4,(0,m.makeRequest)(C,this.websocketClient)];case 1:if(A=o.sent(),(0,h.isAuthSuccessEvent)(A))return this.isLivechat=null!==(l=null===(s=null===(a=null===(n=A.data)||void 0===n?void 0:n.channel)||void 0===a?void 0:a.settings)||void 0===s?void 0:s.isLivechat)&&void 0!==l&&l,this.isAuthorizationEnabled=null!==(v=null===(f=A.data.channel)||void 0===f?void 0:f.settings.isAuthorizationEnabled)&&void 0!==v&&v,void 0!==(null===(_=A.data.accessToken)||void 0===_?void 0:_.token)&&((0,u.setAccessToken)(A.data.accessToken),void 0===(null===(g=null===(y=A.data)||void 0===y?void 0:y.consumerIdentity)||void 0===g?void 0:g.firstName)&&void 0===(null===(S=null===(b=A.data)||void 0===b?void 0:b.consumerIdentity)||void 0===S?void 0:S.lastName)||null===(T=this.customer)||void 0===T||T.setName("".concat(A.data.consumerIdentity.firstName," ").concat(A.data.consumerIdentity.lastName)),(0,d.handleRefreshToken)(A.data.accessToken,this._sendRefreshTokenEvent)),[2,A.data];throw A}}))}))},e.prototype.onChatEvent=function(e,t){var n=this;return this._messageEmitter.addEventListener(e,t),function(){n._messageEmitter.removeEventListener(e,t)}},e.prototype.getCustomer=function(){return this.customer},e.prototype.getThread=function(e){if((0,k.isNull)(this.websocketClient))throw new y.ChatSDKError("Cannot get thread because websocket is disconnected");return this.isLivechat?new O.LivechatThread(e,this.websocketClient,this._messageEmitter,this.isAuthorizationEnabled):new O.Thread(e,this.websocketClient,this._messageEmitter,this.isAuthorizationEnabled)},e.prototype.getTheadList=function(){return r(this,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:if((0,k.isNull)(this.websocketClient))throw new y.ChatSDKError("Cannot get thread list because websocket is disconnected");return e={eventType:s.AwsInputEventType.FETCH_THREAD_LIST,data:{}},[4,(0,T.sendChatEvent)(e,this.websocketClient)];case 1:if(t=n.sent(),!(0,D.isThreadListFetchedPostbackData)(t.data))throw new y.ChatSDKError("Invalid response from fetch thread list (getTheadList)");return[2,t.data.threads]}}))}))},e.prototype._initEnvironment=function(e){var t,n;if(e.environment===_.EnvironmentName.custom){if((0,k.isEmpty)(e.customEnvironment))throw new Error('customEnvironment must be provided when environment is set to "custom"');return E.SDKVariableStorage.set(p.ChatSDKVariable.ENDPOINT_GATEWAY,null===(t=e.customEnvironment)||void 0===t?void 0:t.gateway),void E.SDKVariableStorage.set(p.ChatSDKVariable.ENDPOINT_CHAT,null===(n=e.customEnvironment)||void 0===n?void 0:n.chat)}var r=(0,_.getEnvironmentEndpoints)(e.environment),o=r.gateway,a=r.chat;E.SDKVariableStorage.set(p.ChatSDKVariable.ENDPOINT_GATEWAY,o),E.SDKVariableStorage.set(p.ChatSDKVariable.ENDPOINT_CHAT,a)},e.prototype._initWS=function(e,t,n){var r=this,o=E.SDKVariableStorage.get(p.ChatSDKVariable.ENDPOINT_GATEWAY);(0,N.assertNonNullable)(o);var i=new URL(o),s={host:i.hostname,port:i.port};this.websocketClient=new A.WebSocketClient(e,t,n,s),this.websocketClient.on(a.WebSocketClientEvent.MESSAGE,(function(e){try{var t=r._incomingChatEventMiddleware.process((0,C.parseWsMessageEvent)(e));if(!(0,k.isNil)(t)){var n=t.type;(0,C.onMessageHandler)(t),r._messageEmitter.dispatchEvent(new CustomEvent(null!=n?n:"",{detail:t}))}}catch(e){r.onErrorHandler(e)}}))},e}();t.ChatSdk=j},1204:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};t.__esModule=!0,t.agentTypingEnded=t.agentTypingStarted=void 0;var o=n(850),a=n(8470);function i(e){return!(0,a.isNil)(null==e?void 0:e.user)}t.agentTypingStarted=function(e){return i(e.data)?r(r({},e),{type:o.ChatEvent.AGENT_TYPING_STARTED}):e},t.agentTypingEnded=function(e){return i(e.data)?r(r({},e),{type:o.ChatEvent.AGENT_TYPING_ENDED}):e}},6042:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};t.__esModule=!0,t.assignedAgentChanged=void 0;var o=n(850);t.assignedAgentChanged=function(e){return r(r({},e),{type:o.ChatEvent.ASSIGNED_AGENT_CHANGED})}},6694:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.createPayloadForAttachmentUpload=void 0;var a=n(7594),i=n(613);t.createPayloadForAttachmentUpload=function(e){return r(void 0,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,(0,i.createLocalFileReader)(e)];case 1:if(null!==(t=n.sent()).error)throw new a.ChatSDKError("Cannot create payload for attachment upload because of error (".concat(t.error.message,")"));if("string"!=typeof t.result)throw new a.ChatSDKError("Cannot create payload for attachment upload because of missing:\n      reader result (".concat(t.result,")"));return[2,{url:t.result,name:e.name,mimeType:e.type}]}}))}))}},613:(e,t)=>{t.__esModule=!0,t.createLocalFileReader=void 0,t.createLocalFileReader=function(e){return new Promise((function(t,n){var r=new FileReader;r.onloadend=function(){t(r)},r.onerror=function(e){var t,r;return n(null===(r=null===(t=e.target)||void 0===t?void 0:t.error)||void 0===r?void 0:r.message)},r.readAsDataURL(e)}))}},6223:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.createAttachmentUploadMessageData=t.createAttachmentPayload=void 0;var a=n(5115),i=n(2970),s=n(7074),u=n(7594),c=n(505),l=n(597),d=n(6694),h=n(7819);t.createAttachmentPayload=function(e,t,n){return r(void 0,void 0,void 0,(function(){var r,a;return o(this,(function(o){switch(o.label){case 0:return[4,(0,d.createPayloadForAttachmentUpload)(e)];case 1:return r=o.sent(),[4,(0,h.uploadAttachment)(t,n,r)];case 2:if(a=o.sent(),(0,h.isUploadSuccessResponse)(a))return[2,{url:a.fileUrl,friendlyName:r.name}];if((0,h.isUploadFailResponse)(a))throw a;throw new u.ChatSDKError("Unknown file upload response (".concat(a,")"))}}))}))},t.createAttachmentUploadMessageData=function(e,n,d){return void 0===d&&(d={}),r(void 0,void 0,void 0,(function(){var f,v,p,_,E,y,g,b,S,T,m;return o(this,(function(C){switch(C.label){case 0:f=(0,l.getBrandIdAndChannelId)(),v=f.brandId,p=f.channelId,C.label=1;case 1:return C.trys.push([1,3,,4]),[4,Promise.all(Array.from(e).map((function(e){return r(void 0,void 0,void 0,(function(){return o(this,(function(n){return[2,(0,t.createAttachmentPayload)(e,v,p)]}))}))})))];case 2:return _=C.sent(),E=d.messageId,y=void 0===E?(0,c.generateId)():E,g=d.browserFingerprint,b=void 0===g?(0,i.getBrowserFingerprint)():g,S=d.threadCustomFields,T=void 0===S?{}:S,[2,{messageContent:{type:a.MessageType.TEXT,payload:{text:""}},attachments:_,browserFingerprint:b,thread:{idOnExternalPlatform:n},idOnExternalPlatform:y,consumer:{customFields:[]},consumerContact:{customFields:(0,s.convertCustomFields)(T)}}];case 3:if(m=C.sent(),(0,h.isUploadFailResponse)(m))throw m;if(m instanceof Error)throw new u.ChatSDKError("Send attachment failed because of (".concat(m.message,")"));throw new u.ChatSDKError("Unknown error during file upload");case 4:return[2]}}))}))}},7819:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.uploadAttachment=t.isUploadFailResponse=t.isUploadSuccessResponse=void 0;var a=n(7214),i=n(80),s=n(7594),u=n(8470);t.isUploadSuccessResponse=function(e){return!1===(0,u.isUndefined)(null==e?void 0:e.fileUrl)},t.isUploadFailResponse=function(e){return!1===(0,u.isUndefined)(null==e?void 0:e.allowedFileSize)},t.uploadAttachment=function(e,t,n){return r(this,void 0,void 0,(function(){var r,u,c,l,d,h,f;return o(this,(function(o){switch(o.label){case 0:return r=i.SDKVariableStorage.get(a.ChatSDKVariable.ENDPOINT_CHAT),u=n.url,c=n.name,l=n.mimeType,d=u.split(";base64,")[1],h={content:d,fileName:c,mimeType:l},[4,fetch("".concat(r,"/chat/1.0/brand/").concat(e,"/channel/").concat(t,"/attachment"),{method:"POST",body:JSON.stringify(h),headers:{"Content-Type":"application/json"}})];case 1:if(!(f=o.sent()).ok)throw new s.ChatSDKError("Failed to upload Attachments. Status (".concat(f.status,")"));return[2,f.json()]}}))}))}},3542:(e,t,n)=>{t.__esModule=!0,t.getAccessToken=t.setAccessToken=void 0;var r=n(7214),o=n(80),a=n(8470);t.setAccessToken=function(e){o.SDKVariableStorage.set(r.ChatSDKVariable.ACCESS_TOKEN,e.token),o.SDKVariableStorage.set(r.ChatSDKVariable.ACCESS_TOKEN_EXPIRES_IN,String(e.expiresIn))},t.getAccessToken=function(){var e=o.SDKVariableStorage.get(r.ChatSDKVariable.ACCESS_TOKEN,null),t=o.SDKVariableStorage.get(r.ChatSDKVariable.ACCESS_TOKEN_EXPIRES_IN,null);return(0,a.isNull)(e)||(0,a.isNull)(t)?null:{token:e,expiresIn:Number(t)}}},1553:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};t.__esModule=!0,t.createAuthorizationPayloadData=void 0;var o=n(8154),a=n(505),i=n(4159);t.createAuthorizationPayloadData=function(e,t){return void 0===t&&(t=(0,a.generateId)()),r({eventType:o.AwsInputEventType.AUTHORIZE_CONSUMER,data:{authorization:{authorizationCode:e}}},(0,i.createVisitorPayload)(t))}},9716:(e,t,n)=>{t.__esModule=!0,t.createRefreshTokenPayload=void 0;var r=n(8154);t.createRefreshTokenPayload=function(e){return{eventType:r.AwsInputEventType.REFRESH_TOKEN,data:{accessToken:{token:e}}}}},2080:(e,t)=>{t.__esModule=!0,t.handleRefreshToken=t.getIdealTimeInSecondsForIssueRefreshToken=void 0;var n=null;function r(e){var t=Math.round(.9*e);return t<20?20:t}t.getIdealTimeInSecondsForIssueRefreshToken=r,t.handleRefreshToken=function(e,t){null!==n&&clearTimeout(n),n=setTimeout(t,1e3*r(e.expiresIn))}},7084:(e,t,n)=>{t.__esModule=!0,t.isAuthSuccessEvent=void 0;var r=n(8154);t.isAuthSuccessEvent=function(e){var t=e,n=t.data,o=(void 0===n?{}:n).status;return t.type===r.AwsResponseEventType.CONSUMER_AUTHORIZED&&"success"===o}},8493:(e,t,n)=>{t.__esModule=!0,t.isTokenRefreshedSuccessResponse=void 0;var r=n(8154);t.isTokenRefreshedSuccessResponse=function(e){var t,n;return(null==e?void 0:e.type)===r.AwsResponseEventType.TOKEN_REFRESHED&&void 0!==(null===(n=null===(t=e.data)||void 0===t?void 0:t.accessToken)||void 0===n?void 0:n.token)}},2970:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.getBrowserFingerprint=t.getDeviceType=t.getBrowserLocation=t.getBrowserLanguage=void 0;var o=r(n(2007)),a=n(3058);function i(e){switch(e){case"mobile":return a.DeviceType.MOBILE;case"tablet":return a.DeviceType.TABLET;default:return a.DeviceType.DESKTOP}}t.getBrowserLanguage=function(){return navigator.language},t.getBrowserLocation=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},t.getDeviceType=i,t.getBrowserFingerprint=function(e){var n,r,s,u;void 0===e&&(e={});var c=new o.default(navigator.userAgent),l=e.country,d=void 0===l?"":l,h=e.location,f=void 0===h?(0,t.getBrowserLocation)():h,v=e.language,p=void 0===v?(0,t.getBrowserLanguage)():v,_=e.ip,E=void 0===_?null:_;return{browser:null!==(n=c.getBrowser().name)&&void 0!==n?n:null,browserVersion:null!==(r=c.getBrowser().version)&&void 0!==r?r:null,country:d,ip:E,language:p,location:f,os:null!==(s=c.getOS().name)&&void 0!==s?s:null,osVersion:null!==(u=c.getOS().version)&&void 0!==u?u:null,deviceType:i(c.getDevice().type),applicationType:a.ApplicationType.BROWSER}}},6380:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]});t.__esModule=!0,t.isContactCreatedEvent=t.isContactStatusChangedEvent=void 0,r(t,n(5791),"isContactStatusChangedEvent"),r(t,n(2477),"isContactCreatedEvent")},2477:(e,t,n)=>{t.__esModule=!0,t.isContactCreatedEvent=void 0;var r=n(9403);t.isContactCreatedEvent=function(e){var t,n;return e.type===r.PushUpdateEventType.CASE_CREATED&&void 0!==(null===(n=null===(t=e.data)||void 0===t?void 0:t.case)||void 0===n?void 0:n.id)}},5791:(e,t,n)=>{t.__esModule=!0,t.isContactStatusChangedEvent=void 0;var r=n(9403);t.isContactStatusChangedEvent=function(e){var t,n;return e.type===r.PushUpdateEventType.CASE_STATUS_CHANGED&&void 0!==(null===(n=null===(t=e.data)||void 0===t?void 0:t.case)||void 0===n?void 0:n.status)}},3462:(e,t,n)=>{t.__esModule=!0,t.isContactStatusChangedEvent=void 0;var r=n(9403);t.isContactStatusChangedEvent=function(e){var t,n;return e.type===r.PushUpdateEventType.CASE_STATUS_CHANGED&&void 0!==(null===(n=null===(t=e.data)||void 0===t?void 0:t.case)||void 0===n?void 0:n.id)}},7074:(e,t)=>{t.__esModule=!0,t.convertCustomFields=void 0,t.convertCustomFields=function(e){return Object.entries(e).map((function(e){return{ident:e[0],value:e[1]}}))}},8245:function(e,t,n){var r=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};t.__esModule=!0,t.mergeCustomFields=void 0;var o=n(8828),a=n(7074);t.mergeCustomFields=function(e,t){var n=(0,a.convertCustomFields)(e);return(0,o.uniqBy)(r(r([],t,!0),n,!0),"ident")}},1053:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.Customer=void 0;var a=n(7214),i=n(80),s=n(7594),u=n(1187),c=n(505),l=n(8470),d=n(4342),h=function(){function e(t,n,r){this.websocketClient=r,e.setId(t),e.setName(n)}return e.setId=function(e){i.SDKVariableStorage.set(a.ChatSDKVariable.CUSTOMER_ID,e)},e.getId=function(){return i.SDKVariableStorage.get(a.ChatSDKVariable.CUSTOMER_ID,null)},e.getName=function(){return i.SDKVariableStorage.get(a.ChatSDKVariable.CUSTOMER_NAME)},e.setName=function(e){i.SDKVariableStorage.set(a.ChatSDKVariable.CUSTOMER_NAME,e)},e.getIdOrCreateNewOne=function(){var e=this.getId();return e||(e=(0,c.generateId)(),this.setId(e)),e},e.prototype.getId=function(){return e.getIdOrCreateNewOne()},e.prototype.getName=function(){return e.getName()},e.prototype.setName=function(t){e.setName(t)},e.prototype.setCustomFields=function(e){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){if((0,l.isUndefined)(e))throw new s.ChatSDKError("Custom fields must be set");return t=(0,d.createSetCustomerCustomFieldsPayloadData)(e),[2,(0,u.sendChatEvent)(t,this.websocketClient)]}))}))},e.prototype.setCustomField=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){if((0,l.isUndefined)(e)||(0,l.isUndefined)(t))throw new s.ChatSDKError("Custom field name and value must be set");return[2,this.setCustomFields((n={},n[e]=t,n))]}))}))},e}();t.Customer=h},9662:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};t.__esModule=!0,t.createCustomerIdentityPayload=void 0;var o=n(8839),a=n(1053);t.createCustomerIdentityPayload=function(e){var t=null!=e?e:a.Customer.getName(),n={};if("string"==typeof t&&t.length>0){var i=(0,o.splitName)(t);n={firstName:i[0],lastName:i[1]}}return r({idOnExternalPlatform:a.Customer.getIdOrCreateNewOne()},n)}},4342:(e,t,n)=>{t.__esModule=!0,t.createSetCustomerCustomFieldsPayloadData=void 0;var r=n(8154),o=n(7074);t.createSetCustomerCustomFieldsPayloadData=function(e){return{eventType:r.AwsInputEventType.SEND_CONSUMER_CUSTOM_FIELDS,data:{customFields:(0,o.convertCustomFields)(e)}}}},7214:(e,t)=>{var n;t.__esModule=!0,t.ChatSDKVariable=void 0,(n=t.ChatSDKVariable||(t.ChatSDKVariable={})).ACCESS_TOKEN="ACCESS_TOKEN",n.ACCESS_TOKEN_EXPIRES_IN="ACCESS_TOKEN_EXPIRES_IN",n.AUTHORIZATION_CODE="AUTHORIZATION_CODE",n.BRAND_ID="BRAND_ID",n.CHANNEL_ID="CHANNEL_ID",n.CHAT_SDK_WEBSOCKET_PREFIX="CHAT_SDK_WEBSOCKET_PREFIX",n.CUSTOMER_ID="CUSTOMER_ID",n.CUSTOMER_NAME="CUSTOMER_NAME",n.ENDPOINT_CHAT="ENDPOINT_CHAT",n.ENDPOINT_GATEWAY="ENDPOINT_GATEWAY",n.THREAD_DATA="THREAD_DATA"},1422:(e,t)=>{var n;t.__esModule=!0,t.getEnvironmentEndpoints=t.EnvironmentName=void 0,function(e){e.AU1="AU1",e.CA1="CA1",e.EU1="EU1",e.JP1="JP1",e.NA1="NA1",e.UK1="UK1",e.custom="custom"}(n=t.EnvironmentName||(t.EnvironmentName={})),t.getEnvironmentEndpoints=function(e){var t="{ENV}",r="https://channels-de-".concat(t,".niceincontact.com/chat"),o="wss://chat-gateway-de-".concat(t,".niceincontact.com");switch(e){case n.AU1:return{chat:r.replace(t,"au1"),name:"Australia",gateway:o.replace(t,"au1")};case n.CA1:return{chat:r.replace(t,"ca1"),name:"Canada",gateway:o.replace(t,"ca1")};case n.EU1:return{chat:r.replace(t,"eu1"),name:"Europe",gateway:o.replace(t,"eu1")};case n.JP1:return{chat:r.replace(t,"jp1"),name:"Japan",gateway:o.replace(t,"jp1")};case n.NA1:return{chat:r.replace(t,"na1"),name:"North America",gateway:o.replace(t,"na1")};case n.UK1:return{chat:r.replace(t,"uk1"),name:"United Kingdom",gateway:o.replace(t,"uk1")};case n.custom:return{chat:"",name:"Custom",gateway:""};default:throw new Error("Unknown environment: ".concat(e))}}},80:(e,t)=>{t.__esModule=!0,t.SDKVariableStorage=void 0;var n=function(){function e(){this._vars={}}return e.prototype.set=function(e,t){this._vars[e]=t},e.prototype.get=function(e,t){var n;return null!==(n=this._vars[e])&&void 0!==n?n:t},e.prototype.list=function(){return Object.keys(this._vars)},e.prototype.clear=function(){this._vars={}},e}();t.SDKVariableStorage=new n},4110:(e,t)=>{t.__esModule=!0,t.CHAT_SDK_VERSION=void 0,t.CHAT_SDK_VERSION="0"},7594:function(e,t){var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.__esModule=!0,t.ChatSDKError=void 0;var o=function(e){function t(t){var n=this,r=t instanceof Error?t.message:"Unknown error (".concat(t,")");return(n=e.call(this,"[ChatSDKError]: ".concat(r))||this).name="ChatSDKError",n}return r(t,e),t}(Error);t.ChatSDKError=o},850:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};t.__esModule=!0,t.ChatEvent=void 0;var o=n(8154),a=n(9403);t.ChatEvent=r(r(r({},a.PushUpdateEventType),o.AwsResponseEventType),{AGENT_TYPING_STARTED:"AgentTypingStarted",AGENT_TYPING_ENDED:"AgentTypingEnded",ASSIGNED_AGENT_CHANGED:"AssignedAgentChanged"})},1485:(e,t)=>{t.__esModule=!0,t.ChatEventMiddleware=void 0;var n=function(){function e(){this.middlewares=[]}return e.prototype.register=function(e){this.middlewares.push(e)},e.prototype.process=function(e){if(void 0===e)return null;for(var t=e,n=0,r=this.middlewares;n<r.length;n++){var o=r[n];if(null===t)return null;t=o(t)}return t},e}();t.ChatEventMiddleware=n},3858:(e,t)=>{t.__esModule=!0,t.ChatEventTarget=void 0,t.ChatEventTarget=EventTarget},374:(e,t,n)=>{var r;t.__esModule=!0,t.chatEventMapper=void 0;var o=n(1204),a=n(6042),i=n(850),s=((r={})[i.ChatEvent.SENDER_TYPING_STARTED]=o.agentTypingStarted,r[i.ChatEvent.SENDER_TYPING_ENDED]=o.agentTypingEnded,r[i.ChatEvent.CASE_INBOX_ASSIGNEE_CHANGED]=a.assignedAgentChanged,r);t.chatEventMapper=function(e){return e.type&&void 0!==s[e.type]?s[e.type](e):e}},817:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};t.__esModule=!0,t.normalizeEvent=void 0;var a=n(8470),i={id:"",data:null,type:void 0};t.normalizeEvent=function(e){if(!function(e){return"eventId"in e}(e))return i;if(function(e){return"error"in e}(e))return{error:e.error,id:e.eventId,data:null};var t,n,s=function(e){return"eventType"in e}(e)?e.eventType:void 0;if(function(e){return"data"in e}(e))return{id:e.eventId,data:e.data,type:s};if(n=null==(t=e)?void 0:t.postback,!1===(0,a.isEmpty)(n)){var u=e.postback,c=u.data,l=u.eventType,d=e.eventId,h=o(e,["postback","eventId"]);return{type:l,data:r(r({},h),c),id:d}}var f=e.eventId,v=o(e,["eventId"]);return r(r({data:void 0},v),{id:f,type:s})}},1187:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.sendChatEvent=void 0;var a=n(2968),i=n(7722);t.sendChatEvent=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){return n=(0,i.createEvent)((0,i.createEventPayload)(e)),[2,(0,a.makeRequest)(n,t)]}))}))}},3607:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};t.__esModule=!0,t.splitName=t.generateId=t.EnvironmentName=t.ChatEvent=t.WebSocketClientEvent=t.MessageType=void 0;var a=n(4084),i=n(5115);r(t,i,"MessageType");var s=n(4853);r(t,s,"WebSocketClientEvent");var u=n(850);r(t,u,"ChatEvent");var c=n(1422);r(t,c,"EnvironmentName"),o(n(9544),t),o(n(6380),t),o(n(4084),t),o(n(9800),t),o(n(1466),t);var l=n(505);r(t,l,"generateId");var d=n(8839);r(t,d,"splitName"),t.default=a.ChatSdk},9800:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]});t.__esModule=!0,t.isMessageCreatedEvent=t.isMessage=t.getAuthor=void 0,r(t,n(6807),"getAuthor"),r(t,n(825),"isMessage"),r(t,n(1144),"isMessageCreatedEvent")},2819:(e,t,n)=>{t.__esModule=!0,t.isSendMessageSuccessEventData=void 0;var r=n(8470);t.isSendMessageSuccessEventData=function(e){var t=!1===(0,r.isUndefined)(null==e?void 0:e.id);return!1==(!1===(0,r.isUndefined)(e.error))&&t}},2666:(e,t,n)=>{t.__esModule=!0,t.createTextMessageData=void 0;var r=n(5115),o=n(2970);t.createTextMessageData=function(e,t,n,a,i,s){return void 0===a&&(a=[]),void 0===i&&(i=[]),void 0===s&&(s=(0,o.getBrowserFingerprint)()),{messageContent:{payload:{text:e},type:r.MessageType.TEXT},browserFingerprint:s,idOnExternalPlatform:t,thread:{idOnExternalPlatform:n},consumer:{customFields:i},consumerContact:{customFields:a},attachments:[]}}},6807:(e,t,n)=>{t.__esModule=!0,t.getAuthor=void 0;var r=n(6510);t.getAuthor=function(e){var t,n,o,a,i,s;return e.direction===r.MessageDirection.INBOUND?null!==(n=null===(t=e.authorEndUserIdentity)||void 0===t?void 0:t.fullName)&&void 0!==n?n:"":"".concat(null!==(a=null===(o=e.authorUser)||void 0===o?void 0:o.firstName)&&void 0!==a?a:""," ").concat(null!==(s=null===(i=e.authorUser)||void 0===i?void 0:i.surname)&&void 0!==s?s:"").trim()}},825:(e,t,n)=>{t.__esModule=!0,t.isMessage=void 0;var r=n(8470);t.isMessage=function(e){var t=!1===(0,r.isUndefined)(e.id),n=!1===(0,r.isUndefined)(e.direction),o=!1===(0,r.isUndefined)(e.messageContent);return t&&n&&o}},1144:(e,t,n)=>{t.__esModule=!0,t.isMessageCreatedEvent=void 0;var r=n(9403);t.isMessageCreatedEvent=function(e){return e.type===r.PushUpdateEventType.MESSAGE_CREATED}},39:(e,t,n)=>{t.__esModule=!0,t.isLoadMoreMessagesEventData=void 0;var r=n(8154);t.isLoadMoreMessagesEventData=function(e){var t;return e.type===r.AwsResponseEventType.MORE_MESSAGES_LOADED&&void 0!==(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.messages)}},3584:(e,t,n)=>{t.__esModule=!0,t.createLoadMoreMessagesPayloadData=void 0;var r=n(8154);t.createLoadMoreMessagesPayloadData=function(e){return{eventType:r.AwsInputEventType.LOAD_MORE_MESSAGES,data:e}}},6629:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.sendMessage=void 0;var a=n(1187),i=n(2819),s=n(8995);t.sendMessage=function(e,t){return r(void 0,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return n=(0,s.createSendMessagePayloadData)(e),[4,(0,a.sendChatEvent)(n,t)];case 1:if(r=o.sent(),(0,i.isSendMessageSuccessEventData)(r))return[2,r];throw r}}))}))}},8995:(e,t,n)=>{t.__esModule=!0,t.createSendMessagePayloadData=void 0;var r=n(8154);t.createSendMessagePayloadData=function(e){return{eventType:r.AwsInputEventType.SEND_MESSAGE,data:e}}},6127:(e,t,n)=>{t.__esModule=!0,t.createSendMessagePreviewPayloadData=void 0;var r=n(8154),o=n(5115);t.createSendMessagePreviewPayloadData=function(e,t){return{eventType:r.AwsInputEventType.SEND_MESSAGE_PREVIEW,data:{thread:{idOnExternalPlatform:e},messageContent:{payload:{text:t},type:o.MessageType.TEXT}}}}},2968:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.makeRequest=void 0;var a=n(7594),i=n(505),s=n(8470),u=n(8762);t.makeRequest=function(e,t){return r(void 0,void 0,void 0,(function(){return o(this,(function(n){if((0,s.isNull)(t))throw new a.ChatSDKError("WebSocketClient is not initialized");return(0,s.isEmpty)(e.eventId)&&(e.eventId=(0,i.generateId)()),[2,new Promise((function(n){u.requestQueue.set(e.eventId,n),null==t||t.send(e)}))]}))}))}},2046:(e,t,n)=>{t.__esModule=!0,t.onMessageHandler=t.parseWsMessageEvent=void 0;var r=n(817),o=n(8762);t.parseWsMessageEvent=function(e){var t=null==e?void 0:e.detail;if(t){var n;try{n=JSON.parse(t.data)}catch(e){return}return(0,r.normalizeEvent)(n)}},t.onMessageHandler=function(e){var t=e.id;if(o.requestQueue.has(t)){var n=o.requestQueue.get(t);"function"==typeof n&&n(e),o.requestQueue.delete(t)}}},8762:(e,t)=>{t.__esModule=!0,t.requestQueue=void 0,t.requestQueue=new Map},7722:(e,t,n)=>{t.__esModule=!0,t.createEvent=t.createEventPayload=void 0;var r=n(3441),o=n(9662),a=n(7594),i=n(505),s=n(597),u=n(8470);t.createEventPayload=function(e){var t=e.eventType,n=e.data,r=e.consumerIdentity,i=void 0===r?(0,o.createCustomerIdentityPayload)():r,c=e.destination,l=void 0===c?{}:c,d=e.visitor,h=void 0===d?{}:d,f=(0,s.getBrandIdAndChannelId)(),v=f.brandId,p=f.channelId;if((0,u.isUndefined)(t))throw new a.ChatSDKError("Cannot create an event payload because of missing eventType (".concat(t,")"));return{eventType:t,brand:{id:Number(v)},channel:{id:p},consumerIdentity:i,data:n,destination:l,visitor:h}},t.createEvent=function(e,t,n){return void 0===t&&(t=(0,i.generateId)()),void 0===n&&(n=r.AwsChatWindowEventActionRoute.CHAT_WINDOW_EVENT),{action:n,eventId:t,payload:e}}},4853:(e,t,n)=>{t.__esModule=!0,t.WebSocketClient=t.WebSocketClientEvent=void 0;var r=n(3893),o=n(6455),a=n(5415),i=n(7214),s=n(80),u=n(4110),c=n(2326);t.WebSocketClientEvent=o.WebSocketClientEvent;var l=function(){function e(e,t,n,r){this.brandId=e,this.channelId=t,this.customerId=n,this.options=r,this._connection=null,this.connect()}return e.prototype.connect=function(){var e,n,o,c,l,d,h,f,v,p,_,E,y,g,b=(null===(e=this.options)||void 0===e?void 0:e.port)?":".concat(null===(n=this.options)||void 0===n?void 0:n.port):"",S=(f=(null===(o=this.options)||void 0===o?void 0:o.host)?"".concat(null===(c=this.options)||void 0===c?void 0:c.host).concat(b):"",v=this.brandId,p=this.channelId,_=this.customerId,E={brandId:v,channelId:p,consumerId:_,v:u.CHAT_SDK_VERSION},y=(0,r.createQueryParametersAsString)(E),g=s.SDKVariableStorage.get(i.ChatSDKVariable.CHAT_SDK_WEBSOCKET_PREFIX,""),"".concat(f,"/").concat(g,"?").concat(y));this._connection=(0,a.setupSocketConnection)(S,{startClosed:!0,forceSecureProtocol:!0}),null===(l=this._connection)||void 0===l||l.addEventListener(t.WebSocketClientEvent.CLOSE,this._errorHandler),null===(h=null===(d=this._connection)||void 0===d?void 0:d.socket)||void 0===h||h.reconnect()},e.prototype.disconnect=function(){var e;null===(e=this._connection)||void 0===e||e.socket.close()},e.prototype.reconnect=function(){var e;null===(e=this._connection)||void 0===e||e.socket.reconnect()},e.prototype.send=function(e){var t,n=JSON.stringify(e);null===(t=this._connection)||void 0===t||t.send(n)},e.prototype.on=function(e,t){var n;null===(n=this._connection)||void 0===n||n.addEventListener(e,t)},e.prototype.off=function(e,t){var n;null===(n=this._connection)||void 0===n||n.removeEventListener(e,t)},e.prototype._errorHandler=function(e,t){throw new c.WebSocketClientError(e,null==t?void 0:t.reason)},e}();t.WebSocketClient=l},2326:function(e,t){var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});t.__esModule=!0,t.WebSocketClientError=void 0;var o=function(e){function t(t,n){void 0===n&&(n="");var r=this,o=n?" (".concat(n,")"):"";return(r=e.call(this,"[WebSocketClientError]: ".concat(t).concat(o))||this).name="WebSocketClientError",r}return r(t,e),t}(Error);t.WebSocketClientError=o},9808:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}u((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.Thread=void 0;var i=n(6223),s=n(3542),u=n(2970),c=n(7074),l=n(8245),d=n(7214),h=n(80),f=n(7594),v=n(850),p=n(1187),_=n(2666),E=n(39),y=n(3584),g=n(6629),b=n(6127),S=n(505),T=n(8470),m=n(7482),C=n(9871),w=n(335),A=n(2885),O=n(9925),D=n(841),I=n(2251),P=n(2106),N=n(4008),M=n(9186),R=n(6028),k=function(){function e(e,t,n,r){void 0===r&&(r=!1),this._exists=!1,this._typingTimeoutID=void 0,this._threadCustomFieldsQueue={},this._isAuthorizationEnabled=!1,this.idOnExternalPlatform=e,this._websocketClient=t,this._messageEmitter=n,this._isAuthorizationEnabled=r,this._registerEventHandlers()}return e.prototype.recover=function(){return o(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return[4,(0,p.sendChatEvent)((0,I.createRecoverThreadPayloadData)(this.idOnExternalPlatform),this._websocketClient)];case 1:if(e=t.sent(),(0,w.isRecoverSuccessPayload)(e))return[2,e.data];throw e}}))}))},e.prototype.sendMessage=function(e){var t,n;return o(this,void 0,void 0,(function(){var o,i,u,c,d;return a(this,(function(a){switch(a.label){case 0:return o=(0,l.mergeCustomFields)(this._threadCustomFieldsQueue,null!==(t=e.consumerContact.customFields)&&void 0!==t?t:[]),i=null!==(n=this._isAuthorizationEnabled&&(0,s.getAccessToken)())&&void 0!==n&&n,u=!1!==i?{accessToken:{token:i.token}}:{},c=r(r(r({},e),u),{consumerContact:{customFields:o}}),[4,(0,g.sendMessage)(c,this._websocketClient)];case 1:return d=a.sent(),this._threadCustomFieldsQueue={},[2,d]}}))}))},e.prototype.sendTextMessage=function(e,t){return void 0===t&&(t={}),o(this,void 0,void 0,(function(){var n,r,o,i,s,l,d,h;return a(this,(function(a){return n=t.messageId,r=void 0===n?(0,S.generateId)():n,o=t.browserFingerprint,i=void 0===o?(0,u.getBrowserFingerprint)():o,s=t.threadCustomFields,l=void 0===s?{}:s,d=(0,c.convertCustomFields)(l),h=(0,_.createTextMessageData)(e,r,this.idOnExternalPlatform,d,[],i),[2,this.sendMessage(h)]}))}))},e.prototype.loadMoreMessages=function(){var e;return o(this,void 0,void 0,(function(){var t,n,r,o,i;return a(this,(function(a){switch(a.label){case 0:return t=null!==(e=JSON.parse(h.SDKVariableStorage.get(d.ChatSDKVariable.THREAD_DATA,"{}")))&&void 0!==e?e:{},n=t.scrollToken,r=t.oldestMessageDatetime,(0,T.isEmpty)(n)?[2,null]:(o={scrollToken:n,oldestMessageDatetime:r,thread:{idOnExternalPlatform:this.idOnExternalPlatform}},[4,(0,p.sendChatEvent)((0,y.createLoadMoreMessagesPayloadData)(o),this._websocketClient)]);case 1:if(i=a.sent(),(0,E.isLoadMoreMessagesEventData)(i))return[2,i];throw i}}))}))},e.prototype.lastMessageSeen=function(){return o(this,void 0,void 0,(function(){var e;return a(this,(function(t){return e=(0,O.createLastMessageSeenPayloadData)(this.idOnExternalPlatform),[2,(0,p.sendChatEvent)(e,this._websocketClient)]}))}))},e.prototype.sendAttachments=function(e,t){return void 0===t&&(t={}),o(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:if((0,T.isUndefined)(e)||0===e.length)throw new f.ChatSDKError("FileList must be provided to sendAttachment method");return[4,(0,i.createAttachmentUploadMessageData)(e,this.idOnExternalPlatform,t)];case 1:return n=r.sent(),[2,this.sendMessage(n)]}}))}))},e.prototype.keystroke=function(e){var t=this;void 0===e&&(e=1e3),this._typingTimeoutID||(0,p.sendChatEvent)((0,M.createStartTypingEventPayloadData)(this.idOnExternalPlatform),this._websocketClient),clearTimeout(this._typingTimeoutID),this._typingTimeoutID=setTimeout((function(){(0,p.sendChatEvent)((0,M.createStopTypingEventPayloadData)(t.idOnExternalPlatform),t._websocketClient)}),e)},e.prototype.stopTyping=function(){clearTimeout(this._typingTimeoutID),this._typingTimeoutID=void 0,(0,p.sendChatEvent)((0,M.createStopTypingEventPayloadData)(this.idOnExternalPlatform),this._websocketClient)},e.prototype.getMetadata=function(){return o(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return[4,(0,p.sendChatEvent)((0,D.createLoadThreadMetadataEventPayloadData)(this.idOnExternalPlatform),this._websocketClient)];case 1:if(e=t.sent(),(0,C.isLoadMetadataSuccessPayload)(e))return[2,e];throw e}}))}))},e.prototype.onThreadEvent=function(e,t){var n=this,r=(0,N.filterCurrentThreadEventHandler)(this.idOnExternalPlatform,t);return this._messageEmitter.addEventListener(e,r),function(){n._messageEmitter.removeEventListener(e,r)}},e.prototype.setCustomFields=function(e){return o(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return this._threadCustomFieldsQueue=r(r({},this._threadCustomFieldsQueue),e),!1===this._exists?[2]:(t=(0,P.createSetThreadCustomFieldsPayloadData)(this._threadCustomFieldsQueue,this.idOnExternalPlatform),[4,(0,p.sendChatEvent)(t,this._websocketClient)]);case 1:return n.sent(),this._threadCustomFieldsQueue={},[2]}}))}))},e.prototype.setCustomField=function(e,t){var n;return this.setCustomFields(((n={})[e]=t,n))},e.prototype.archive=function(){return o(this,void 0,void 0,(function(){var e;return a(this,(function(t){switch(t.label){case 0:return[4,(0,p.sendChatEvent)((0,m.createArchiveThreadEventPayloadData)(this.idOnExternalPlatform),this._websocketClient)];case 1:if(e=t.sent(),(0,A.isThreadArchivedSuccessPayload)(e))return[2,!0];throw e}}))}))},e.prototype.setName=function(e){return o(this,void 0,void 0,(function(){var t,n;return a(this,(function(r){switch(r.label){case 0:return t=(0,R.createUpdateThreadPayloadData)(this.idOnExternalPlatform,e),[4,(0,p.sendChatEvent)(t,this._websocketClient)];case 1:if(n=r.sent(),(0,R.isUpdateThreadSuccess)(n))return[2,!0];throw n}}))}))},e.prototype._registerEventHandlers=function(){var e=this;this.onThreadEvent(v.ChatEvent.CASE_CREATED,(function(){return e._exists=!0})),this.onThreadEvent(v.ChatEvent.THREAD_RECOVERED,(function(){return e._exists=!0}))},e.prototype.sendMessagePreview=function(e){return o(this,void 0,void 0,(function(){var t;return a(this,(function(n){switch(n.label){case 0:return t=(0,b.createSendMessagePreviewPayloadData)(this.idOnExternalPlatform,e),[4,(0,p.sendChatEvent)(t,this._websocketClient)];case 1:return n.sent(),[2]}}))}))},e}();t.Thread=k},7482:(e,t,n)=>{t.__esModule=!0,t.createArchiveThreadEventPayloadData=void 0;var r=n(8154);t.createArchiveThreadEventPayloadData=function(e){return{eventType:r.AwsInputEventType.ARCHIVE_THREAD,data:{thread:{idOnExternalPlatform:e}}}}},9544:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};t.__esModule=!0,o(n(9808),t),o(n(9840),t)},9871:(e,t,n)=>{t.__esModule=!0,t.isLoadMetadataSuccessPayload=void 0;var r=n(8154);t.isLoadMetadataSuccessPayload=function(e){return e.type===r.AwsResponseEventType.THREAD_METADATA_LOADED&&void 0!==e.data.lastMessage}},335:(e,t,n)=>{t.__esModule=!0,t.isRecoverSuccessPayload=void 0;var r=n(8154),o=n(8470);t.isRecoverSuccessPayload=function(e){var t=e.data,n=!1===(0,o.isUndefined)(t),a=!1===(0,o.isUndefined)(null==t?void 0:t.messages),i=e.type===r.AwsResponseEventType.THREAD_RECOVERED||e.type===r.AwsResponseEventType.LIVECHAT_RECOVERED,s=(0,o.isUndefined)(e.error);return n&&a&&s&&i}},2885:(e,t,n)=>{t.__esModule=!0,t.isThreadArchivedSuccessPayload=void 0;var r=n(8154);t.isThreadArchivedSuccessPayload=function(e){return e.type===r.AwsResponseEventType.THREAD_ARCHIVED}},3550:(e,t)=>{t.__esModule=!0,t.isThreadListFetchedPostbackData=void 0,t.isThreadListFetchedPostbackData=function(e){return"threads"in e}},9925:(e,t,n)=>{t.__esModule=!0,t.createLastMessageSeenPayloadData=void 0;var r=n(8154);t.createLastMessageSeenPayloadData=function(e){return{eventType:r.AwsInputEventType.MESSAGE_SEEN,data:{thread:{idOnExternalPlatform:e}}}}},9840:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};t.__esModule=!0,t.LivechatThread=void 0;var s=n(9256),u=n(3462),c=n(7214),l=n(80),d=n(7594),h=n(850),f=n(1187),v=n(8470),p=n(335),_=n(9808),E=n(5707),y=n(3338),g=function(e){function t(t,n,r,o){void 0===o&&(o=!1);var a=e.call(this,t,n,r,o)||this;return a._isInitialized=!1,a._canSendMessage=!0,a._registerLivechatEventHandlers(),a}return o(t,e),t.prototype.recover=function(){return a(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return[4,(0,f.sendChatEvent)((0,y.createRecoverLivechatThreadPayloadData)(this.idOnExternalPlatform),this._websocketClient)];case 1:if(e=t.sent(),(0,p.isRecoverSuccessPayload)(e))return[2,e.data];throw e}}))}))},t.prototype.sendMessage=function(t){return a(this,void 0,void 0,(function(){return i(this,(function(n){if(!1===this._canSendMessage)throw new d.ChatSDKError("Cannot send more messages to closed Contact");return[2,e.prototype.sendMessage.call(this,t)]}))}))},t.prototype.startChat=function(e){return void 0===e&&(e="Begin conversation"),a(this,void 0,void 0,(function(){var t,n;return i(this,(function(r){switch(r.label){case 0:if(this._isInitialized)throw new d.ChatSDKError("Chat is already initialized");r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.sendTextMessage(e)];case 2:return t=r.sent(),this._isInitialized=!0,[2,t];case 3:if((n=r.sent())instanceof Error)throw new d.ChatSDKError("Sending initial message failed because of (".concat(n.message,")"));return[2];case 4:return[2]}}))}))},t.prototype.endChat=function(){return a(this,void 0,void 0,(function(){var e,t,n;return i(this,(function(r){switch(r.label){case 0:if(e=l.SDKVariableStorage.get(c.ChatSDKVariable.THREAD_DATA,"{}"),t=JSON.parse(e),n=null==t?void 0:t.contactId,(0,v.isUndefined)(n))throw new d.ChatSDKError("Cannot end Chat because of missing ContactId in the storage");return[4,(0,f.sendChatEvent)((0,E.createEndThreadPayloadData)(this.idOnExternalPlatform,n),this._websocketClient)];case 1:return r.sent(),[2]}}))}))},t.prototype._registerLivechatEventHandlers=function(){var e=this;this.onThreadEvent(h.ChatEvent.CASE_STATUS_CHANGED,(function(t){(0,u.isContactStatusChangedEvent)(t.detail)&&t.detail.data.case.status===s.CaseStatus.CLOSED&&(e._canSendMessage=!1)})),this.onThreadEvent(h.ChatEvent.THREAD_RECOVERED,(function(t){(0,p.isRecoverSuccessPayload)(t.detail)&&t.detail.data.consumerContact.status===s.CaseStatus.CLOSED&&(e._canSendMessage=!1)}))},t}(_.Thread);t.LivechatThread=g},5707:(e,t,n)=>{t.__esModule=!0,t.createEndThreadPayloadData=void 0;var r=n(8154);t.createEndThreadPayloadData=function(e,t){return{eventType:r.AwsInputEventType.END_CONTACT,data:{thread:{idOnExternalPlatform:e},contact:{id:t}}}}},3290:(e,t,n)=>{t.__esModule=!0,t.isSetPositionInQueuePayload=void 0;var r=n(8154),o=n(8470);t.isSetPositionInQueuePayload=function(e){var t=e;return Number.isInteger(null==t?void 0:t.data.positionInQueue)&&!1===(0,o.isEmpty)(null==t?void 0:t.eventId)&&(null==t?void 0:t.eventType)===r.AwsResponseEventType.SET_POSITION_IN_QUEUE}},3338:(e,t,n)=>{t.__esModule=!0,t.createRecoverLivechatThreadPayloadData=void 0;var r=n(8154);t.createRecoverLivechatThreadPayloadData=function(e){return{eventType:r.AwsInputEventType.RECOVER_LIVECHAT,data:{thread:{idOnExternalPlatform:e}}}}},841:(e,t,n)=>{t.__esModule=!0,t.createLoadThreadMetadataEventPayloadData=void 0;var r=n(8154);t.createLoadThreadMetadataEventPayloadData=function(e){return{eventType:r.AwsInputEventType.LOAD_THREAD_METADATA,data:{thread:{idOnExternalPlatform:e}}}}},2251:(e,t,n)=>{t.__esModule=!0,t.createRecoverThreadPayloadData=void 0;var r=n(8154);t.createRecoverThreadPayloadData=function(e){return{eventType:r.AwsInputEventType.RECOVER_THREAD,data:{thread:{idOnExternalPlatform:e}}}}},2106:(e,t,n)=>{t.__esModule=!0,t.createSetThreadCustomFieldsPayloadData=void 0;var r=n(8154),o=n(7074);t.createSetThreadCustomFieldsPayloadData=function(e,t){return{eventType:r.AwsInputEventType.SET_CONSUMER_CONTACT_CUSTOM_FIELD,data:{customFields:(0,o.convertCustomFields)(e),thread:{idOnExternalPlatform:t}}}}},7877:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};t.__esModule=!0,t.storeContactId=void 0;var o=n(7214),a=n(80);t.storeContactId=function(e){var t=a.SDKVariableStorage.get(o.ChatSDKVariable.THREAD_DATA,"{}"),n=JSON.parse(t)||{};a.SDKVariableStorage.set(o.ChatSDKVariable.THREAD_DATA,JSON.stringify(r(r({},n),{contactId:e})))}},8837:(e,t,n)=>{t.__esModule=!0,t.storeContactIdMiddleware=void 0;var r=n(2477),o=n(335),a=n(7877);t.storeContactIdMiddleware=function(e){if((0,r.isContactCreatedEvent)(e)){var t=e.data.case.id;(0,a.storeContactId)(t)}return(0,o.isRecoverSuccessPayload)(e)&&(t=e.data.consumerContact.caseId,(0,a.storeContactId)(t)),e}},5447:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};t.__esModule=!0,t.storeThreadScrollData=void 0;var o=n(7214),a=n(80),i=n(8470),s=n(9278);t.storeThreadScrollData=function(e){var t,n=null===(t=(0,s.lastItemInArray)(e.messages))||void 0===t?void 0:t.createdAt,u=a.SDKVariableStorage.get(o.ChatSDKVariable.THREAD_DATA,"{}"),c=JSON.parse(u)||{};a.SDKVariableStorage.set(o.ChatSDKVariable.THREAD_DATA,JSON.stringify(r(r({},c),{scrollToken:e.scrollToken,oldestMessageDatetime:(0,i.isUndefined)(n)?"":n})))}},696:(e,t,n)=>{t.__esModule=!0,t.storeThreadScrollDataMiddleware=void 0;var r=n(39),o=n(335),a=n(5447);t.storeThreadScrollDataMiddleware=function(e){if((0,o.isRecoverSuccessPayload)(e)){var t=e.data,n=t.messages,i=t.messagesScrollToken;(0,a.storeThreadScrollData)({messages:n,scrollToken:i})}if((0,r.isLoadMoreMessagesEventData)(e)){var s=e.data,u=s.scrollToken;n=s.messages,(0,a.storeThreadScrollData)({scrollToken:u,messages:n})}return e}},4008:(e,t,n)=>{t.__esModule=!0,t.filterCurrentThreadEventHandler=void 0;var r=n(8470);t.filterCurrentThreadEventHandler=function(e,t){return function(n){var o,a,i=n.detail.data;o=i,!1===(0,r.isEmpty)(null===(a=null==o?void 0:o.thread)||void 0===a?void 0:a.idOnExternalPlatform)&&i.thread.idOnExternalPlatform===e&&t(n)}}},9186:(e,t,n)=>{t.__esModule=!0,t.createStopTypingEventPayloadData=t.createStartTypingEventPayloadData=void 0;var r=n(8154);t.createStartTypingEventPayloadData=function(e){return{eventType:r.AwsInputEventType.SENDER_TYPING_STARTED,data:{thread:{idOnExternalPlatform:e}}}},t.createStopTypingEventPayloadData=function(e){return{eventType:r.AwsInputEventType.SENDER_TYPING_ENDED,data:{thread:{idOnExternalPlatform:e}}}}},6028:(e,t,n)=>{t.__esModule=!0,t.isUpdateThreadSuccess=t.createUpdateThreadPayloadData=void 0;var r=n(8154),o=n(8470);t.createUpdateThreadPayloadData=function(e,t){return{eventType:r.AwsInputEventType.UPDATE_THREAD,data:{thread:{idOnExternalPlatform:e,threadName:t}}}},t.isUpdateThreadSuccess=function(e){return(0,o.isUndefined)(e.error)}},3467:(e,t)=>{t.__esModule=!0,t.assertNonNullable=void 0,t.assertNonNullable=function(e){if(null==e)throw Error("Expected non-nullish value, got ".concat(e))}},505:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]});t.__esModule=!0,t.generateId=void 0,r(t,n(459),"v4","generateId")},597:(e,t,n)=>{t.__esModule=!0,t.getBrandIdAndChannelId=void 0;var r=n(7214),o=n(80),a=n(8470);t.getBrandIdAndChannelId=function(){var e=parseInt(o.SDKVariableStorage.get(r.ChatSDKVariable.BRAND_ID)),t=o.SDKVariableStorage.get(r.ChatSDKVariable.CHANNEL_ID);if((0,a.isNil)(e)||isNaN(e)||(0,a.isNil)(t))throw new Error("Cannot get BrandId and ChannelId from SDKVariableStorage \n      brandId (".concat(e,") |\n      channelId (").concat(t,")"));return{brandId:e,channelId:t}}},8470:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]});t.__esModule=!0,t.isUndefined=t.isNull=t.isNil=t.isEmpty=void 0,r(t,n(9697),"default","isEmpty"),r(t,n(7601),"default","isNil"),r(t,n(8146),"default","isNull"),r(t,n(9360),"default","isUndefined")},9278:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]});t.__esModule=!0,t.lastItemInArray=void 0,r(t,n(935),"default","lastItemInArray")},1466:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]});t.__esModule=!0,t.isTokenRefreshedSuccessResponse=t.isThreadArchivedSuccessPayload=t.isThreadListFetchedPostbackData=t.isSetPositionInQueuePayload=t.isRecoverSuccessEvent=t.isLoadMetadataSuccessPayload=t.isMoreMessagesLoadedEvent=t.isAuthSuccessEvent=void 0,r(t,n(7084),"isAuthSuccessEvent"),r(t,n(39),"isLoadMoreMessagesEventData","isMoreMessagesLoadedEvent"),r(t,n(9871),"isLoadMetadataSuccessPayload"),r(t,n(335),"isRecoverSuccessPayload","isRecoverSuccessEvent"),r(t,n(3290),"isSetPositionInQueuePayload"),r(t,n(3550),"isThreadListFetchedPostbackData"),r(t,n(2885),"isThreadArchivedSuccessPayload"),r(t,n(8493),"isTokenRefreshedSuccessResponse")},8839:(e,t)=>{t.__esModule=!0,t.splitName=void 0,t.splitName=function(e){var t=e.split(" ");return[t[0],t.slice(1).join(" ")]}},8828:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]});t.__esModule=!0,t.uniqBy=void 0,r(t,n(7712),"default","uniqBy")},4159:(e,t)=>{t.__esModule=!0,t.createVisitorPayload=void 0,t.createVisitorPayload=function(e){return{visitor:{id:e}}}},2007:e=>{e.exports=t},459:t=>{t.exports=e},6183:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(2119),o=n(6092);const a=(0,r.Z)(o.Z,"Map")},3203:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(2119),o=n(6092);const a=(0,r.Z)(o.Z,"Set")},7685:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n(6092).Z.Symbol},3243:(e,t,n)=>{n.d(t,{Z:()=>l});var r=n(7685),o=Object.prototype,a=o.hasOwnProperty,i=o.toString,s=r.Z?r.Z.toStringTag:void 0;var u=Object.prototype.toString;var c=r.Z?r.Z.toStringTag:void 0;const l=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":c&&c in Object(e)?function(e){var t=a.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var o=i.call(e);return r&&(t?e[s]=n:delete e[s]),o}(e):function(e){return u.call(e)}(e)}},6093:(e,t,n)=>{n.d(t,{Z:()=>u});var r=n(2764);const o=(a=Object.keys,i=Object,function(e){return a(i(e))});var a,i,s=Object.prototype.hasOwnProperty;const u=function(e){if(!(0,r.Z)(e))return o(e);var t=[];for(var n in Object(e))s.call(e,n)&&"constructor"!=n&&t.push(n);return t}},3413:(e,t,n)=>{n.d(t,{Z:()=>r});const r="object"==typeof global&&global&&global.Object===Object&&global},2119:(e,t,n)=>{n.d(t,{Z:()=>_});var r=n(3234);const o=n(6092).Z["__core-js_shared__"];var a,i=(a=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+a:"";var s=n(7226),u=n(19),c=/^\[object .+?Constructor\]$/,l=Function.prototype,d=Object.prototype,h=l.toString,f=d.hasOwnProperty,v=RegExp("^"+h.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const p=function(e){return!(!(0,s.Z)(e)||(t=e,i&&i in t))&&((0,r.Z)(e)?v:c).test((0,u.Z)(e));var t},_=function(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return p(n)?n:void 0}},6155:(e,t,n)=>{n.d(t,{Z:()=>m});var r=n(2119),o=n(6092);const a=(0,r.Z)(o.Z,"DataView");var i=n(6183);const s=(0,r.Z)(o.Z,"Promise");var u=n(3203);const c=(0,r.Z)(o.Z,"WeakMap");var l=n(3243),d=n(19),h="[object Map]",f="[object Promise]",v="[object Set]",p="[object WeakMap]",_="[object DataView]",E=(0,d.Z)(a),y=(0,d.Z)(i.Z),g=(0,d.Z)(s),b=(0,d.Z)(u.Z),S=(0,d.Z)(c),T=l.Z;(a&&T(new a(new ArrayBuffer(1)))!=_||i.Z&&T(new i.Z)!=h||s&&T(s.resolve())!=f||u.Z&&T(new u.Z)!=v||c&&T(new c)!=p)&&(T=function(e){var t=(0,l.Z)(e),n="[object Object]"==t?e.constructor:void 0,r=n?(0,d.Z)(n):"";if(r)switch(r){case E:return _;case y:return h;case g:return f;case b:return v;case S:return p}return t});const m=T},2764:(e,t,n)=>{n.d(t,{Z:()=>o});var r=Object.prototype;const o=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},6092:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(3413),o="object"==typeof self&&self&&self.Object===Object&&self;const a=r.Z||o||Function("return this")()},19:(e,t,n)=>{n.d(t,{Z:()=>o});var r=Function.prototype.toString;const o=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},4732:(e,t,n)=>{n.d(t,{Z:()=>c});var r=n(3243),o=n(8533);const a=function(e){return(0,o.Z)(e)&&"[object Arguments]"==(0,r.Z)(e)};var i=Object.prototype,s=i.hasOwnProperty,u=i.propertyIsEnumerable;const c=a(function(){return arguments}())?a:function(e){return(0,o.Z)(e)&&s.call(e,"callee")&&!u.call(e,"callee")}},7771:(e,t,n)=>{n.d(t,{Z:()=>r});const r=Array.isArray},585:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(3234),o=n(1656);const a=function(e){return null!=e&&(0,o.Z)(e.length)&&!(0,r.Z)(e)}},6706:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(6092);var o="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=o&&"object"==typeof module&&module&&!module.nodeType&&module,i=a&&a.exports===o?r.Z.Buffer:void 0;const s=(i?i.isBuffer:void 0)||function(){return!1}},9697:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var r=n(6093),o=n(6155),a=n(4732),i=n(7771),s=n(585),u=n(6706),c=n(2764),l=n(9720),d=Object.prototype.hasOwnProperty;const h=function(e){if(null==e)return!0;if((0,s.Z)(e)&&((0,i.Z)(e)||"string"==typeof e||"function"==typeof e.splice||(0,u.Z)(e)||(0,l.Z)(e)||(0,a.Z)(e)))return!e.length;var t=(0,o.Z)(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if((0,c.Z)(e))return!(0,r.Z)(e).length;for(var n in e)if(d.call(e,n))return!1;return!0}},3234:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(3243),o=n(7226);const a=function(e){if(!(0,o.Z)(e))return!1;var t=(0,r.Z)(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},1656:(e,t,n)=>{n.d(t,{Z:()=>r});const r=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},7601:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=function(e){return null==e}},8146:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=function(e){return null===e}},7226:(e,t,n)=>{n.d(t,{Z:()=>r});const r=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},8533:(e,t,n)=>{n.d(t,{Z:()=>r});const r=function(e){return null!=e&&"object"==typeof e}},9720:(e,t,n)=>{n.d(t,{Z:()=>f});var r=n(3243),o=n(1656),a=n(8533),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1;var s=n(3413),u="object"==typeof exports&&exports&&!exports.nodeType&&exports,c=u&&"object"==typeof module&&module&&!module.nodeType&&module,l=c&&c.exports===u&&s.Z.process,d=function(){try{return c&&c.require&&c.require("util").types||l&&l.binding&&l.binding("util")}catch(e){}}(),h=d&&d.isTypedArray;const f=h?(v=h,function(e){return v(e)}):function(e){return(0,a.Z)(e)&&(0,o.Z)(e.length)&&!!i[(0,r.Z)(e)]};var v},9360:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=function(e){return void 0===e}},935:(e,t,n)=>{n.r(t),n.d(t,{default:()=>r});const r=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},7712:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Me});const r=function(e,t){return e===t||e!=e&&t!=t},o=function(e,t){for(var n=e.length;n--;)if(r(e[n][0],t))return n;return-1};var a=Array.prototype.splice;function i(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}i.prototype.clear=function(){this.__data__=[],this.size=0},i.prototype.delete=function(e){var t=this.__data__,n=o(t,e);return!(n<0||(n==t.length-1?t.pop():a.call(t,n,1),--this.size,0))},i.prototype.get=function(e){var t=this.__data__,n=o(t,e);return n<0?void 0:t[n][1]},i.prototype.has=function(e){return o(this.__data__,e)>-1},i.prototype.set=function(e,t){var n=this.__data__,r=o(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};const s=i;var u=n(6183);const c=(0,n(2119).Z)(Object,"create");var l=Object.prototype.hasOwnProperty;var d=Object.prototype.hasOwnProperty;function h(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}h.prototype.clear=function(){this.__data__=c?c(null):{},this.size=0},h.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},h.prototype.get=function(e){var t=this.__data__;if(c){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return l.call(t,e)?t[e]:void 0},h.prototype.has=function(e){var t=this.__data__;return c?void 0!==t[e]:d.call(t,e)},h.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=c&&void 0===t?"__lodash_hash_undefined__":t,this};const f=h,v=function(e,t){var n,r,o=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map};function p(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}p.prototype.clear=function(){this.size=0,this.__data__={hash:new f,map:new(u.Z||s),string:new f}},p.prototype.delete=function(e){var t=v(this,e).delete(e);return this.size-=t?1:0,t},p.prototype.get=function(e){return v(this,e).get(e)},p.prototype.has=function(e){return v(this,e).has(e)},p.prototype.set=function(e,t){var n=v(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};const _=p;function E(e){var t=this.__data__=new s(e);this.size=t.size}E.prototype.clear=function(){this.__data__=new s,this.size=0},E.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},E.prototype.get=function(e){return this.__data__.get(e)},E.prototype.has=function(e){return this.__data__.has(e)},E.prototype.set=function(e,t){var n=this.__data__;if(n instanceof s){var r=n.__data__;if(!u.Z||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new _(r)}return n.set(e,t),this.size=n.size,this};const y=E;function g(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new _;++t<n;)this.add(e[t])}g.prototype.add=g.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},g.prototype.has=function(e){return this.__data__.has(e)};const b=g,S=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},T=function(e,t){return e.has(t)},m=function(e,t,n,r,o,a){var i=1&n,s=e.length,u=t.length;if(s!=u&&!(i&&u>s))return!1;var c=a.get(e),l=a.get(t);if(c&&l)return c==t&&l==e;var d=-1,h=!0,f=2&n?new b:void 0;for(a.set(e,t),a.set(t,e);++d<s;){var v=e[d],p=t[d];if(r)var _=i?r(p,v,d,t,e,a):r(v,p,d,e,t,a);if(void 0!==_){if(_)continue;h=!1;break}if(f){if(!S(t,(function(e,t){if(!T(f,t)&&(v===e||o(v,e,n,r,a)))return f.push(t)}))){h=!1;break}}else if(v!==p&&!o(v,p,n,r,a)){h=!1;break}}return a.delete(e),a.delete(t),h};var C=n(7685);const w=n(6092).Z.Uint8Array,A=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n},O=function(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n};var D=C.Z?C.Z.prototype:void 0,I=D?D.valueOf:void 0;var P=n(7771);var N=Object.prototype.propertyIsEnumerable,M=Object.getOwnPropertySymbols;const R=M?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,a=[];++n<r;){var i=e[n];t(i,n,e)&&(a[o++]=i)}return a}(M(e),(function(t){return N.call(e,t)})))}:function(){return[]};var k=n(4732),j=n(6706),U=/^(?:0|[1-9]\d*)$/;const L=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&U.test(e))&&e>-1&&e%1==0&&e<t};var x=n(9720),H=Object.prototype.hasOwnProperty;const G=function(e,t){var n=(0,P.Z)(e),r=!n&&(0,k.Z)(e),o=!n&&!r&&(0,j.Z)(e),a=!n&&!r&&!o&&(0,x.Z)(e),i=n||r||o||a,s=i?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],u=s.length;for(var c in e)!t&&!H.call(e,c)||i&&("length"==c||o&&("offset"==c||"parent"==c)||a&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||L(c,u))||s.push(c);return s};var B=n(6093),V=n(585);const Z=function(e){return(0,V.Z)(e)?G(e):(0,B.Z)(e)},K=function(e){return function(e,t,n){var r=t(e);return(0,P.Z)(e)?r:function(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}(r,n(e))}(e,Z,R)};var F=Object.prototype.hasOwnProperty;var W=n(6155),z="[object Arguments]",Q="[object Array]",q="[object Object]",Y=Object.prototype.hasOwnProperty;const J=function(e,t,n,o,a,i){var s=(0,P.Z)(e),u=(0,P.Z)(t),c=s?Q:(0,W.Z)(e),l=u?Q:(0,W.Z)(t),d=(c=c==z?q:c)==q,h=(l=l==z?q:l)==q,f=c==l;if(f&&(0,j.Z)(e)){if(!(0,j.Z)(t))return!1;s=!0,d=!1}if(f&&!d)return i||(i=new y),s||(0,x.Z)(e)?m(e,t,n,o,a,i):function(e,t,n,o,a,i,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!i(new w(e),new w(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return r(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var u=A;case"[object Set]":var c=1&o;if(u||(u=O),e.size!=t.size&&!c)return!1;var l=s.get(e);if(l)return l==t;o|=2,s.set(e,t);var d=m(u(e),u(t),o,a,i,s);return s.delete(e),d;case"[object Symbol]":if(I)return I.call(e)==I.call(t)}return!1}(e,t,c,n,o,a,i);if(!(1&n)){var v=d&&Y.call(e,"__wrapped__"),p=h&&Y.call(t,"__wrapped__");if(v||p){var _=v?e.value():e,E=p?t.value():t;return i||(i=new y),a(_,E,n,o,i)}}return!!f&&(i||(i=new y),function(e,t,n,r,o,a){var i=1&n,s=K(e),u=s.length;if(u!=K(t).length&&!i)return!1;for(var c=u;c--;){var l=s[c];if(!(i?l in t:F.call(t,l)))return!1}var d=a.get(e),h=a.get(t);if(d&&h)return d==t&&h==e;var f=!0;a.set(e,t),a.set(t,e);for(var v=i;++c<u;){var p=e[l=s[c]],_=t[l];if(r)var E=i?r(_,p,l,t,e,a):r(p,_,l,e,t,a);if(!(void 0===E?p===_||o(p,_,n,r,a):E)){f=!1;break}v||(v="constructor"==l)}if(f&&!v){var y=e.constructor,g=t.constructor;y==g||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof g&&g instanceof g||(f=!1)}return a.delete(e),a.delete(t),f}(e,t,n,o,a,i))};var X=n(8533);const $=function e(t,n,r,o,a){return t===n||(null==t||null==n||!(0,X.Z)(t)&&!(0,X.Z)(n)?t!=t&&n!=n:J(t,n,r,o,e,a))};var ee=n(7226);const te=function(e){return e==e&&!(0,ee.Z)(e)},ne=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}},re=function(e){var t=function(e){for(var t=Z(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,te(o)]}return t}(e);return 1==t.length&&t[0][2]?ne(t[0][0],t[0][1]):function(n){return n===e||function(e,t,n,r){var o=n.length,a=o,i=!r;if(null==e)return!a;for(e=Object(e);o--;){var s=n[o];if(i&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++o<a;){var u=(s=n[o])[0],c=e[u],l=s[1];if(i&&s[2]){if(void 0===c&&!(u in e))return!1}else{var d=new y;if(r)var h=r(c,l,u,e,t,d);if(!(void 0===h?$(l,c,3,r,d):h))return!1}}return!0}(n,e,t)}};var oe=n(3243);const ae=function(e){return"symbol"==typeof e||(0,X.Z)(e)&&"[object Symbol]"==(0,oe.Z)(e)};var ie=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,se=/^\w*$/;const ue=function(e,t){if((0,P.Z)(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!ae(e))||se.test(e)||!ie.test(e)||null!=t&&e in Object(t)};function ce(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var i=e.apply(this,r);return n.cache=a.set(o,i)||a,i};return n.cache=new(ce.Cache||_),n}ce.Cache=_;var le=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,de=/\\(\\)?/g;const he=(fe=ce((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(le,(function(e,n,r,o){t.push(r?o.replace(de,"$1"):n||e)})),t}),(function(e){return 500===ve.size&&ve.clear(),e})),ve=fe.cache,fe);var fe,ve;var pe=C.Z?C.Z.prototype:void 0,_e=pe?pe.toString:void 0;const Ee=function e(t){if("string"==typeof t)return t;if((0,P.Z)(t))return function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}(t,e)+"";if(ae(t))return _e?_e.call(t):"";var n=t+"";return"0"==n&&1/t==-1/0?"-0":n},ye=function(e,t){return(0,P.Z)(e)?e:ue(e,t)?[e]:he(function(e){return null==e?"":Ee(e)}(e))},ge=function(e){if("string"==typeof e||ae(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},be=function(e,t){for(var n=0,r=(t=ye(t,e)).length;null!=e&&n<r;)e=e[ge(t[n++])];return n&&n==r?e:void 0},Se=function(e,t){return null!=e&&t in Object(e)};var Te=n(1656);const me=function(e,t){return null!=e&&function(e,t,n){for(var r=-1,o=(t=ye(t,e)).length,a=!1;++r<o;){var i=ge(t[r]);if(!(a=null!=e&&n(e,i)))break;e=e[i]}return a||++r!=o?a:!!(o=null==e?0:e.length)&&(0,Te.Z)(o)&&L(i,o)&&((0,P.Z)(e)||(0,k.Z)(e))}(e,t,Se)},Ce=function(e,t){return ue(e)&&te(t)?ne(ge(e),t):function(n){var r=function(e,t,n){var r=null==e?void 0:be(e,t);return void 0===r?n:r}(n,e);return void 0===r&&r===t?me(n,e):$(t,r,3)}},we=function(e){return e},Ae=function(e){return ue(e)?(t=ge(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return be(t,e)}}(e);var t},Oe=function(e){return e!=e},De=function(e,t){return!(null==e||!e.length)&&function(e,t,n){return t==t?function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}(e,t,n):function(e,t,n,r){for(var o=e.length,a=n+(r?1:-1);r?a--:++a<o;)if(t(e[a],a,e))return a;return-1}(e,Oe,n)}(e,t,0)>-1},Ie=function(e,t,n){for(var r=-1,o=null==e?0:e.length;++r<o;)if(n(t,e[r]))return!0;return!1};var Pe=n(3203);const Ne=Pe.Z&&1/O(new Pe.Z([,-0]))[1]==1/0?function(e){return new Pe.Z(e)}:function(){},Me=function(e,t){return e&&e.length?function(e,t,n){var r=-1,o=De,a=e.length,i=!0,s=[],u=s;if(n)i=!1,o=Ie;else if(a>=200){var c=t?null:Ne(e);if(c)return O(c);i=!1,o=T,u=new b}else u=t?[]:s;e:for(;++r<a;){var l=e[r],d=t?t(l):l;if(l=n||0!==l?l:0,i&&d==d){for(var h=u.length;h--;)if(u[h]===d)continue e;t&&u.push(d),s.push(l)}else o(u,d,n)||(u!==s&&u.push(d),s.push(l))}return s}(e,"function"==typeof(n=t)?n:null==n?we:"object"==typeof n?(0,P.Z)(n)?Ce(n[0],n[1]):re(n):Ae(n)):[];var n}}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var a=r[e]={exports:{}};return n[e].call(a.exports,a,a.exports,o),a.exports}return o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o(3607)})()));